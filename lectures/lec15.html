

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Lecture 15: September 11th, 2023 &#8212; Math 10, Summer Session II 2023</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/lec15';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="🎉 Final Project Instructions" href="../final/final.html" />
    <link rel="prev" title="Lecture 14: September 8th, 2023" href="lec14.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/confuse.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/confuse.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    UC Irvine, Math 10, Summer 2023
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w1vid.html">Week 1 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec1.html">Lecture 1: August 7th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../worksheets/wkst1.html">Discussion 1: August 7th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec2.html">Lecture 2: August 9th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../worksheets/wkst2.html">Discussion 2: August 9th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec3.html">Lecture 3: August 11th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w2vid.html">Week 2 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec4.html">Lecture 4: August 14th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec5.html">Lecture 5: August 16th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec6.html">Lecture 6: August 18th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w3vid.html">Week 3 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec7.html">Lecture 7: August 21st, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec8.html">Lecture 8: August 23nd, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec9.html">Lecture 9: August 25th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lec10.html">Lecture 10: August 28th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec11.html">Lecture 11: August 30th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec12.html">Lecture 12: September 1st, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w5vid.html">Week 5 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec13.html">Lecture 13: September 6th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec14.html">Lecture 14: September 8th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Final Project and Finals Week</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lecture 15: September 11th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final/final.html">🎉 Final Project Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final/extra.html">Possible Extra Topics</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ybaki97/Math10-SSI23" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ybaki97/Math10-SSI23/issues/new?title=Issue%20on%20page%20%2Flectures/lec15.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lectures/lec15.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lecture 15: September 11th, 2023</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-project-questions">Final Project Questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-clustering">K-Means Clustering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standardscaler">StandardScaler</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importance-of-scaling">Importance of Scaling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-k-means-algorithm">The K-Means Algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iterating-by-hand">Iterating by hand</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lecture-15-september-11th-2023">
<h1>Lecture 15: September 11th, 2023<a class="headerlink" href="#lecture-15-september-11th-2023" title="Permalink to this headline">#</a></h1>
<p>We made it to the last lecture :’) How do we all feel today?</p>
<p><strong>Reminders and Updates:</strong></p>
<ul class="simple">
<li><p>Homework 7 and Homework 8 are due tonight at midnight. Use your tokens to get an extension, if you need it.</p></li>
<li><p>You can also use your tokens to submit a outcome revision. If you are missing an outcome and would like credit for it, you can use tokens to submit a revision assignment. Let’s take a brief trip to Canvas to see what this looks like.</p></li>
<li><p>Today we will cover K-Means clustering, which is the topic of outcomes P18 and P19. They will be released after today’s lecture and are due Wednesday at midnight, if you would like to attempt them (remember, an A only requires 18 outcomes).</p></li>
<li><p>Final project is due Wednesday at midnight! No late submissions will be accepted!</p></li>
<li><p>Updated student hours with Yasmeen this week: instead of Tuesday student hours, I will host Wednesday student hours from 12:00pm-1:50pm (our normal lecture time). Come with any questions you might have!</p></li>
</ul>
<section id="final-project-questions">
<h2>Final Project Questions<a class="headerlink" href="#final-project-questions" title="Permalink to this headline">#</a></h2>
<p>Q: What if we can’t find a perfect linear fit?
A: That’s totally fine! Maybe just point out it doesn’t look like a linear fit, and you can’t say much about the relationship. You might consider fitting to a higher degree polynomial, as well.</p>
<p>Q: What if our precision is really low?
A: That’s also fine, just don’t try to convince us that the model works really well. You might consider trying to improve the model, or at least elaborate on a few things that you could try. Negative results are fine: I’d rather you say “we can’t make any conclusion” than try to convince of something that’s not true.</p>
</section>
<section id="k-means-clustering">
<h2>K-Means Clustering<a class="headerlink" href="#k-means-clustering" title="Permalink to this headline">#</a></h2>
<p>Today we will see our first example from <em>unsupervised</em> machine learning. Can anyone remind us of what the main difference is from <em>supervised</em> machine learning?</p>
<p><strong>Main Difference:</strong> Supervised learning uses labeled data, unsupervised learning uses unlabeled data.</p>
<p>Clustering is one of the most famous examples of unsupervised learning, and is something we will see today.</p>
<p>Here is a nice flowchart from the website <a class="reference external" href="https://www.geeksforgeeks.org/flowchart-for-basic-machine-learning-models/">GeeksforGeeks</a> which gives a nice outline of some different categories within machine learning. Don’t take it too seriously, it’s just kind of fun to look at.</p>
<p><img alt="" src="../_images/flowchart.jpeg" /></p>
<section id="standardscaler">
<h3>StandardScaler<a class="headerlink" href="#standardscaler" title="Permalink to this headline">#</a></h3>
<p>I’m a little surprised we haven’t talked about this topic yet, but today we’ll be rescaling numeric data so that it has a mean of zero and a standard deviation of one. Why would we want to do something like this?</p>
<p>From the chat: we want to make things not dependent on units!
Example: Suppose I have a DataFrame with one column in kilograms and one column in grams. We might expect that the grams column has numbers that are much larger than the kilograms column. Even though these are both weights, we might be biased towards grams since they are larger numbers.</p>
<ul class="simple">
<li><p>Load the iris dataset from Seaborn and drop any rows with missing values.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;iris&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>57</th>
      <td>4.9</td>
      <td>2.4</td>
      <td>3.3</td>
      <td>1.0</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>71</th>
      <td>6.1</td>
      <td>2.8</td>
      <td>4.0</td>
      <td>1.3</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>80</th>
      <td>5.5</td>
      <td>2.4</td>
      <td>3.8</td>
      <td>1.1</td>
      <td>versicolor</td>
    </tr>
    <tr>
      <th>106</th>
      <td>4.9</td>
      <td>2.5</td>
      <td>4.5</td>
      <td>1.7</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>55</th>
      <td>5.7</td>
      <td>2.8</td>
      <td>4.5</td>
      <td>1.3</td>
      <td>versicolor</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We still have the standard workflow for scikit-learn:</p>
<ul class="simple">
<li><p>import</p></li>
<li><p>instantiate</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fit</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">transform</span></code></p></li>
</ul>
<ul class="simple">
<li><p>Import <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> from <code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Instantiate a <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> object and name it <code class="docutils literal notranslate"><span class="pre">scaler</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">scaler</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sklearn.preprocessing._data.StandardScaler
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Try fitting StandardScaler to the iris dataset.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">Input In [6],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/envs/math9/lib/python3.9/site-packages/sklearn/preprocessing/_data.py:837,</span> in <span class="ni">StandardScaler.fit</span><span class="nt">(self, X, y, sample_weight)</span>
<span class="g g-Whitespace">    </span><span class="mi">835</span> <span class="c1"># Reset internal state before fitting</span>
<span class="g g-Whitespace">    </span><span class="mi">836</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">837</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/envs/math9/lib/python3.9/site-packages/sklearn/base.py:1151,</span> in <span class="ni">_fit_context.&lt;locals&gt;.decorator.&lt;locals&gt;.wrapper</span><span class="nt">(estimator, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1144</span>     <span class="n">estimator</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1146</span> <span class="k">with</span> <span class="n">config_context</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1147</span>     <span class="n">skip_parameter_validation</span><span class="o">=</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1148</span>         <span class="n">prefer_skip_nested_validation</span> <span class="ow">or</span> <span class="n">global_skip_validation</span>
<span class="g g-Whitespace">   </span><span class="mi">1149</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1150</span> <span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1151</span>     <span class="k">return</span> <span class="n">fit_method</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/envs/math9/lib/python3.9/site-packages/sklearn/preprocessing/_data.py:873,</span> in <span class="ni">StandardScaler.partial_fit</span><span class="nt">(self, X, y, sample_weight)</span>
<span class="g g-Whitespace">    </span><span class="mi">841</span> <span class="sd">&quot;&quot;&quot;Online computation of mean and std on X for later scaling.</span>
<span class="g g-Whitespace">    </span><span class="mi">842</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">843</span><span class="sd"> All of X is processed as a single batch. This is intended for cases</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">870</span><span class="sd">     Fitted scaler.</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">872</span> <span class="n">first_call</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;n_samples_seen_&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">873</span> <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_data</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">874</span>     <span class="n">X</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">875</span>     <span class="n">accept_sparse</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;csr&quot;</span><span class="p">,</span> <span class="s2">&quot;csc&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">876</span>     <span class="n">dtype</span><span class="o">=</span><span class="n">FLOAT_DTYPES</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">877</span>     <span class="n">force_all_finite</span><span class="o">=</span><span class="s2">&quot;allow-nan&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">878</span>     <span class="n">reset</span><span class="o">=</span><span class="n">first_call</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">879</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">880</span> <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">882</span> <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~/opt/miniconda3/envs/math9/lib/python3.9/site-packages/sklearn/base.py:604,</span> in <span class="ni">BaseEstimator._validate_data</span><span class="nt">(self, X, y, reset, validate_separately, cast_to_ndarray, **check_params)</span>
<span class="g g-Whitespace">    </span><span class="mi">602</span>         <span class="n">out</span> <span class="o">=</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
<span class="g g-Whitespace">    </span><span class="mi">603</span> <span class="k">elif</span> <span class="ow">not</span> <span class="n">no_val_X</span> <span class="ow">and</span> <span class="n">no_val_y</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">604</span>     <span class="n">out</span> <span class="o">=</span> <span class="n">check_array</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">input_name</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">check_params</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">605</span> <span class="k">elif</span> <span class="n">no_val_X</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">no_val_y</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">606</span>     <span class="n">out</span> <span class="o">=</span> <span class="n">_check_y</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">check_params</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/envs/math9/lib/python3.9/site-packages/sklearn/utils/validation.py:917,</span> in <span class="ni">check_array</span><span class="nt">(array, accept_sparse, accept_large_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, ensure_min_samples, ensure_min_features, estimator, input_name)</span>
<span class="g g-Whitespace">    </span><span class="mi">915</span>         <span class="n">array</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">916</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">917</span>         <span class="n">array</span> <span class="o">=</span> <span class="n">_asarray_with_order</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">xp</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">918</span> <span class="k">except</span> <span class="n">ComplexWarning</span> <span class="k">as</span> <span class="n">complex_warning</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">919</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">920</span>         <span class="s2">&quot;Complex data not supported</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">921</span>     <span class="p">)</span> <span class="kn">from</span> <span class="nn">complex_warning</span>

<span class="nn">File ~/opt/miniconda3/envs/math9/lib/python3.9/site-packages/sklearn/utils/_array_api.py:380,</span> in <span class="ni">_asarray_with_order</span><span class="nt">(array, dtype, order, copy, xp)</span>
<span class="g g-Whitespace">    </span><span class="mi">378</span>     <span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">379</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">380</span>     <span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">382</span> <span class="c1"># At this point array is a NumPy ndarray. We convert it to an array</span>
<span class="g g-Whitespace">    </span><span class="mi">383</span> <span class="c1"># container that is consistent with the input&#39;s namespace.</span>
<span class="g g-Whitespace">    </span><span class="mi">384</span> <span class="k">return</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/envs/math9/lib/python3.9/site-packages/pandas/core/generic.py:2064,</span> in <span class="ni">NDFrame.__array__</span><span class="nt">(self, dtype)</span>
<span class="g g-Whitespace">   </span><span class="mi">2063</span> <span class="k">def</span> <span class="nf">__array__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">DTypeLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2064</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="ne">ValueError</span>: could not convert string to float: &#39;setosa&#39;
</pre></div>
</div>
</div>
</div>
<p>What’s going on here? Notice the species column has strings, and it doesn’t make sense to scale these. When we use StandardScaler, we only want to apply it to numeric columns.</p>
<p>Let’s get just the numeric columns of our DataFrame. Notice, the only non-numeric column is “species”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;,
       &#39;species&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numcols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s2">&quot;species&quot;</span><span class="p">]</span>
<span class="n">numcols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
</pre></div>
</div>
</div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">!=</span></code> means not equal. Here’s another way we could do it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;species&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
</pre></div>
</div>
</div>
</div>
<p>I also just want to show you the following function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas.api.types</span> <span class="kn">import</span> <span class="n">is_numeric_dtype</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;sepal_length&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_numeric_dtype</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sepal_length     True
sepal_width      True
petal_length     True
petal_width      True
species         False
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
</pre></div>
</div>
</div>
</div>
<p>Now let’s try fitting again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numcols</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>StandardScaler()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div>
</div>
<ul class="simple">
<li><p>Call <code class="docutils literal notranslate"><span class="pre">transform</span></code> on the numeric columns of <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">numcols</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numcols</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.900681</td>
      <td>1.019004</td>
      <td>-1.340227</td>
      <td>-1.315444</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.143017</td>
      <td>-0.131979</td>
      <td>-1.340227</td>
      <td>-1.315444</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.385353</td>
      <td>0.328414</td>
      <td>-1.397064</td>
      <td>-1.315444</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.506521</td>
      <td>0.098217</td>
      <td>-1.283389</td>
      <td>-1.315444</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.021849</td>
      <td>1.249201</td>
      <td>-1.340227</td>
      <td>-1.315444</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>1.038005</td>
      <td>-0.131979</td>
      <td>0.819596</td>
      <td>1.448832</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>146</th>
      <td>0.553333</td>
      <td>-1.282963</td>
      <td>0.705921</td>
      <td>0.922303</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>147</th>
      <td>0.795669</td>
      <td>-0.131979</td>
      <td>0.819596</td>
      <td>1.053935</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>148</th>
      <td>0.432165</td>
      <td>0.788808</td>
      <td>0.933271</td>
      <td>1.448832</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>149</th>
      <td>0.068662</td>
      <td>-0.131979</td>
      <td>0.762758</td>
      <td>0.790671</td>
      <td>virginica</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 5 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Check that the mean and standard deviation of the resulting columns are 0 and 1, respectively.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/ct/dspwzk2n6kb19j3s9g3ldtc80000gn/T/ipykernel_59450/2681518468.py:1: FutureWarning: Dropping of nuisance columns in DataFrame reductions (with &#39;numeric_only=None&#39;) is deprecated; in a future version this will raise TypeError.  Select only valid columns before calling the reduction.
  df.mean(axis=0)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sepal_length   -2.775558e-16
sepal_width    -9.695948e-16
petal_length   -8.652338e-16
petal_width    -4.662937e-16
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>These values are not exactly zero, but very close. This is all we can expect (remember, we never expect floats to be exactly equal to something else).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/ct/dspwzk2n6kb19j3s9g3ldtc80000gn/T/ipykernel_59450/649938150.py:1: FutureWarning: Dropping of nuisance columns in DataFrame reductions (with &#39;numeric_only=None&#39;) is deprecated; in a future version this will raise TypeError.  Select only valid columns before calling the reduction.
  df.std(axis=0)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sepal_length    1.00335
sepal_width     1.00335
petal_length    1.00335
petal_width     1.00335
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Similarly, these are not exactly equal to 1, but they are very close, and this is good enough.</p>
<hr class="docutils" />
<p>First, let me show you how to implement K-Means clustering in scikit-learn. Then we’ll go through the details of how it works.</p>
<ul class="simple">
<li><p>Import <code class="docutils literal notranslate"><span class="pre">KMeans</span></code> from <code class="docutils literal notranslate"><span class="pre">sklearn.cluster</span></code> and instantiate a <code class="docutils literal notranslate"><span class="pre">KMeans</span></code> object.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Fit our <code class="docutils literal notranslate"><span class="pre">KMeans</span></code> object to the numeric columns of <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p></li>
</ul>
<p>Notice that when we fit here there’s no target (unlike in Linear Regression, for instance). This is because KMeans is unsupervised. Recall that the target is some correct value we’re trying to predict. Here, we don’t have that.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numcols</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/yasmeen/opt/miniconda3/envs/math9/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py:1412: FutureWarning: The default value of `n_init` will change from 10 to &#39;auto&#39; in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)
/Users/yasmeen/opt/miniconda3/envs/math9/lib/python3.9/site-packages/threadpoolctl.py:1010: RuntimeWarning: 
Found Intel OpenMP (&#39;libiomp&#39;) and LLVM OpenMP (&#39;libomp&#39;) loaded at
the same time. Both libraries are known to be incompatible and this
can cause random crashes or deadlocks on Linux when loaded in the
same Python program.
Using threadpoolctl may cause crashes or deadlocks. For more
information and possible workarounds, please see
    https://github.com/joblib/threadpoolctl/blob/master/multiple_openmp.md

  warnings.warn(msg, RuntimeWarning)
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KMeans()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">KMeans</label><div class="sk-toggleable__content"><pre>KMeans()</pre></div></div></div></div></div></div></div>
</div>
<ul class="simple">
<li><p>Put the predicted clusters into a new column called “cluster”.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numcols</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.900681</td>
      <td>1.019004</td>
      <td>-1.340227</td>
      <td>-1.315444</td>
      <td>setosa</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.143017</td>
      <td>-0.131979</td>
      <td>-1.340227</td>
      <td>-1.315444</td>
      <td>setosa</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.385353</td>
      <td>0.328414</td>
      <td>-1.397064</td>
      <td>-1.315444</td>
      <td>setosa</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.506521</td>
      <td>0.098217</td>
      <td>-1.283389</td>
      <td>-1.315444</td>
      <td>setosa</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.021849</td>
      <td>1.249201</td>
      <td>-1.340227</td>
      <td>-1.315444</td>
      <td>setosa</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>1.038005</td>
      <td>-0.131979</td>
      <td>0.819596</td>
      <td>1.448832</td>
      <td>virginica</td>
      <td>6</td>
    </tr>
    <tr>
      <th>146</th>
      <td>0.553333</td>
      <td>-1.282963</td>
      <td>0.705921</td>
      <td>0.922303</td>
      <td>virginica</td>
      <td>0</td>
    </tr>
    <tr>
      <th>147</th>
      <td>0.795669</td>
      <td>-0.131979</td>
      <td>0.819596</td>
      <td>1.053935</td>
      <td>virginica</td>
      <td>6</td>
    </tr>
    <tr>
      <th>148</th>
      <td>0.432165</td>
      <td>0.788808</td>
      <td>0.933271</td>
      <td>1.448832</td>
      <td>virginica</td>
      <td>6</td>
    </tr>
    <tr>
      <th>149</th>
      <td>0.068662</td>
      <td>-0.131979</td>
      <td>0.762758</td>
      <td>0.790671</td>
      <td>virginica</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 6 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Make an altair chart with sepal_length along the x-axis, petal_length along the y-axis, and with colors/shapes determined by the cluster predicted by <code class="docutils literal notranslate"><span class="pre">kmeans</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numcols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;sepal_length&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;petal_length&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;cluster:N&quot;</span><span class="p">,</span>
    <span class="n">shape</span><span class="o">=</span><span class="s2">&quot;cluster:N&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-40ad195f4ce9416091abd0fb1a74207e.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-40ad195f4ce9416091abd0fb1a74207e.vega-embed details,
  #altair-viz-40ad195f4ce9416091abd0fb1a74207e.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-40ad195f4ce9416091abd0fb1a74207e"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-40ad195f4ce9416091abd0fb1a74207e") {
      outputDiv = document.getElementById("altair-viz-40ad195f4ce9416091abd0fb1a74207e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-82db198d38e0fb5126051585b38d5c92"}, "mark": {"type": "point", "filled": true, "size": 100}, "encoding": {"color": {"field": "cluster", "type": "nominal"}, "shape": {"field": "cluster", "type": "nominal"}, "x": {"field": "sepal_length", "type": "quantitative"}, "y": {"field": "petal_length", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-82db198d38e0fb5126051585b38d5c92": [{"sepal_length": -0.9006811702978088, "sepal_width": 1.019004351971607, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1}, {"sepal_length": -1.1430169111851105, "sepal_width": -0.13197947932162468, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5}, {"sepal_length": -1.3853526520724133, "sepal_width": 0.32841405319566835, "petal_length": -1.3970639535363654, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5}, {"sepal_length": -1.5065205225160652, "sepal_width": 0.09821728693702184, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5}, {"sepal_length": -1.0218490407414595, "sepal_width": 1.2492011182302534, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1}, {"sepal_length": -0.537177558966854, "sepal_width": 1.939791417006192, "petal_length": -1.1697142458819532, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 7}, {"sepal_length": -1.5065205225160652, "sepal_width": 0.7888075857129604, "petal_length": -1.3402265266227624, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 0.7888075857129604, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1}, {"sepal_length": -1.7488562634033669, "sepal_width": -0.3621762455802712, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5}, {"sepal_length": -1.1430169111851105, "sepal_width": 0.09821728693702184, "petal_length": -1.2833890997091593, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 5}, {"sepal_length": -0.537177558966854, "sepal_width": 1.4793978844889, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7}, {"sepal_length": -1.2641847816287624, "sepal_width": 0.7888075857129604, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1}, {"sepal_length": -1.2641847816287624, "sepal_width": -0.13197947932162468, "petal_length": -1.3402265266227624, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 5}, {"sepal_length": -1.870024133847019, "sepal_width": -0.13197947932162468, "petal_length": -1.5107388073635717, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 5}, {"sepal_length": -0.05250607719224957, "sepal_width": 2.1699881832648384, "petal_length": -1.4539013804499687, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7}, {"sepal_length": -0.1736739476359004, "sepal_width": 3.090775248299425, "petal_length": -1.2833890997091593, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 7}, {"sepal_length": -0.537177558966854, "sepal_width": 1.939791417006192, "petal_length": -1.3970639535363654, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 7}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.019004351971607, "petal_length": -1.3402265266227624, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 1}, {"sepal_length": -0.1736739476359004, "sepal_width": 1.7095946507475455, "petal_length": -1.1697142458819532, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 7}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.7095946507475455, "petal_length": -1.2833890997091593, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 7}, {"sepal_length": -0.537177558966854, "sepal_width": 0.7888075857129604, "petal_length": -1.1697142458819532, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.4793978844889, "petal_length": -1.2833890997091593, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 1}, {"sepal_length": -1.5065205225160652, "sepal_width": 1.2492011182302534, "petal_length": -1.567576234277175, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 0.5586108194543139, "petal_length": -1.1697142458819532, "petal_width": -0.9205477421368377, "species": "setosa", "cluster": 1}, {"sepal_length": -1.2641847816287624, "sepal_width": 0.7888075857129604, "petal_length": -1.0560393920547466, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": -0.13197947932162468, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5}, {"sepal_length": -1.0218490407414595, "sepal_width": 0.7888075857129604, "petal_length": -1.226551672795556, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 1}, {"sepal_length": -0.7795132998541568, "sepal_width": 1.019004351971607, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1}, {"sepal_length": -0.7795132998541568, "sepal_width": 0.7888075857129604, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1}, {"sepal_length": -1.3853526520724133, "sepal_width": 0.32841405319566835, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5}, {"sepal_length": -1.2641847816287624, "sepal_width": 0.09821728693702184, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5}, {"sepal_length": -0.537177558966854, "sepal_width": 0.7888075857129604, "petal_length": -1.2833890997091593, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 1}, {"sepal_length": -0.7795132998541568, "sepal_width": 2.400184949523484, "petal_length": -1.2833890997091593, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 7}, {"sepal_length": -0.4160096885232032, "sepal_width": 2.6303817157821316, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7}, {"sepal_length": -1.1430169111851105, "sepal_width": 0.09821728693702184, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5}, {"sepal_length": -1.0218490407414595, "sepal_width": 0.32841405319566835, "petal_length": -1.4539013804499687, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5}, {"sepal_length": -0.4160096885232032, "sepal_width": 1.019004351971607, "petal_length": -1.3970639535363654, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1}, {"sepal_length": -1.1430169111851105, "sepal_width": 1.2492011182302534, "petal_length": -1.3402265266227624, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 1}, {"sepal_length": -1.7488562634033669, "sepal_width": -0.13197947932162468, "petal_length": -1.3970639535363654, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5}, {"sepal_length": -0.9006811702978088, "sepal_width": 0.7888075857129604, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 1.019004351971607, "petal_length": -1.3970639535363654, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 1}, {"sepal_length": -1.6276883929597161, "sepal_width": -1.7433568431321493, "petal_length": -1.3970639535363654, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 5}, {"sepal_length": -1.7488562634033669, "sepal_width": 0.32841405319566835, "petal_length": -1.3970639535363654, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5}, {"sepal_length": -1.0218490407414595, "sepal_width": 1.019004351971607, "petal_length": -1.226551672795556, "petal_width": -0.7889155578465368, "species": "setosa", "cluster": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.7095946507475455, "petal_length": -1.0560393920547466, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 7}, {"sepal_length": -1.2641847816287624, "sepal_width": -0.13197947932162468, "petal_length": -1.3402265266227624, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 5}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.7095946507475455, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7}, {"sepal_length": -1.5065205225160652, "sepal_width": 0.32841405319566835, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5}, {"sepal_length": -0.658345429410506, "sepal_width": 1.4793978844889, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7}, {"sepal_length": -1.0218490407414595, "sepal_width": 0.5586108194543139, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1}, {"sepal_length": 1.401508368131566, "sepal_width": 0.32841405319566835, "petal_length": 0.5354085615261415, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 6}, {"sepal_length": 0.6745011454696588, "sepal_width": 0.32841405319566835, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 6}, {"sepal_length": 1.2803404976879151, "sepal_width": 0.09821728693702184, "petal_length": 0.6490834153533479, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 6}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.7433568431321493, "petal_length": 0.13754657313091936, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 2}, {"sepal_length": 0.7956690159133096, "sepal_width": -0.5923730118389178, "petal_length": 0.47857113461253803, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -0.5923730118389178, "petal_length": 0.4217337076989351, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": 0.5586108194543139, "petal_length": 0.5354085615261415, "petal_width": 0.5274062850564719, "species": "versicolor", "cluster": 6}, {"sepal_length": -1.1430169111851105, "sepal_width": -1.513160076873503, "petal_length": -0.26031541526430274, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2}, {"sepal_length": 0.9168368863569605, "sepal_width": -0.3621762455802712, "petal_length": 0.47857113461253803, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0}, {"sepal_length": -0.7795132998541568, "sepal_width": -0.8225697780975633, "petal_length": 0.08070914621731616, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 2}, {"sepal_length": -1.0218490407414595, "sepal_width": -2.433947141908088, "petal_length": -0.14664056143709636, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2}, {"sepal_length": 0.06866179325140237, "sepal_width": -0.13197947932162468, "petal_length": 0.2512214269581257, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0}, {"sepal_length": 0.18982966369505322, "sepal_width": -1.9735536093907948, "petal_length": 0.13754657313091936, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.3621762455802712, "petal_length": 0.5354085615261415, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 0}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.3621762455802712, "petal_length": -0.08980313452349317, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.09821728693702184, "petal_length": 0.36489628078533215, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 6}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.13197947932162468, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.8225697780975633, "petal_length": 0.1943840000445223, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2}, {"sepal_length": 0.432165404582356, "sepal_width": -1.9735536093907948, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 2}, {"sepal_length": -0.29484181807955234, "sepal_width": -1.2829633106148564, "petal_length": 0.08070914621731616, "petal_width": -0.1307546363950324, "species": "versicolor", "cluster": 2}, {"sepal_length": 0.06866179325140237, "sepal_width": 0.32841405319566835, "petal_length": 0.5922459884397444, "petal_width": 0.7906706536370736, "species": "versicolor", "cluster": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.5923730118389178, "petal_length": 0.13754657313091936, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": -1.2829633106148564, "petal_length": 0.6490834153533479, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.5923730118389178, "petal_length": 0.5354085615261415, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": -0.3621762455802712, "petal_length": 0.30805885387172866, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0}, {"sepal_length": 0.9168368863569605, "sepal_width": -0.13197947932162468, "petal_length": 0.36489628078533215, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 0}, {"sepal_length": 1.1591726272442633, "sepal_width": -0.5923730118389178, "petal_length": 0.5922459884397444, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": -0.13197947932162468, "petal_length": 0.7059208422669508, "petal_width": 0.6590384693467726, "species": "versicolor", "cluster": 6}, {"sepal_length": 0.18982966369505322, "sepal_width": -0.3621762455802712, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -1.0527665443562098, "petal_length": -0.14664056143709636, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.513160076873503, "petal_length": 0.023871719303712964, "petal_width": -0.1307546363950324, "species": "versicolor", "cluster": 2}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.513160076873503, "petal_length": -0.032965707609889976, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.8225697780975633, "petal_length": 0.08070914621731616, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 2}, {"sepal_length": 0.18982966369505322, "sepal_width": -0.8225697780975633, "petal_length": 0.7627582691805538, "petal_width": 0.5274062850564719, "species": "versicolor", "cluster": 0}, {"sepal_length": -0.537177558966854, "sepal_width": -0.13197947932162468, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0}, {"sepal_length": 0.18982966369505322, "sepal_width": 0.7888075857129604, "petal_length": 0.4217337076989351, "petal_width": 0.5274062850564719, "species": "versicolor", "cluster": 6}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.09821728693702184, "petal_length": 0.5354085615261415, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 6}, {"sepal_length": 0.5533332750260068, "sepal_width": -1.7433568431321493, "petal_length": 0.36489628078533215, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 2}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.13197947932162468, "petal_length": 0.1943840000445223, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.2829633106148564, "petal_length": 0.13754657313091936, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 2}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.0527665443562098, "petal_length": 0.36489628078533215, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 2}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.13197947932162468, "petal_length": 0.47857113461253803, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -1.0527665443562098, "petal_length": 0.13754657313091936, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 2}, {"sepal_length": -1.0218490407414595, "sepal_width": -1.7433568431321493, "petal_length": -0.26031541526430274, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.8225697780975633, "petal_length": 0.2512214269581257, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 2}, {"sepal_length": -0.1736739476359004, "sepal_width": -0.13197947932162468, "petal_length": 0.2512214269581257, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -0.3621762455802712, "petal_length": 0.2512214269581257, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0}, {"sepal_length": 0.432165404582356, "sepal_width": -0.3621762455802712, "petal_length": 0.30805885387172866, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0}, {"sepal_length": -0.9006811702978088, "sepal_width": -1.2829633106148564, "petal_length": -0.4308276960051121, "petal_width": -0.1307546363950324, "species": "versicolor", "cluster": 2}, {"sepal_length": -0.1736739476359004, "sepal_width": -0.5923730118389178, "petal_length": 0.1943840000445223, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": 0.5586108194543139, "petal_length": 1.2742951114029821, "petal_width": 1.7120959436691794, "species": "virginica", "cluster": 6}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.8225697780975633, "petal_length": 0.7627582691805538, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 0}, {"sepal_length": 1.522676238575217, "sepal_width": -0.13197947932162468, "petal_length": 1.2174576844893792, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 4}, {"sepal_length": 0.5533332750260068, "sepal_width": -0.3621762455802712, "petal_length": 1.0469454037485695, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0}, {"sepal_length": 0.7956690159133096, "sepal_width": -0.13197947932162468, "petal_length": 1.1606202575757758, "petal_width": 1.317199390798277, "species": "virginica", "cluster": 6}, {"sepal_length": 2.1285155907934734, "sepal_width": -0.13197947932162468, "petal_length": 1.6153196728846009, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 4}, {"sepal_length": -1.1430169111851105, "sepal_width": -1.2829633106148564, "petal_length": 0.4217337076989351, "petal_width": 0.6590384693467726, "species": "virginica", "cluster": 2}, {"sepal_length": 1.7650119794625196, "sepal_width": -0.3621762455802712, "petal_length": 1.4448073921437916, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 4}, {"sepal_length": 1.0380047568006125, "sepal_width": -1.2829633106148564, "petal_length": 1.1606202575757758, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0}, {"sepal_length": 1.643844109018869, "sepal_width": 1.2492011182302534, "petal_length": 1.331132538316585, "petal_width": 1.7120959436691794, "species": "virginica", "cluster": 3}, {"sepal_length": 0.7956690159133096, "sepal_width": 0.32841405319566835, "petal_length": 0.7627582691805538, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 6}, {"sepal_length": 0.6745011454696588, "sepal_width": -0.8225697780975633, "petal_length": 0.8764331230077601, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 0}, {"sepal_length": 1.1591726272442633, "sepal_width": -0.13197947932162468, "petal_length": 0.9901079768349665, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 6}, {"sepal_length": -0.1736739476359004, "sepal_width": -1.2829633106148564, "petal_length": 0.7059208422669508, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.5923730118389178, "petal_length": 0.7627582691805538, "petal_width": 1.5804637593788784, "species": "virginica", "cluster": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": 0.32841405319566835, "petal_length": 0.8764331230077601, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6}, {"sepal_length": 0.7956690159133096, "sepal_width": -0.13197947932162468, "petal_length": 0.9901079768349665, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 6}, {"sepal_length": 2.2496834612371255, "sepal_width": 1.7095946507475455, "petal_length": 1.6721570997982043, "petal_width": 1.317199390798277, "species": "virginica", "cluster": 3}, {"sepal_length": 2.2496834612371255, "sepal_width": -1.0527665443562098, "petal_length": 1.7858319536254108, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 4}, {"sepal_length": 0.18982966369505322, "sepal_width": -1.9735536093907948, "petal_length": 0.7059208422669508, "petal_width": 0.3957741007661709, "species": "virginica", "cluster": 2}, {"sepal_length": 1.2803404976879151, "sepal_width": 0.32841405319566835, "petal_length": 1.1037828306621729, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.5923730118389178, "petal_length": 0.6490834153533479, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 0}, {"sepal_length": 2.2496834612371255, "sepal_width": -0.5923730118389178, "petal_length": 1.6721570997982043, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 4}, {"sepal_length": 0.5533332750260068, "sepal_width": -0.8225697780975633, "petal_length": 0.6490834153533479, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.5586108194543139, "petal_length": 1.1037828306621729, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 6}, {"sepal_length": 1.643844109018869, "sepal_width": 0.32841405319566835, "petal_length": 1.2742951114029821, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 4}, {"sepal_length": 0.432165404582356, "sepal_width": -0.5923730118389178, "petal_length": 0.5922459884397444, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.13197947932162468, "petal_length": 0.6490834153533479, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": -0.5923730118389178, "petal_length": 1.0469454037485695, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 6}, {"sepal_length": 1.643844109018869, "sepal_width": -0.13197947932162468, "petal_length": 1.1606202575757758, "petal_width": 0.5274062850564719, "species": "virginica", "cluster": 4}, {"sepal_length": 1.8861798499061717, "sepal_width": -0.5923730118389178, "petal_length": 1.331132538316585, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 4}, {"sepal_length": 2.4920192021244283, "sepal_width": 1.7095946507475455, "petal_length": 1.501644819057395, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 3}, {"sepal_length": 0.6745011454696588, "sepal_width": -0.5923730118389178, "petal_length": 1.0469454037485695, "petal_width": 1.317199390798277, "species": "virginica", "cluster": 6}, {"sepal_length": 0.5533332750260068, "sepal_width": -0.5923730118389178, "petal_length": 0.7627582691805538, "petal_width": 0.3957741007661709, "species": "virginica", "cluster": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -1.0527665443562098, "petal_length": 1.0469454037485695, "petal_width": 0.26414191647586993, "species": "virginica", "cluster": 0}, {"sepal_length": 2.2496834612371255, "sepal_width": -0.13197947932162468, "petal_length": 1.331132538316585, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 4}, {"sepal_length": 0.5533332750260068, "sepal_width": 0.7888075857129604, "petal_length": 1.0469454037485695, "petal_width": 1.5804637593788784, "species": "virginica", "cluster": 6}, {"sepal_length": 0.6745011454696588, "sepal_width": 0.09821728693702184, "petal_length": 0.9901079768349665, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 6}, {"sepal_length": 0.18982966369505322, "sepal_width": -0.13197947932162468, "petal_length": 0.5922459884397444, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0}, {"sepal_length": 1.2803404976879151, "sepal_width": 0.09821728693702184, "petal_length": 0.9332705499213636, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 6}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.09821728693702184, "petal_length": 1.0469454037485695, "petal_width": 1.5804637593788784, "species": "virginica", "cluster": 6}, {"sepal_length": 1.2803404976879151, "sepal_width": 0.09821728693702184, "petal_length": 0.7627582691805538, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.8225697780975633, "petal_length": 0.7627582691805538, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 0}, {"sepal_length": 1.1591726272442633, "sepal_width": 0.32841405319566835, "petal_length": 1.2174576844893792, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.5586108194543139, "petal_length": 1.1037828306621729, "petal_width": 1.7120959436691794, "species": "virginica", "cluster": 6}, {"sepal_length": 1.0380047568006125, "sepal_width": -0.13197947932162468, "petal_length": 0.8195956960941572, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6}, {"sepal_length": 0.5533332750260068, "sepal_width": -1.2829633106148564, "petal_length": 0.7059208422669508, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 0}, {"sepal_length": 0.7956690159133096, "sepal_width": -0.13197947932162468, "petal_length": 0.8195956960941572, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 6}, {"sepal_length": 0.432165404582356, "sepal_width": 0.7888075857129604, "petal_length": 0.9332705499213636, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6}, {"sepal_length": 0.06866179325140237, "sepal_width": -0.13197947932162468, "petal_length": 0.7627582691805538, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Usually, we will specify the number of clusters that we want. If not, the default number of clusters is 8. In the code above, it’s not that 8 was determined to be a good number of clusters, this is just the default.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">kmeans</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on KMeans in module sklearn.cluster._kmeans object:

class KMeans(_BaseKMeans)
 |  KMeans(n_clusters=8, *, init=&#39;k-means++&#39;, n_init=&#39;warn&#39;, max_iter=300, tol=0.0001, verbose=0, random_state=None, copy_x=True, algorithm=&#39;lloyd&#39;)
 |  
 |  K-Means clustering.
 |  
 |  Read more in the :ref:`User Guide &lt;k_means&gt;`.
 |  
 |  Parameters
 |  ----------
 |  
 |  n_clusters : int, default=8
 |      The number of clusters to form as well as the number of
 |      centroids to generate.
 |  
 |  init : {&#39;k-means++&#39;, &#39;random&#39;}, callable or array-like of shape             (n_clusters, n_features), default=&#39;k-means++&#39;
 |      Method for initialization:
 |  
 |      &#39;k-means++&#39; : selects initial cluster centroids using sampling based on
 |      an empirical probability distribution of the points&#39; contribution to the
 |      overall inertia. This technique speeds up convergence. The algorithm
 |      implemented is &quot;greedy k-means++&quot;. It differs from the vanilla k-means++
 |      by making several trials at each sampling step and choosing the best centroid
 |      among them.
 |  
 |      &#39;random&#39;: choose `n_clusters` observations (rows) at random from data
 |      for the initial centroids.
 |  
 |      If an array is passed, it should be of shape (n_clusters, n_features)
 |      and gives the initial centers.
 |  
 |      If a callable is passed, it should take arguments X, n_clusters and a
 |      random state and return an initialization.
 |  
 |  n_init : &#39;auto&#39; or int, default=10
 |      Number of times the k-means algorithm is run with different centroid
 |      seeds. The final results is the best output of `n_init` consecutive runs
 |      in terms of inertia. Several runs are recommended for sparse
 |      high-dimensional problems (see :ref:`kmeans_sparse_high_dim`).
 |  
 |      When `n_init=&#39;auto&#39;`, the number of runs depends on the value of init:
 |      10 if using `init=&#39;random&#39;` or `init` is a callable;
 |      1 if using `init=&#39;k-means++&#39;` or `init` is an array-like.
 |  
 |      .. versionadded:: 1.2
 |         Added &#39;auto&#39; option for `n_init`.
 |  
 |      .. versionchanged:: 1.4
 |         Default value for `n_init` will change from 10 to `&#39;auto&#39;` in version 1.4.
 |  
 |  max_iter : int, default=300
 |      Maximum number of iterations of the k-means algorithm for a
 |      single run.
 |  
 |  tol : float, default=1e-4
 |      Relative tolerance with regards to Frobenius norm of the difference
 |      in the cluster centers of two consecutive iterations to declare
 |      convergence.
 |  
 |  verbose : int, default=0
 |      Verbosity mode.
 |  
 |  random_state : int, RandomState instance or None, default=None
 |      Determines random number generation for centroid initialization. Use
 |      an int to make the randomness deterministic.
 |      See :term:`Glossary &lt;random_state&gt;`.
 |  
 |  copy_x : bool, default=True
 |      When pre-computing distances it is more numerically accurate to center
 |      the data first. If copy_x is True (default), then the original data is
 |      not modified. If False, the original data is modified, and put back
 |      before the function returns, but small numerical differences may be
 |      introduced by subtracting and then adding the data mean. Note that if
 |      the original data is not C-contiguous, a copy will be made even if
 |      copy_x is False. If the original data is sparse, but not in CSR format,
 |      a copy will be made even if copy_x is False.
 |  
 |  algorithm : {&quot;lloyd&quot;, &quot;elkan&quot;, &quot;auto&quot;, &quot;full&quot;}, default=&quot;lloyd&quot;
 |      K-means algorithm to use. The classical EM-style algorithm is `&quot;lloyd&quot;`.
 |      The `&quot;elkan&quot;` variation can be more efficient on some datasets with
 |      well-defined clusters, by using the triangle inequality. However it&#39;s
 |      more memory intensive due to the allocation of an extra array of shape
 |      `(n_samples, n_clusters)`.
 |  
 |      `&quot;auto&quot;` and `&quot;full&quot;` are deprecated and they will be removed in
 |      Scikit-Learn 1.3. They are both aliases for `&quot;lloyd&quot;`.
 |  
 |      .. versionchanged:: 0.18
 |          Added Elkan algorithm
 |  
 |      .. versionchanged:: 1.1
 |          Renamed &quot;full&quot; to &quot;lloyd&quot;, and deprecated &quot;auto&quot; and &quot;full&quot;.
 |          Changed &quot;auto&quot; to use &quot;lloyd&quot; instead of &quot;elkan&quot;.
 |  
 |  Attributes
 |  ----------
 |  cluster_centers_ : ndarray of shape (n_clusters, n_features)
 |      Coordinates of cluster centers. If the algorithm stops before fully
 |      converging (see ``tol`` and ``max_iter``), these will not be
 |      consistent with ``labels_``.
 |  
 |  labels_ : ndarray of shape (n_samples,)
 |      Labels of each point
 |  
 |  inertia_ : float
 |      Sum of squared distances of samples to their closest cluster center,
 |      weighted by the sample weights if provided.
 |  
 |  n_iter_ : int
 |      Number of iterations run.
 |  
 |  n_features_in_ : int
 |      Number of features seen during :term:`fit`.
 |  
 |      .. versionadded:: 0.24
 |  
 |  feature_names_in_ : ndarray of shape (`n_features_in_`,)
 |      Names of features seen during :term:`fit`. Defined only when `X`
 |      has feature names that are all strings.
 |  
 |      .. versionadded:: 1.0
 |  
 |  See Also
 |  --------
 |  MiniBatchKMeans : Alternative online implementation that does incremental
 |      updates of the centers positions using mini-batches.
 |      For large scale learning (say n_samples &gt; 10k) MiniBatchKMeans is
 |      probably much faster than the default batch implementation.
 |  
 |  Notes
 |  -----
 |  The k-means problem is solved using either Lloyd&#39;s or Elkan&#39;s algorithm.
 |  
 |  The average complexity is given by O(k n T), where n is the number of
 |  samples and T is the number of iteration.
 |  
 |  The worst case complexity is given by O(n^(k+2/p)) with
 |  n = n_samples, p = n_features.
 |  Refer to :doi:`&quot;How slow is the k-means method?&quot; D. Arthur and S. Vassilvitskii -
 |  SoCG2006.&lt;10.1145/1137856.1137880&gt;` for more details.
 |  
 |  In practice, the k-means algorithm is very fast (one of the fastest
 |  clustering algorithms available), but it falls in local minima. That&#39;s why
 |  it can be useful to restart it several times.
 |  
 |  If the algorithm stops before fully converging (because of ``tol`` or
 |  ``max_iter``), ``labels_`` and ``cluster_centers_`` will not be consistent,
 |  i.e. the ``cluster_centers_`` will not be the means of the points in each
 |  cluster. Also, the estimator will reassign ``labels_`` after the last
 |  iteration to make ``labels_`` consistent with ``predict`` on the training
 |  set.
 |  
 |  Examples
 |  --------
 |  
 |  &gt;&gt;&gt; from sklearn.cluster import KMeans
 |  &gt;&gt;&gt; import numpy as np
 |  &gt;&gt;&gt; X = np.array([[1, 2], [1, 4], [1, 0],
 |  ...               [10, 2], [10, 4], [10, 0]])
 |  &gt;&gt;&gt; kmeans = KMeans(n_clusters=2, random_state=0, n_init=&quot;auto&quot;).fit(X)
 |  &gt;&gt;&gt; kmeans.labels_
 |  array([1, 1, 1, 0, 0, 0], dtype=int32)
 |  &gt;&gt;&gt; kmeans.predict([[0, 0], [12, 3]])
 |  array([1, 0], dtype=int32)
 |  &gt;&gt;&gt; kmeans.cluster_centers_
 |  array([[10.,  2.],
 |         [ 1.,  2.]])
 |  
 |  Method resolution order:
 |      KMeans
 |      _BaseKMeans
 |      sklearn.base.ClassNamePrefixFeaturesOutMixin
 |      sklearn.base.TransformerMixin
 |      sklearn.utils._set_output._SetOutputMixin
 |      sklearn.base.ClusterMixin
 |      sklearn.base.BaseEstimator
 |      sklearn.utils._metadata_requests._MetadataRequester
 |      abc.ABC
 |      builtins.object
 |  
 |  Methods defined here:
 |  
 |  __init__(self, n_clusters=8, *, init=&#39;k-means++&#39;, n_init=&#39;warn&#39;, max_iter=300, tol=0.0001, verbose=0, random_state=None, copy_x=True, algorithm=&#39;lloyd&#39;)
 |      Initialize self.  See help(type(self)) for accurate signature.
 |  
 |  fit(self, X, y=None, sample_weight=None)
 |      Compute k-means clustering.
 |      
 |      Parameters
 |      ----------
 |      X : {array-like, sparse matrix} of shape (n_samples, n_features)
 |          Training instances to cluster. It must be noted that the data
 |          will be converted to C ordering, which will cause a memory
 |          copy if the given data is not C-contiguous.
 |          If a sparse matrix is passed, a copy will be made if it&#39;s not in
 |          CSR format.
 |      
 |      y : Ignored
 |          Not used, present here for API consistency by convention.
 |      
 |      sample_weight : array-like of shape (n_samples,), default=None
 |          The weights for each observation in X. If None, all observations
 |          are assigned equal weight. `sample_weight` is not used during
 |          initialization if `init` is a callable or a user provided array.
 |      
 |          .. versionadded:: 0.20
 |      
 |      Returns
 |      -------
 |      self : object
 |          Fitted estimator.
 |  
 |  set_fit_request(self: sklearn.cluster._kmeans.KMeans, *, sample_weight: Union[bool, NoneType, str] = &#39;$UNCHANGED$&#39;) -&gt; sklearn.cluster._kmeans.KMeans
 |      Request metadata passed to the ``fit`` method.
 |      
 |      Note that this method is only relevant if
 |      ``enable_metadata_routing=True`` (see :func:`sklearn.set_config`).
 |      Please see :ref:`User Guide &lt;metadata_routing&gt;` on how the routing
 |      mechanism works.
 |      
 |      The options for each parameter are:
 |      
 |      - ``True``: metadata is requested, and passed to ``fit`` if provided. The request is ignored if metadata is not provided.
 |      
 |      - ``False``: metadata is not requested and the meta-estimator will not pass it to ``fit``.
 |      
 |      - ``None``: metadata is not requested, and the meta-estimator will raise an error if the user provides it.
 |      
 |      - ``str``: metadata should be passed to the meta-estimator with this given alias instead of the original name.
 |      
 |      The default (``sklearn.utils.metadata_routing.UNCHANGED``) retains the
 |      existing request. This allows you to change the request for some
 |      parameters and not others.
 |      
 |      .. versionadded:: 1.3
 |      
 |      .. note::
 |          This method is only relevant if this estimator is used as a
 |          sub-estimator of a meta-estimator, e.g. used inside a
 |          :class:`pipeline.Pipeline`. Otherwise it has no effect.
 |      
 |      Parameters
 |      ----------
 |      sample_weight : str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED
 |          Metadata routing for ``sample_weight`` parameter in ``fit``.
 |      
 |      Returns
 |      -------
 |      self : object
 |          The updated object.
 |  
 |  set_predict_request(self: sklearn.cluster._kmeans.KMeans, *, sample_weight: Union[bool, NoneType, str] = &#39;$UNCHANGED$&#39;) -&gt; sklearn.cluster._kmeans.KMeans
 |      Request metadata passed to the ``predict`` method.
 |      
 |      Note that this method is only relevant if
 |      ``enable_metadata_routing=True`` (see :func:`sklearn.set_config`).
 |      Please see :ref:`User Guide &lt;metadata_routing&gt;` on how the routing
 |      mechanism works.
 |      
 |      The options for each parameter are:
 |      
 |      - ``True``: metadata is requested, and passed to ``predict`` if provided. The request is ignored if metadata is not provided.
 |      
 |      - ``False``: metadata is not requested and the meta-estimator will not pass it to ``predict``.
 |      
 |      - ``None``: metadata is not requested, and the meta-estimator will raise an error if the user provides it.
 |      
 |      - ``str``: metadata should be passed to the meta-estimator with this given alias instead of the original name.
 |      
 |      The default (``sklearn.utils.metadata_routing.UNCHANGED``) retains the
 |      existing request. This allows you to change the request for some
 |      parameters and not others.
 |      
 |      .. versionadded:: 1.3
 |      
 |      .. note::
 |          This method is only relevant if this estimator is used as a
 |          sub-estimator of a meta-estimator, e.g. used inside a
 |          :class:`pipeline.Pipeline`. Otherwise it has no effect.
 |      
 |      Parameters
 |      ----------
 |      sample_weight : str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED
 |          Metadata routing for ``sample_weight`` parameter in ``predict``.
 |      
 |      Returns
 |      -------
 |      self : object
 |          The updated object.
 |  
 |  set_score_request(self: sklearn.cluster._kmeans.KMeans, *, sample_weight: Union[bool, NoneType, str] = &#39;$UNCHANGED$&#39;) -&gt; sklearn.cluster._kmeans.KMeans
 |      Request metadata passed to the ``score`` method.
 |      
 |      Note that this method is only relevant if
 |      ``enable_metadata_routing=True`` (see :func:`sklearn.set_config`).
 |      Please see :ref:`User Guide &lt;metadata_routing&gt;` on how the routing
 |      mechanism works.
 |      
 |      The options for each parameter are:
 |      
 |      - ``True``: metadata is requested, and passed to ``score`` if provided. The request is ignored if metadata is not provided.
 |      
 |      - ``False``: metadata is not requested and the meta-estimator will not pass it to ``score``.
 |      
 |      - ``None``: metadata is not requested, and the meta-estimator will raise an error if the user provides it.
 |      
 |      - ``str``: metadata should be passed to the meta-estimator with this given alias instead of the original name.
 |      
 |      The default (``sklearn.utils.metadata_routing.UNCHANGED``) retains the
 |      existing request. This allows you to change the request for some
 |      parameters and not others.
 |      
 |      .. versionadded:: 1.3
 |      
 |      .. note::
 |          This method is only relevant if this estimator is used as a
 |          sub-estimator of a meta-estimator, e.g. used inside a
 |          :class:`pipeline.Pipeline`. Otherwise it has no effect.
 |      
 |      Parameters
 |      ----------
 |      sample_weight : str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED
 |          Metadata routing for ``sample_weight`` parameter in ``score``.
 |      
 |      Returns
 |      -------
 |      self : object
 |          The updated object.
 |  
 |  ----------------------------------------------------------------------
 |  Data and other attributes defined here:
 |  
 |  __abstractmethods__ = frozenset()
 |  
 |  __annotations__ = {&#39;_parameter_constraints&#39;: &lt;class &#39;dict&#39;&gt;}
 |  
 |  ----------------------------------------------------------------------
 |  Methods inherited from _BaseKMeans:
 |  
 |  fit_predict(self, X, y=None, sample_weight=None)
 |      Compute cluster centers and predict cluster index for each sample.
 |      
 |      Convenience method; equivalent to calling fit(X) followed by
 |      predict(X).
 |      
 |      Parameters
 |      ----------
 |      X : {array-like, sparse matrix} of shape (n_samples, n_features)
 |          New data to transform.
 |      
 |      y : Ignored
 |          Not used, present here for API consistency by convention.
 |      
 |      sample_weight : array-like of shape (n_samples,), default=None
 |          The weights for each observation in X. If None, all observations
 |          are assigned equal weight.
 |      
 |      Returns
 |      -------
 |      labels : ndarray of shape (n_samples,)
 |          Index of the cluster each sample belongs to.
 |  
 |  fit_transform(self, X, y=None, sample_weight=None)
 |      Compute clustering and transform X to cluster-distance space.
 |      
 |      Equivalent to fit(X).transform(X), but more efficiently implemented.
 |      
 |      Parameters
 |      ----------
 |      X : {array-like, sparse matrix} of shape (n_samples, n_features)
 |          New data to transform.
 |      
 |      y : Ignored
 |          Not used, present here for API consistency by convention.
 |      
 |      sample_weight : array-like of shape (n_samples,), default=None
 |          The weights for each observation in X. If None, all observations
 |          are assigned equal weight.
 |      
 |      Returns
 |      -------
 |      X_new : ndarray of shape (n_samples, n_clusters)
 |          X transformed in the new space.
 |  
 |  predict(self, X, sample_weight=&#39;deprecated&#39;)
 |      Predict the closest cluster each sample in X belongs to.
 |      
 |      In the vector quantization literature, `cluster_centers_` is called
 |      the code book and each value returned by `predict` is the index of
 |      the closest code in the code book.
 |      
 |      Parameters
 |      ----------
 |      X : {array-like, sparse matrix} of shape (n_samples, n_features)
 |          New data to predict.
 |      
 |      sample_weight : array-like of shape (n_samples,), default=None
 |          The weights for each observation in X. If None, all observations
 |          are assigned equal weight.
 |      
 |          .. deprecated:: 1.3
 |             The parameter `sample_weight` is deprecated in version 1.3
 |             and will be removed in 1.5.
 |      
 |      Returns
 |      -------
 |      labels : ndarray of shape (n_samples,)
 |          Index of the cluster each sample belongs to.
 |  
 |  score(self, X, y=None, sample_weight=None)
 |      Opposite of the value of X on the K-means objective.
 |      
 |      Parameters
 |      ----------
 |      X : {array-like, sparse matrix} of shape (n_samples, n_features)
 |          New data.
 |      
 |      y : Ignored
 |          Not used, present here for API consistency by convention.
 |      
 |      sample_weight : array-like of shape (n_samples,), default=None
 |          The weights for each observation in X. If None, all observations
 |          are assigned equal weight.
 |      
 |      Returns
 |      -------
 |      score : float
 |          Opposite of the value of X on the K-means objective.
 |  
 |  transform(self, X)
 |      Transform X to a cluster-distance space.
 |      
 |      In the new space, each dimension is the distance to the cluster
 |      centers. Note that even if X is sparse, the array returned by
 |      `transform` will typically be dense.
 |      
 |      Parameters
 |      ----------
 |      X : {array-like, sparse matrix} of shape (n_samples, n_features)
 |          New data to transform.
 |      
 |      Returns
 |      -------
 |      X_new : ndarray of shape (n_samples, n_clusters)
 |          X transformed in the new space.
 |  
 |  ----------------------------------------------------------------------
 |  Methods inherited from sklearn.base.ClassNamePrefixFeaturesOutMixin:
 |  
 |  get_feature_names_out(self, input_features=None)
 |      Get output feature names for transformation.
 |      
 |      The feature names out will prefixed by the lowercased class name. For
 |      example, if the transformer outputs 3 features, then the feature names
 |      out are: `[&quot;class_name0&quot;, &quot;class_name1&quot;, &quot;class_name2&quot;]`.
 |      
 |      Parameters
 |      ----------
 |      input_features : array-like of str or None, default=None
 |          Only used to validate feature names with the names seen in :meth:`fit`.
 |      
 |      Returns
 |      -------
 |      feature_names_out : ndarray of str objects
 |          Transformed feature names.
 |  
 |  ----------------------------------------------------------------------
 |  Data descriptors inherited from sklearn.base.ClassNamePrefixFeaturesOutMixin:
 |  
 |  __dict__
 |      dictionary for instance variables (if defined)
 |  
 |  __weakref__
 |      list of weak references to the object (if defined)
 |  
 |  ----------------------------------------------------------------------
 |  Methods inherited from sklearn.utils._set_output._SetOutputMixin:
 |  
 |  set_output(self, *, transform=None)
 |      Set output container.
 |      
 |      See :ref:`sphx_glr_auto_examples_miscellaneous_plot_set_output.py`
 |      for an example on how to use the API.
 |      
 |      Parameters
 |      ----------
 |      transform : {&quot;default&quot;, &quot;pandas&quot;}, default=None
 |          Configure output of `transform` and `fit_transform`.
 |      
 |          - `&quot;default&quot;`: Default output format of a transformer
 |          - `&quot;pandas&quot;`: DataFrame output
 |          - `None`: Transform configuration is unchanged
 |      
 |      Returns
 |      -------
 |      self : estimator instance
 |          Estimator instance.
 |  
 |  ----------------------------------------------------------------------
 |  Class methods inherited from sklearn.utils._set_output._SetOutputMixin:
 |  
 |  __init_subclass__(auto_wrap_output_keys=(&#39;transform&#39;,), **kwargs) from abc.ABCMeta
 |      This method is called when a class is subclassed.
 |      
 |      The default implementation does nothing. It may be
 |      overridden to extend subclasses.
 |  
 |  ----------------------------------------------------------------------
 |  Methods inherited from sklearn.base.BaseEstimator:
 |  
 |  __getstate__(self)
 |  
 |  __repr__(self, N_CHAR_MAX=700)
 |      Return repr(self).
 |  
 |  __setstate__(self, state)
 |  
 |  __sklearn_clone__(self)
 |  
 |  get_params(self, deep=True)
 |      Get parameters for this estimator.
 |      
 |      Parameters
 |      ----------
 |      deep : bool, default=True
 |          If True, will return the parameters for this estimator and
 |          contained subobjects that are estimators.
 |      
 |      Returns
 |      -------
 |      params : dict
 |          Parameter names mapped to their values.
 |  
 |  set_params(self, **params)
 |      Set the parameters of this estimator.
 |      
 |      The method works on simple estimators as well as on nested objects
 |      (such as :class:`~sklearn.pipeline.Pipeline`). The latter have
 |      parameters of the form ``&lt;component&gt;__&lt;parameter&gt;`` so that it&#39;s
 |      possible to update each component of a nested object.
 |      
 |      Parameters
 |      ----------
 |      **params : dict
 |          Estimator parameters.
 |      
 |      Returns
 |      -------
 |      self : estimator instance
 |          Estimator instance.
 |  
 |  ----------------------------------------------------------------------
 |  Methods inherited from sklearn.utils._metadata_requests._MetadataRequester:
 |  
 |  get_metadata_routing(self)
 |      Get metadata routing of this object.
 |      
 |      Please check :ref:`User Guide &lt;metadata_routing&gt;` on how the routing
 |      mechanism works.
 |      
 |      Returns
 |      -------
 |      routing : MetadataRequest
 |          A :class:`~utils.metadata_routing.MetadataRequest` encapsulating
 |          routing information.
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Create a new <code class="docutils literal notranslate"><span class="pre">KMeans</span></code> object named <code class="docutils literal notranslate"><span class="pre">kmeans2</span></code> and specify that it should include 2 clusters.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans2</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Fit <code class="docutils literal notranslate"><span class="pre">kmeans2</span></code> and then store the predictions in a new column called cluster2.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numcols</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/yasmeen/opt/miniconda3/envs/math9/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py:1412: FutureWarning: The default value of `n_init` will change from 10 to &#39;auto&#39; in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-3 {color: black;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KMeans(n_clusters=2)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" checked><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">KMeans</label><div class="sk-toggleable__content"><pre>KMeans(n_clusters=2)</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;cluster2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">numcols</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Make the same altair chart as above, but now with the colors and shapes determined by cluster2.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;sepal_length&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;petal_length&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;cluster2:N&quot;</span><span class="p">,</span>
    <span class="n">shape</span><span class="o">=</span><span class="s2">&quot;cluster2:N&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-14978516b14341728d33e62ce75f6cbe.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-14978516b14341728d33e62ce75f6cbe.vega-embed details,
  #altair-viz-14978516b14341728d33e62ce75f6cbe.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-14978516b14341728d33e62ce75f6cbe"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-14978516b14341728d33e62ce75f6cbe") {
      outputDiv = document.getElementById("altair-viz-14978516b14341728d33e62ce75f6cbe");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-ba6cbfa25cc10c9c6102be1de7f532af"}, "mark": {"type": "point", "filled": true, "size": 100}, "encoding": {"color": {"field": "cluster2", "type": "nominal"}, "shape": {"field": "cluster2", "type": "nominal"}, "x": {"field": "sepal_length", "type": "quantitative"}, "y": {"field": "petal_length", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-ba6cbfa25cc10c9c6102be1de7f532af": [{"sepal_length": -0.9006811702978088, "sepal_width": 1.019004351971607, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.1430169111851105, "sepal_width": -0.13197947932162468, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.3853526520724133, "sepal_width": 0.32841405319566835, "petal_length": -1.3970639535363654, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.5065205225160652, "sepal_width": 0.09821728693702184, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 1.2492011182302534, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.537177558966854, "sepal_width": 1.939791417006192, "petal_length": -1.1697142458819532, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -1.5065205225160652, "sepal_width": 0.7888075857129604, "petal_length": -1.3402265266227624, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 0.7888075857129604, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.7488562634033669, "sepal_width": -0.3621762455802712, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.1430169111851105, "sepal_width": 0.09821728693702184, "petal_length": -1.2833890997091593, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -0.537177558966854, "sepal_width": 1.4793978844889, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -1.2641847816287624, "sepal_width": 0.7888075857129604, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.2641847816287624, "sepal_width": -0.13197947932162468, "petal_length": -1.3402265266227624, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.870024133847019, "sepal_width": -0.13197947932162468, "petal_length": -1.5107388073635717, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -0.05250607719224957, "sepal_width": 2.1699881832648384, "petal_length": -1.4539013804499687, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -0.1736739476359004, "sepal_width": 3.090775248299425, "petal_length": -1.2833890997091593, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -0.537177558966854, "sepal_width": 1.939791417006192, "petal_length": -1.3970639535363654, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.019004351971607, "petal_length": -1.3402265266227624, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.1736739476359004, "sepal_width": 1.7095946507475455, "petal_length": -1.1697142458819532, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.7095946507475455, "petal_length": -1.2833890997091593, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -0.537177558966854, "sepal_width": 0.7888075857129604, "petal_length": -1.1697142458819532, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.4793978844889, "petal_length": -1.2833890997091593, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.5065205225160652, "sepal_width": 1.2492011182302534, "petal_length": -1.567576234277175, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 0.5586108194543139, "petal_length": -1.1697142458819532, "petal_width": -0.9205477421368377, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.2641847816287624, "sepal_width": 0.7888075857129604, "petal_length": -1.0560393920547466, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": -0.13197947932162468, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 0.7888075857129604, "petal_length": -1.226551672795556, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.7795132998541568, "sepal_width": 1.019004351971607, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.7795132998541568, "sepal_width": 0.7888075857129604, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.3853526520724133, "sepal_width": 0.32841405319566835, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.2641847816287624, "sepal_width": 0.09821728693702184, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -0.537177558966854, "sepal_width": 0.7888075857129604, "petal_length": -1.2833890997091593, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.7795132998541568, "sepal_width": 2.400184949523484, "petal_length": -1.2833890997091593, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -0.4160096885232032, "sepal_width": 2.6303817157821316, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -1.1430169111851105, "sepal_width": 0.09821728693702184, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 0.32841405319566835, "petal_length": -1.4539013804499687, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -0.4160096885232032, "sepal_width": 1.019004351971607, "petal_length": -1.3970639535363654, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.1430169111851105, "sepal_width": 1.2492011182302534, "petal_length": -1.3402265266227624, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.7488562634033669, "sepal_width": -0.13197947932162468, "petal_length": -1.3970639535363654, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 0.7888075857129604, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 1.019004351971607, "petal_length": -1.3970639535363654, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.6276883929597161, "sepal_width": -1.7433568431321493, "petal_length": -1.3970639535363654, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.7488562634033669, "sepal_width": 0.32841405319566835, "petal_length": -1.3970639535363654, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 1.019004351971607, "petal_length": -1.226551672795556, "petal_width": -0.7889155578465368, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.7095946507475455, "petal_length": -1.0560393920547466, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -1.2641847816287624, "sepal_width": -0.13197947932162468, "petal_length": -1.3402265266227624, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.7095946507475455, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -1.5065205225160652, "sepal_width": 0.32841405319566835, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -0.658345429410506, "sepal_width": 1.4793978844889, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 0.5586108194543139, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": 1.401508368131566, "sepal_width": 0.32841405319566835, "petal_length": 0.5354085615261415, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": 0.32841405319566835, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.2803404976879151, "sepal_width": 0.09821728693702184, "petal_length": 0.6490834153533479, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.7433568431321493, "petal_length": 0.13754657313091936, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.7956690159133096, "sepal_width": -0.5923730118389178, "petal_length": 0.47857113461253803, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -0.5923730118389178, "petal_length": 0.4217337076989351, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": 0.5586108194543139, "petal_length": 0.5354085615261415, "petal_width": 0.5274062850564719, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": -1.1430169111851105, "sepal_width": -1.513160076873503, "petal_length": -0.26031541526430274, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.9168368863569605, "sepal_width": -0.3621762455802712, "petal_length": 0.47857113461253803, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.7795132998541568, "sepal_width": -0.8225697780975633, "petal_length": 0.08070914621731616, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -1.0218490407414595, "sepal_width": -2.433947141908088, "petal_length": -0.14664056143709636, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.06866179325140237, "sepal_width": -0.13197947932162468, "petal_length": 0.2512214269581257, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.18982966369505322, "sepal_width": -1.9735536093907948, "petal_length": 0.13754657313091936, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.3621762455802712, "petal_length": 0.5354085615261415, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.3621762455802712, "petal_length": -0.08980313452349317, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.09821728693702184, "petal_length": 0.36489628078533215, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.13197947932162468, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.8225697780975633, "petal_length": 0.1943840000445223, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.432165404582356, "sepal_width": -1.9735536093907948, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.29484181807955234, "sepal_width": -1.2829633106148564, "petal_length": 0.08070914621731616, "petal_width": -0.1307546363950324, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.06866179325140237, "sepal_width": 0.32841405319566835, "petal_length": 0.5922459884397444, "petal_width": 0.7906706536370736, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.5923730118389178, "petal_length": 0.13754657313091936, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": -1.2829633106148564, "petal_length": 0.6490834153533479, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.5923730118389178, "petal_length": 0.5354085615261415, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": -0.3621762455802712, "petal_length": 0.30805885387172866, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.9168368863569605, "sepal_width": -0.13197947932162468, "petal_length": 0.36489628078533215, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.1591726272442633, "sepal_width": -0.5923730118389178, "petal_length": 0.5922459884397444, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": -0.13197947932162468, "petal_length": 0.7059208422669508, "petal_width": 0.6590384693467726, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.18982966369505322, "sepal_width": -0.3621762455802712, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -1.0527665443562098, "petal_length": -0.14664056143709636, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.513160076873503, "petal_length": 0.023871719303712964, "petal_width": -0.1307546363950324, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.513160076873503, "petal_length": -0.032965707609889976, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.8225697780975633, "petal_length": 0.08070914621731616, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.18982966369505322, "sepal_width": -0.8225697780975633, "petal_length": 0.7627582691805538, "petal_width": 0.5274062850564719, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.537177558966854, "sepal_width": -0.13197947932162468, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.18982966369505322, "sepal_width": 0.7888075857129604, "petal_length": 0.4217337076989351, "petal_width": 0.5274062850564719, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.09821728693702184, "petal_length": 0.5354085615261415, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": -1.7433568431321493, "petal_length": 0.36489628078533215, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.13197947932162468, "petal_length": 0.1943840000445223, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.2829633106148564, "petal_length": 0.13754657313091936, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.0527665443562098, "petal_length": 0.36489628078533215, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.13197947932162468, "petal_length": 0.47857113461253803, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -1.0527665443562098, "petal_length": 0.13754657313091936, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -1.0218490407414595, "sepal_width": -1.7433568431321493, "petal_length": -0.26031541526430274, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.8225697780975633, "petal_length": 0.2512214269581257, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -0.13197947932162468, "petal_length": 0.2512214269581257, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -0.3621762455802712, "petal_length": 0.2512214269581257, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.432165404582356, "sepal_width": -0.3621762455802712, "petal_length": 0.30805885387172866, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.9006811702978088, "sepal_width": -1.2829633106148564, "petal_length": -0.4308276960051121, "petal_width": -0.1307546363950324, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -0.5923730118389178, "petal_length": 0.1943840000445223, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": 0.5586108194543139, "petal_length": 1.2742951114029821, "petal_width": 1.7120959436691794, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.8225697780975633, "petal_length": 0.7627582691805538, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.522676238575217, "sepal_width": -0.13197947932162468, "petal_length": 1.2174576844893792, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": -0.3621762455802712, "petal_length": 1.0469454037485695, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.7956690159133096, "sepal_width": -0.13197947932162468, "petal_length": 1.1606202575757758, "petal_width": 1.317199390798277, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 2.1285155907934734, "sepal_width": -0.13197947932162468, "petal_length": 1.6153196728846009, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": -1.1430169111851105, "sepal_width": -1.2829633106148564, "petal_length": 0.4217337076989351, "petal_width": 0.6590384693467726, "species": "virginica", "cluster": 2, "cluster2": 0}, {"sepal_length": 1.7650119794625196, "sepal_width": -0.3621762455802712, "petal_length": 1.4448073921437916, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": -1.2829633106148564, "petal_length": 1.1606202575757758, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.643844109018869, "sepal_width": 1.2492011182302534, "petal_length": 1.331132538316585, "petal_width": 1.7120959436691794, "species": "virginica", "cluster": 3, "cluster2": 0}, {"sepal_length": 0.7956690159133096, "sepal_width": 0.32841405319566835, "petal_length": 0.7627582691805538, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": -0.8225697780975633, "petal_length": 0.8764331230077601, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.1591726272442633, "sepal_width": -0.13197947932162468, "petal_length": 0.9901079768349665, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -1.2829633106148564, "petal_length": 0.7059208422669508, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.5923730118389178, "petal_length": 0.7627582691805538, "petal_width": 1.5804637593788784, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": 0.32841405319566835, "petal_length": 0.8764331230077601, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.7956690159133096, "sepal_width": -0.13197947932162468, "petal_length": 0.9901079768349665, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 2.2496834612371255, "sepal_width": 1.7095946507475455, "petal_length": 1.6721570997982043, "petal_width": 1.317199390798277, "species": "virginica", "cluster": 3, "cluster2": 0}, {"sepal_length": 2.2496834612371255, "sepal_width": -1.0527665443562098, "petal_length": 1.7858319536254108, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 0.18982966369505322, "sepal_width": -1.9735536093907948, "petal_length": 0.7059208422669508, "petal_width": 0.3957741007661709, "species": "virginica", "cluster": 2, "cluster2": 0}, {"sepal_length": 1.2803404976879151, "sepal_width": 0.32841405319566835, "petal_length": 1.1037828306621729, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.5923730118389178, "petal_length": 0.6490834153533479, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 2.2496834612371255, "sepal_width": -0.5923730118389178, "petal_length": 1.6721570997982043, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": -0.8225697780975633, "petal_length": 0.6490834153533479, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.5586108194543139, "petal_length": 1.1037828306621729, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.643844109018869, "sepal_width": 0.32841405319566835, "petal_length": 1.2742951114029821, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 0.432165404582356, "sepal_width": -0.5923730118389178, "petal_length": 0.5922459884397444, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.13197947932162468, "petal_length": 0.6490834153533479, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": -0.5923730118389178, "petal_length": 1.0469454037485695, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.643844109018869, "sepal_width": -0.13197947932162468, "petal_length": 1.1606202575757758, "petal_width": 0.5274062850564719, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 1.8861798499061717, "sepal_width": -0.5923730118389178, "petal_length": 1.331132538316585, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 2.4920192021244283, "sepal_width": 1.7095946507475455, "petal_length": 1.501644819057395, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 3, "cluster2": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": -0.5923730118389178, "petal_length": 1.0469454037485695, "petal_width": 1.317199390798277, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": -0.5923730118389178, "petal_length": 0.7627582691805538, "petal_width": 0.3957741007661709, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -1.0527665443562098, "petal_length": 1.0469454037485695, "petal_width": 0.26414191647586993, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 2.2496834612371255, "sepal_width": -0.13197947932162468, "petal_length": 1.331132538316585, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": 0.7888075857129604, "petal_length": 1.0469454037485695, "petal_width": 1.5804637593788784, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": 0.09821728693702184, "petal_length": 0.9901079768349665, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.18982966369505322, "sepal_width": -0.13197947932162468, "petal_length": 0.5922459884397444, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.2803404976879151, "sepal_width": 0.09821728693702184, "petal_length": 0.9332705499213636, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.09821728693702184, "petal_length": 1.0469454037485695, "petal_width": 1.5804637593788784, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.2803404976879151, "sepal_width": 0.09821728693702184, "petal_length": 0.7627582691805538, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.8225697780975633, "petal_length": 0.7627582691805538, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.1591726272442633, "sepal_width": 0.32841405319566835, "petal_length": 1.2174576844893792, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.5586108194543139, "petal_length": 1.1037828306621729, "petal_width": 1.7120959436691794, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": -0.13197947932162468, "petal_length": 0.8195956960941572, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": -1.2829633106148564, "petal_length": 0.7059208422669508, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.7956690159133096, "sepal_width": -0.13197947932162468, "petal_length": 0.8195956960941572, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.432165404582356, "sepal_width": 0.7888075857129604, "petal_length": 0.9332705499213636, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.06866179325140237, "sepal_width": -0.13197947932162468, "petal_length": 0.7627582691805538, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0, "cluster2": 0}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Notice how much more clear the clusters are here! This is looking a little more promising to me than the previous example.</p>
<ul class="simple">
<li><p>Using predictions from cluster2, make a list of altair charts that have the same encodings as before, but with the y-axis going through all columns of <code class="docutils literal notranslate"><span class="pre">numcols</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numcols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chart_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">numcols</span><span class="p">:</span>
    <span class="n">chart</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;sepal_length&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;cluster2:N&quot;</span><span class="p">,</span>
        <span class="n">shape</span><span class="o">=</span><span class="s2">&quot;cluster2:N&quot;</span>
    <span class="p">)</span>
    <span class="n">chart_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#list of altair charts</span>
<span class="n">chart_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[alt.Chart(...), alt.Chart(...), alt.Chart(...), alt.Chart(...)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#unpack the charts and stack them vertically</span>
<span class="n">alt</span><span class="o">.</span><span class="n">vconcat</span><span class="p">(</span><span class="o">*</span><span class="n">chart_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-aaf16f639ef34a6e98b6d7d5da5d3eae.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-aaf16f639ef34a6e98b6d7d5da5d3eae.vega-embed details,
  #altair-viz-aaf16f639ef34a6e98b6d7d5da5d3eae.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-aaf16f639ef34a6e98b6d7d5da5d3eae"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-aaf16f639ef34a6e98b6d7d5da5d3eae") {
      outputDiv = document.getElementById("altair-viz-aaf16f639ef34a6e98b6d7d5da5d3eae");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "point", "filled": true, "size": 100}, "encoding": {"color": {"field": "cluster2", "type": "nominal"}, "shape": {"field": "cluster2", "type": "nominal"}, "x": {"field": "sepal_length", "type": "quantitative"}, "y": {"field": "sepal_length", "type": "quantitative"}}}, {"mark": {"type": "point", "filled": true, "size": 100}, "encoding": {"color": {"field": "cluster2", "type": "nominal"}, "shape": {"field": "cluster2", "type": "nominal"}, "x": {"field": "sepal_length", "type": "quantitative"}, "y": {"field": "sepal_width", "type": "quantitative"}}}, {"mark": {"type": "point", "filled": true, "size": 100}, "encoding": {"color": {"field": "cluster2", "type": "nominal"}, "shape": {"field": "cluster2", "type": "nominal"}, "x": {"field": "sepal_length", "type": "quantitative"}, "y": {"field": "petal_length", "type": "quantitative"}}}, {"mark": {"type": "point", "filled": true, "size": 100}, "encoding": {"color": {"field": "cluster2", "type": "nominal"}, "shape": {"field": "cluster2", "type": "nominal"}, "x": {"field": "sepal_length", "type": "quantitative"}, "y": {"field": "petal_width", "type": "quantitative"}}}], "data": {"name": "data-ba6cbfa25cc10c9c6102be1de7f532af"}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-ba6cbfa25cc10c9c6102be1de7f532af": [{"sepal_length": -0.9006811702978088, "sepal_width": 1.019004351971607, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.1430169111851105, "sepal_width": -0.13197947932162468, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.3853526520724133, "sepal_width": 0.32841405319566835, "petal_length": -1.3970639535363654, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.5065205225160652, "sepal_width": 0.09821728693702184, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 1.2492011182302534, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.537177558966854, "sepal_width": 1.939791417006192, "petal_length": -1.1697142458819532, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -1.5065205225160652, "sepal_width": 0.7888075857129604, "petal_length": -1.3402265266227624, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 0.7888075857129604, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.7488562634033669, "sepal_width": -0.3621762455802712, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.1430169111851105, "sepal_width": 0.09821728693702184, "petal_length": -1.2833890997091593, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -0.537177558966854, "sepal_width": 1.4793978844889, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -1.2641847816287624, "sepal_width": 0.7888075857129604, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.2641847816287624, "sepal_width": -0.13197947932162468, "petal_length": -1.3402265266227624, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.870024133847019, "sepal_width": -0.13197947932162468, "petal_length": -1.5107388073635717, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -0.05250607719224957, "sepal_width": 2.1699881832648384, "petal_length": -1.4539013804499687, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -0.1736739476359004, "sepal_width": 3.090775248299425, "petal_length": -1.2833890997091593, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -0.537177558966854, "sepal_width": 1.939791417006192, "petal_length": -1.3970639535363654, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.019004351971607, "petal_length": -1.3402265266227624, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.1736739476359004, "sepal_width": 1.7095946507475455, "petal_length": -1.1697142458819532, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.7095946507475455, "petal_length": -1.2833890997091593, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -0.537177558966854, "sepal_width": 0.7888075857129604, "petal_length": -1.1697142458819532, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.4793978844889, "petal_length": -1.2833890997091593, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.5065205225160652, "sepal_width": 1.2492011182302534, "petal_length": -1.567576234277175, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 0.5586108194543139, "petal_length": -1.1697142458819532, "petal_width": -0.9205477421368377, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.2641847816287624, "sepal_width": 0.7888075857129604, "petal_length": -1.0560393920547466, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": -0.13197947932162468, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 0.7888075857129604, "petal_length": -1.226551672795556, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.7795132998541568, "sepal_width": 1.019004351971607, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.7795132998541568, "sepal_width": 0.7888075857129604, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.3853526520724133, "sepal_width": 0.32841405319566835, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.2641847816287624, "sepal_width": 0.09821728693702184, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -0.537177558966854, "sepal_width": 0.7888075857129604, "petal_length": -1.2833890997091593, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.7795132998541568, "sepal_width": 2.400184949523484, "petal_length": -1.2833890997091593, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -0.4160096885232032, "sepal_width": 2.6303817157821316, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -1.1430169111851105, "sepal_width": 0.09821728693702184, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 0.32841405319566835, "petal_length": -1.4539013804499687, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -0.4160096885232032, "sepal_width": 1.019004351971607, "petal_length": -1.3970639535363654, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.1430169111851105, "sepal_width": 1.2492011182302534, "petal_length": -1.3402265266227624, "petal_width": -1.4470764792980408, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.7488562634033669, "sepal_width": -0.13197947932162468, "petal_length": -1.3970639535363654, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 0.7888075857129604, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 1.019004351971607, "petal_length": -1.3970639535363654, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -1.6276883929597161, "sepal_width": -1.7433568431321493, "petal_length": -1.3970639535363654, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.7488562634033669, "sepal_width": 0.32841405319566835, "petal_length": -1.3970639535363654, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 1.019004351971607, "petal_length": -1.226551672795556, "petal_width": -0.7889155578465368, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.7095946507475455, "petal_length": -1.0560393920547466, "petal_width": -1.0521799264271385, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -1.2641847816287624, "sepal_width": -0.13197947932162468, "petal_length": -1.3402265266227624, "petal_width": -1.1838121107174393, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -0.9006811702978088, "sepal_width": 1.7095946507475455, "petal_length": -1.226551672795556, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -1.5065205225160652, "sepal_width": 0.32841405319566835, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 5, "cluster2": 1}, {"sepal_length": -0.658345429410506, "sepal_width": 1.4793978844889, "petal_length": -1.2833890997091593, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 7, "cluster2": 1}, {"sepal_length": -1.0218490407414595, "sepal_width": 0.5586108194543139, "petal_length": -1.3402265266227624, "petal_width": -1.3154442950077403, "species": "setosa", "cluster": 1, "cluster2": 1}, {"sepal_length": 1.401508368131566, "sepal_width": 0.32841405319566835, "petal_length": 0.5354085615261415, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": 0.32841405319566835, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.2803404976879151, "sepal_width": 0.09821728693702184, "petal_length": 0.6490834153533479, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.7433568431321493, "petal_length": 0.13754657313091936, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.7956690159133096, "sepal_width": -0.5923730118389178, "petal_length": 0.47857113461253803, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -0.5923730118389178, "petal_length": 0.4217337076989351, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": 0.5586108194543139, "petal_length": 0.5354085615261415, "petal_width": 0.5274062850564719, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": -1.1430169111851105, "sepal_width": -1.513160076873503, "petal_length": -0.26031541526430274, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.9168368863569605, "sepal_width": -0.3621762455802712, "petal_length": 0.47857113461253803, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.7795132998541568, "sepal_width": -0.8225697780975633, "petal_length": 0.08070914621731616, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -1.0218490407414595, "sepal_width": -2.433947141908088, "petal_length": -0.14664056143709636, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.06866179325140237, "sepal_width": -0.13197947932162468, "petal_length": 0.2512214269581257, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.18982966369505322, "sepal_width": -1.9735536093907948, "petal_length": 0.13754657313091936, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.3621762455802712, "petal_length": 0.5354085615261415, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.3621762455802712, "petal_length": -0.08980313452349317, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.09821728693702184, "petal_length": 0.36489628078533215, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.13197947932162468, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.8225697780975633, "petal_length": 0.1943840000445223, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.432165404582356, "sepal_width": -1.9735536093907948, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.29484181807955234, "sepal_width": -1.2829633106148564, "petal_length": 0.08070914621731616, "petal_width": -0.1307546363950324, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.06866179325140237, "sepal_width": 0.32841405319566835, "petal_length": 0.5922459884397444, "petal_width": 0.7906706536370736, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.5923730118389178, "petal_length": 0.13754657313091936, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": -1.2829633106148564, "petal_length": 0.6490834153533479, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.5923730118389178, "petal_length": 0.5354085615261415, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": -0.3621762455802712, "petal_length": 0.30805885387172866, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.9168368863569605, "sepal_width": -0.13197947932162468, "petal_length": 0.36489628078533215, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.1591726272442633, "sepal_width": -0.5923730118389178, "petal_length": 0.5922459884397444, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": -0.13197947932162468, "petal_length": 0.7059208422669508, "petal_width": 0.6590384693467726, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.18982966369505322, "sepal_width": -0.3621762455802712, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -1.0527665443562098, "petal_length": -0.14664056143709636, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.513160076873503, "petal_length": 0.023871719303712964, "petal_width": -0.1307546363950324, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.513160076873503, "petal_length": -0.032965707609889976, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.8225697780975633, "petal_length": 0.08070914621731616, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.18982966369505322, "sepal_width": -0.8225697780975633, "petal_length": 0.7627582691805538, "petal_width": 0.5274062850564719, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.537177558966854, "sepal_width": -0.13197947932162468, "petal_length": 0.4217337076989351, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.18982966369505322, "sepal_width": 0.7888075857129604, "petal_length": 0.4217337076989351, "petal_width": 0.5274062850564719, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.09821728693702184, "petal_length": 0.5354085615261415, "petal_width": 0.3957741007661709, "species": "versicolor", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": -1.7433568431321493, "petal_length": 0.36489628078533215, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.13197947932162468, "petal_length": 0.1943840000445223, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.2829633106148564, "petal_length": 0.13754657313091936, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.4160096885232032, "sepal_width": -1.0527665443562098, "petal_length": 0.36489628078533215, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.13197947932162468, "petal_length": 0.47857113461253803, "petal_width": 0.26414191647586993, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -1.0527665443562098, "petal_length": 0.13754657313091936, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -1.0218490407414595, "sepal_width": -1.7433568431321493, "petal_length": -0.26031541526430274, "petal_width": -0.26238682068533337, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.8225697780975633, "petal_length": 0.2512214269581257, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -0.13197947932162468, "petal_length": 0.2512214269581257, "petal_width": 0.0008775478952682834, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -0.3621762455802712, "petal_length": 0.2512214269581257, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.432165404582356, "sepal_width": -0.3621762455802712, "petal_length": 0.30805885387172866, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.9006811702978088, "sepal_width": -1.2829633106148564, "petal_length": -0.4308276960051121, "petal_width": -0.1307546363950324, "species": "versicolor", "cluster": 2, "cluster2": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -0.5923730118389178, "petal_length": 0.1943840000445223, "petal_width": 0.13250973218556925, "species": "versicolor", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": 0.5586108194543139, "petal_length": 1.2742951114029821, "petal_width": 1.7120959436691794, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.8225697780975633, "petal_length": 0.7627582691805538, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.522676238575217, "sepal_width": -0.13197947932162468, "petal_length": 1.2174576844893792, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": -0.3621762455802712, "petal_length": 1.0469454037485695, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.7956690159133096, "sepal_width": -0.13197947932162468, "petal_length": 1.1606202575757758, "petal_width": 1.317199390798277, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 2.1285155907934734, "sepal_width": -0.13197947932162468, "petal_length": 1.6153196728846009, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": -1.1430169111851105, "sepal_width": -1.2829633106148564, "petal_length": 0.4217337076989351, "petal_width": 0.6590384693467726, "species": "virginica", "cluster": 2, "cluster2": 0}, {"sepal_length": 1.7650119794625196, "sepal_width": -0.3621762455802712, "petal_length": 1.4448073921437916, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": -1.2829633106148564, "petal_length": 1.1606202575757758, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.643844109018869, "sepal_width": 1.2492011182302534, "petal_length": 1.331132538316585, "petal_width": 1.7120959436691794, "species": "virginica", "cluster": 3, "cluster2": 0}, {"sepal_length": 0.7956690159133096, "sepal_width": 0.32841405319566835, "petal_length": 0.7627582691805538, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": -0.8225697780975633, "petal_length": 0.8764331230077601, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.1591726272442633, "sepal_width": -0.13197947932162468, "petal_length": 0.9901079768349665, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": -0.1736739476359004, "sepal_width": -1.2829633106148564, "petal_length": 0.7059208422669508, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.5923730118389178, "petal_length": 0.7627582691805538, "petal_width": 1.5804637593788784, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": 0.32841405319566835, "petal_length": 0.8764331230077601, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.7956690159133096, "sepal_width": -0.13197947932162468, "petal_length": 0.9901079768349665, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 2.2496834612371255, "sepal_width": 1.7095946507475455, "petal_length": 1.6721570997982043, "petal_width": 1.317199390798277, "species": "virginica", "cluster": 3, "cluster2": 0}, {"sepal_length": 2.2496834612371255, "sepal_width": -1.0527665443562098, "petal_length": 1.7858319536254108, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 0.18982966369505322, "sepal_width": -1.9735536093907948, "petal_length": 0.7059208422669508, "petal_width": 0.3957741007661709, "species": "virginica", "cluster": 2, "cluster2": 0}, {"sepal_length": 1.2803404976879151, "sepal_width": 0.32841405319566835, "petal_length": 1.1037828306621729, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": -0.29484181807955234, "sepal_width": -0.5923730118389178, "petal_length": 0.6490834153533479, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 2.2496834612371255, "sepal_width": -0.5923730118389178, "petal_length": 1.6721570997982043, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": -0.8225697780975633, "petal_length": 0.6490834153533479, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.5586108194543139, "petal_length": 1.1037828306621729, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.643844109018869, "sepal_width": 0.32841405319566835, "petal_length": 1.2742951114029821, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 0.432165404582356, "sepal_width": -0.5923730118389178, "petal_length": 0.5922459884397444, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -0.13197947932162468, "petal_length": 0.6490834153533479, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": -0.5923730118389178, "petal_length": 1.0469454037485695, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.643844109018869, "sepal_width": -0.13197947932162468, "petal_length": 1.1606202575757758, "petal_width": 0.5274062850564719, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 1.8861798499061717, "sepal_width": -0.5923730118389178, "petal_length": 1.331132538316585, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 2.4920192021244283, "sepal_width": 1.7095946507475455, "petal_length": 1.501644819057395, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 3, "cluster2": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": -0.5923730118389178, "petal_length": 1.0469454037485695, "petal_width": 1.317199390798277, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": -0.5923730118389178, "petal_length": 0.7627582691805538, "petal_width": 0.3957741007661709, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.31099753413870407, "sepal_width": -1.0527665443562098, "petal_length": 1.0469454037485695, "petal_width": 0.26414191647586993, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 2.2496834612371255, "sepal_width": -0.13197947932162468, "petal_length": 1.331132538316585, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 4, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": 0.7888075857129604, "petal_length": 1.0469454037485695, "petal_width": 1.5804637593788784, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.6745011454696588, "sepal_width": 0.09821728693702184, "petal_length": 0.9901079768349665, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.18982966369505322, "sepal_width": -0.13197947932162468, "petal_length": 0.5922459884397444, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.2803404976879151, "sepal_width": 0.09821728693702184, "petal_length": 0.9332705499213636, "petal_width": 1.185567206507976, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.09821728693702184, "petal_length": 1.0469454037485695, "petal_width": 1.5804637593788784, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.2803404976879151, "sepal_width": 0.09821728693702184, "petal_length": 0.7627582691805538, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": -0.05250607719224957, "sepal_width": -0.8225697780975633, "petal_length": 0.7627582691805538, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 1.1591726272442633, "sepal_width": 0.32841405319566835, "petal_length": 1.2174576844893792, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": 0.5586108194543139, "petal_length": 1.1037828306621729, "petal_width": 1.7120959436691794, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 1.0380047568006125, "sepal_width": -0.13197947932162468, "petal_length": 0.8195956960941572, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.5533332750260068, "sepal_width": -1.2829633106148564, "petal_length": 0.7059208422669508, "petal_width": 0.9223028379273742, "species": "virginica", "cluster": 0, "cluster2": 0}, {"sepal_length": 0.7956690159133096, "sepal_width": -0.13197947932162468, "petal_length": 0.8195956960941572, "petal_width": 1.053935022217675, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.432165404582356, "sepal_width": 0.7888075857129604, "petal_length": 0.9332705499213636, "petal_width": 1.4488315750885774, "species": "virginica", "cluster": 6, "cluster2": 0}, {"sepal_length": 0.06866179325140237, "sepal_width": -0.13197947932162468, "petal_length": 0.7627582691805538, "petal_width": 0.7906706536370736, "species": "virginica", "cluster": 0, "cluster2": 0}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
</section>
</section>
<section id="importance-of-scaling">
<h2>Importance of Scaling<a class="headerlink" href="#importance-of-scaling" title="Permalink to this headline">#</a></h2>
<section id="exercise">
<h3>Exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Make a DataFrame <code class="docutils literal notranslate"><span class="pre">df</span></code> with two columns, “miles” and “cars”, containing the following five data points in (miles, cars): (0,1), (0,5), (1,0), (1,1), (1,5).</p></li>
<li><p>For later use, make a copy of df called <code class="docutils literal notranslate"><span class="pre">df2</span></code>. Be sure to use .copy().</p></li>
<li><p>Using K-Means clustering, divide this <code class="docutils literal notranslate"><span class="pre">df</span></code> data into two clusters. Store the data in a new column called “cluster”.</p></li>
<li><p>Does the result match what you expect?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;miles&quot;</span><span class="p">,</span><span class="s2">&quot;cars&quot;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>miles</th>
      <th>cars</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># here&#39;s another way</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;miles&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s2">&quot;cars&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">]})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>miles</th>
      <th>cars</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Think about how you expect the points to be clustered together. Then compare with what we get below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/yasmeen/opt/miniconda3/envs/math9/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py:1412: FutureWarning: The default value of `n_init` will change from 10 to &#39;auto&#39; in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-4 {color: black;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KMeans(n_clusters=2)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" checked><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">KMeans</label><div class="sk-toggleable__content"><pre>KMeans(n_clusters=2)</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;clusters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>miles</th>
      <th>cars</th>
      <th>clusters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>5</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Some observations: Two data points with 5 cars are in one cluster, while the remaining data points with 0 or 1 cars are in another cluster.
<strong>Note:</strong> The names of the clusters are not important.</p>
<ul class="simple">
<li><p>Rename the miles column of <code class="docutils literal notranslate"><span class="pre">df2</span></code> to “feet”, and convert the values from miles to feet.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;miles&quot;</span><span class="p">:</span><span class="s2">&quot;feet&quot;</span><span class="p">},</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feet</th>
      <th>cars</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#There are 5280 feet in a mile</span>
<span class="n">df2</span><span class="o">.</span><span class="n">feet</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">miles</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">feet</span> <span class="o">=</span> <span class="mi">5280</span><span class="o">*</span><span class="n">df2</span><span class="o">.</span><span class="n">feet</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feet</th>
      <th>cars</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5280</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5280</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5280</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice, <code class="docutils literal notranslate"><span class="pre">df2</span></code> contains the exact same information as <code class="docutils literal notranslate"><span class="pre">df</span></code>, but now the “feet” column is overpowering the “cars” column. This is bad because we only changed the unit of measurement used.</p>
<ul class="simple">
<li><p>Using K-Means clustering, divide the <code class="docutils literal notranslate"><span class="pre">df2</span></code> data into two clusters. Store the data in a new column called “cluster”.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans2</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/yasmeen/opt/miniconda3/envs/math9/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py:1412: FutureWarning: The default value of `n_init` will change from 10 to &#39;auto&#39; in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-5 {color: black;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KMeans(n_clusters=2)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" checked><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">KMeans</label><div class="sk-toggleable__content"><pre>KMeans(n_clusters=2)</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;clusters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feet</th>
      <th>cars</th>
      <th>clusters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5280</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5280</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5280</td>
      <td>5</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice now that the clusters are different compared to when we first tried with just <code class="docutils literal notranslate"><span class="pre">df</span></code>. Here, because feet is so much larger than cars, it is influencing the model.</p>
<p>Exercise: Apply StandardScaler to <code class="docutils literal notranslate"><span class="pre">df2</span></code> and then try clustering again. See what happens!</p>
<p><strong>Upshot:</strong>
Unless the same unit of measurement is used over the columns, we should normalize (e.g. with StandardScaler).</p>
</section>
</section>
<section id="the-k-means-algorithm">
<h2>The K-Means Algorithm<a class="headerlink" href="#the-k-means-algorithm" title="Permalink to this headline">#</a></h2>
<p>Reference: <a class="reference external" href="https://en.wikipedia.org/wiki/K-means_clustering">Wikipedia page</a> on K-Means clustering. (See the standard algorithm section.)</p>
<p>This portion of the lecture I plan to sketch out on the iPad.</p>
<p><img alt="" src="../_images/Teaching-55.jpg" /></p>
<p><img alt="" src="../_images/Teaching-56.jpg" /></p>
<p><img alt="" src="../_images/Teaching-57.jpg" /></p>
<p><img alt="" src="../_images/Teaching-58.jpg" /></p>
<p><img alt="" src="../_images/Teaching-59.jpg" /></p>
<section id="iterating-by-hand">
<h3>Iterating by hand<a class="headerlink" href="#iterating-by-hand" title="Permalink to this headline">#</a></h3>
<p><strong>Question 1:</strong> Using the following dataset, run the KMeans algorithm by hand, starting with the initial points (3,0) and (1,0). (How many clusters do you expect with this setup?)</p>
<p>Two initial points means we expect 2 clusters.</p>
<p>Warning: Notice the scaling on the x- and y-axes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="s2">&quot;y&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]})</span>
<span class="n">datapoints</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
<span class="p">)</span>
<span class="n">datapoints</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-56c10c54a75943859590372b578c7b08.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-56c10c54a75943859590372b578c7b08.vega-embed details,
  #altair-viz-56c10c54a75943859590372b578c7b08.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-56c10c54a75943859590372b578c7b08"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-56c10c54a75943859590372b578c7b08") {
      outputDiv = document.getElementById("altair-viz-56c10c54a75943859590372b578c7b08");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-94131af95bdb0397aa4e973f5f50880e"}, "mark": {"type": "point", "color": "black", "filled": true, "size": 100}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-94131af95bdb0397aa4e973f5f50880e": [{"x": 0, "y": 0}, {"x": 0, "y": 10}, {"x": 1, "y": 0}, {"x": 1, "y": 10}, {"x": 3, "y": 0}, {"x": 4, "y": 0}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p><strong>First Iteration:</strong>
Cluster 1: Points closest to (3,0)
(3,0),(4,0)
Cluster 2: Points closest to (1,0)
(1,0),(0,0), (1,10), (0,10)</p>
<p>It’s not too hard to see that (4,0) is closer to (3,0). Similarly, (0,0) is closer to (1,0)</p>
<p>Distance between (1,0) and (1,10): 10
Distance between (3,0) and (1,10): <span class="math notranslate nohighlight">\(\sqrt{2^2 + (-10)^2} = \sqrt{4 + 100} = \sqrt{104} &gt; 10\)</span></p>
<p>Let’s now compute the centroids of each cluster.
Cluster 1: <span class="math notranslate nohighlight">\(\frac{1}{2}(3+4,0) = (3.5,0)\)</span>
Cluster 2: <span class="math notranslate nohighlight">\(\frac{1}{4}(1+0+1+0,0+0+10+10) = (0.5,5)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">round1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:[</span><span class="mf">3.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span><span class="s2">&quot;y&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]})</span>
<span class="n">average1</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">round1</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datapoints</span> <span class="o">+</span> <span class="n">average1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-2b41b54c5ba7491ea670fc3d4c561892.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-2b41b54c5ba7491ea670fc3d4c561892.vega-embed details,
  #altair-viz-2b41b54c5ba7491ea670fc3d4c561892.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-2b41b54c5ba7491ea670fc3d4c561892"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-2b41b54c5ba7491ea670fc3d4c561892") {
      outputDiv = document.getElementById("altair-viz-2b41b54c5ba7491ea670fc3d4c561892");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"data": {"name": "data-94131af95bdb0397aa4e973f5f50880e"}, "mark": {"type": "point", "color": "black", "filled": true, "size": 100}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"data": {"name": "data-1aad7ad9f5ded75a32aa52cba1158594"}, "mark": {"type": "point", "color": "green", "filled": true, "size": 100}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}], "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-94131af95bdb0397aa4e973f5f50880e": [{"x": 0, "y": 0}, {"x": 0, "y": 10}, {"x": 1, "y": 0}, {"x": 1, "y": 10}, {"x": 3, "y": 0}, {"x": 4, "y": 0}], "data-1aad7ad9f5ded75a32aa52cba1158594": [{"x": 3.5, "y": 0}, {"x": 0.5, "y": 5}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p><strong>Second Iteration:</strong>
Cluster 1: Points closest to (3.5,0): (3,0),(4,0),(1,0),(0,0)
Cluster 2: Points closest to (0.5,5): (0,10) and (1,10)</p>
<p>Compute centroids again: (2,0) and (0.5,10)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">round2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span><span class="s2">&quot;y&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]})</span>
<span class="n">average2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">round2</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span>
<span class="p">)</span>
<span class="n">datapoints</span> <span class="o">+</span> <span class="n">average1</span> <span class="o">+</span> <span class="n">average2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-b2e4c68befe9462e8f400f88fd0a3766.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-b2e4c68befe9462e8f400f88fd0a3766.vega-embed details,
  #altair-viz-b2e4c68befe9462e8f400f88fd0a3766.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b2e4c68befe9462e8f400f88fd0a3766"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b2e4c68befe9462e8f400f88fd0a3766") {
      outputDiv = document.getElementById("altair-viz-b2e4c68befe9462e8f400f88fd0a3766");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"data": {"name": "data-94131af95bdb0397aa4e973f5f50880e"}, "mark": {"type": "point", "color": "black", "filled": true, "size": 100}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"data": {"name": "data-1aad7ad9f5ded75a32aa52cba1158594"}, "mark": {"type": "point", "color": "green", "filled": true, "size": 100}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"data": {"name": "data-e4b0eaf21d8d4f91587f1137d6a66d99"}, "mark": {"type": "point", "color": "orange", "filled": true, "size": 100}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}], "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-94131af95bdb0397aa4e973f5f50880e": [{"x": 0, "y": 0}, {"x": 0, "y": 10}, {"x": 1, "y": 0}, {"x": 1, "y": 10}, {"x": 3, "y": 0}, {"x": 4, "y": 0}], "data-1aad7ad9f5ded75a32aa52cba1158594": [{"x": 3.5, "y": 0}, {"x": 0.5, "y": 5}], "data-e4b0eaf21d8d4f91587f1137d6a66d99": [{"x": 2.0, "y": 0}, {"x": 0.5, "y": 10}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Notice that this is where we terminate the algorithm because if we try to reassign points to the nearest centroid, they all stay in the same cluster.</p>
<p>Let’s check how we did.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;clusters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/yasmeen/opt/miniconda3/envs/math9/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py:1412: FutureWarning: The default value of `n_init` will change from 10 to &#39;auto&#39; in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datapoints</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;clusters:N&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-ded8e461a58e469ca8862b8293f0d942.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-ded8e461a58e469ca8862b8293f0d942.vega-embed details,
  #altair-viz-ded8e461a58e469ca8862b8293f0d942.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-ded8e461a58e469ca8862b8293f0d942"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-ded8e461a58e469ca8862b8293f0d942") {
      outputDiv = document.getElementById("altair-viz-ded8e461a58e469ca8862b8293f0d942");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-f48b27bf14e1af8ff33cbcbb45395c8d"}, "mark": {"type": "point", "color": "black", "filled": true, "size": 100}, "encoding": {"color": {"field": "clusters", "type": "nominal"}, "x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-f48b27bf14e1af8ff33cbcbb45395c8d": [{"x": 0, "y": 0, "clusters": 1}, {"x": 0, "y": 10, "clusters": 0}, {"x": 1, "y": 0, "clusters": 1}, {"x": 1, "y": 10, "clusters": 0}, {"x": 3, "y": 0, "clusters": 1}, {"x": 4, "y": 0, "clusters": 1}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<a style='text-decoration:none;line-height:16px;display:flex;color:#5B5B62;padding:10px;justify-content:end;' href='https://deepnote.com?utm_source=created-in-deepnote-cell&projectId=dbbc33c4-6750-4da5-b17f-5d0c69c22728' target="_blank">
<img alt='Created in deepnote.com' style='display:inline;max-height:16px;margin:0px;margin-right:7.5px;' src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgODAgODAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkxhbmRpbmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyMzUuMDAwMDAwLCAtNzkuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjM1LjAwMDAwMCwgNzkuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0yMCIgZmlsbD0iIzAyNjVCNCIgcG9pbnRzPSIyLjM3NjIzNzYyIDgwIDM4LjA0NzY2NjcgODAgNTcuODIxNzgyMiA3My44MDU3NTkyIDU3LjgyMTc4MjIgMzIuNzU5MjczOSAzOS4xNDAyMjc4IDMxLjY4MzE2ODMiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNS4wMDc3MTgsODAgQzQyLjkwNjIwMDcsNzYuNDU0OTM1OCA0Ny41NjQ5MTY3LDcxLjU0MjI2NzEgNDguOTgzODY2LDY1LjI2MTk5MzkgQzUxLjExMjI4OTksNTUuODQxNTg0MiA0MS42NzcxNzk1LDQ5LjIxMjIyODQgMjUuNjIzOTg0Niw0OS4yMTIyMjg0IEMyNS40ODQ5Mjg5LDQ5LjEyNjg0NDggMjkuODI2MTI5Niw0My4yODM4MjQ4IDM4LjY0NzU4NjksMzEuNjgzMTY4MyBMNzIuODcxMjg3MSwzMi41NTQ0MjUgTDY1LjI4MDk3Myw2Ny42NzYzNDIxIEw1MS4xMTIyODk5LDc3LjM3NjE0NCBMMzUuMDA3NzE4LDgwIFoiIGlkPSJQYXRoLTIyIiBmaWxsPSIjMDAyODY4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMCwzNy43MzA0NDA1IEwyNy4xMTQ1MzcsMC4yNTcxMTE0MzYgQzYyLjM3MTUxMjMsLTEuOTkwNzE3MDEgODAsMTAuNTAwMzkyNyA4MCwzNy43MzA0NDA1IEM4MCw2NC45NjA0ODgyIDY0Ljc3NjUwMzgsNzkuMDUwMzQxNCAzNC4zMjk1MTEzLDgwIEM0Ny4wNTUzNDg5LDc3LjU2NzA4MDggNTMuNDE4MjY3Nyw3MC4zMTM2MTAzIDUzLjQxODI2NzcsNTguMjM5NTg4NSBDNTMuNDE4MjY3Nyw0MC4xMjg1NTU3IDM2LjMwMzk1NDQsMzcuNzMwNDQwNSAyNS4yMjc0MTcsMzcuNzMwNDQwNSBDMTcuODQzMDU4NiwzNy43MzA0NDA1IDkuNDMzOTE5NjYsMzcuNzMwNDQwNSAwLDM3LjczMDQ0MDUgWiIgaWQ9IlBhdGgtMTkiIGZpbGw9IiMzNzkzRUYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+' > </img>
Created in <span style='font-weight:600;margin-left:4px;'>Deepnote</span></a></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="lec14.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lecture 14: September 8th, 2023</p>
      </div>
    </a>
    <a class="right-next"
       href="../final/final.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">🎉 Final Project Instructions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-project-questions">Final Project Questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-clustering">K-Means Clustering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standardscaler">StandardScaler</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importance-of-scaling">Importance of Scaling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-k-means-algorithm">The K-Means Algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iterating-by-hand">Iterating by hand</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Christopher Davis and Yasmeen Baki
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>