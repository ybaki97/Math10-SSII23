

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Lecture 4: August 14th, 2023 &#8212; Math 10, Summer Session II 2023</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/lec4';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lecture 5: August 16th, 2023" href="lec5.html" />
    <link rel="prev" title="Week 2 Lecture Videos" href="../w2vid.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/confuse.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/confuse.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    UC Irvine, Math 10, Summer 2023
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w1vid.html">Week 1 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec1.html">Lecture 1: August 7th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../worksheets/wkst1.html">Discussion 1: August 7th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec2.html">Lecture 2: August 9th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../worksheets/wkst2.html">Discussion 2: August 9th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec3.html">Lecture 3: August 11th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w2vid.html">Week 2 Lecture Videos</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lecture 4: August 14th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec5.html">Lecture 5: August 16th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec6.html">Lecture 6: August 18th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w3vid.html">Week 3 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec7.html">Lecture 7: August 21st, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec8.html">Lecture 8: August 23nd, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec9.html">Lecture 9: August 25th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lec10.html">Lecture 10: August 28th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec11.html">Lecture 11: August 30th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec12.html">Lecture 12: September 1st, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w5vid.html">Week 5 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec13.html">Lecture 13: September 6th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec14.html">Lecture 14: September 8th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Final Project and Finals Week</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lec15.html">Lecture 15: September 11th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final/final.html">üéâ Final Project Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final/extra.html">Possible Extra Topics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Projects</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../students/proj.html">Student Projects</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../students/brianbui/BrianBui.html">League of Legends 13.13</a></li>
<li class="toctree-l2"><a class="reference internal" href="../students/titusdejong/TitusdeJong.html">Detecting events in Timestamp data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../students/yufeng/YuFeng.html">Predict Diabetes Based on Various Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../students/harrisonhong/HarrisonHong.html">Mushroom Edibility Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../students/shayankermani/ShayanKermani.html">Online Chess Games Examination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../students/laurenkim/LaurenKim.html">Predicting Formula 1 Constructor‚Äôs Champion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../students/jameslai/JamesLai.html">COVID-19 Data Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../students/BaoyeLiu.html">Heart Disease Graph</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ybaki97/Math10-SSI23" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ybaki97/Math10-SSI23/issues/new?title=Issue%20on%20page%20%2Flectures/lec4.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lectures/lec4.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lecture 4: August 14th, 2023</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-dates-in-pandas">Working with dates in pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-recap-of-last-lecture">Quick recap of last lecture</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#new-material">New material</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-strings-in-pandas">Working with strings in pandas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-missing-values-in-pandas">Working with missing values in pandas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-on-missing-values">More on missing values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-integer-locations-of-columns">Getting integer locations of columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shuffling-and-sampling-data">Shuffling and sampling data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strings-in-pandas-revisited-worse-approach-1-iloc-and-for-loops">Strings in pandas revisited: Worse approach 1 (<code class="docutils literal notranslate"><span class="pre">iloc</span></code> and for-loops)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strings-in-pandas-revisited-worse-approach-2-loc-and-for-loops">Strings in pandas revisited: Worse approach 2 (loc and for-loops)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strings-in-pandas-revisited-worse-approach-3-helper-function-and-map">Strings in pandas revisited: Worse approach 3 (helper function and <code class="docutils literal notranslate"><span class="pre">map</span></code>)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lecture-4-august-14th-2023">
<h1>Lecture 4: August 14th, 2023<a class="headerlink" href="#lecture-4-august-14th-2023" title="Permalink to this headline">#</a></h1>
<p><strong>Announcements:</strong></p>
<ul class="simple">
<li><p>Student hours with Yasmeen have been set! They are <strong>Tuesdays from 12:00pm-1:30pm</strong>. The Zoom information is the same as lecture. All information is posted on the front page of Canvas.</p></li>
<li><p>Outcome quizzes are slowly being released over the course of today. The first round has a deadline set of next Monday at midnight, but remember that this is just the first try (really two tries, I‚Äôm giving two attempts for each outcome this week). There will be many more opportunities coming up.</p></li>
<li><p>Outcome quizzes are autograded on Canvas, but the work you do to solve the problems should be done in the Deepnote template provided.</p></li>
<li><p>‚ÄúHow I earned an A‚Äù token-earning assignment due at midnight tonight. Remember, this is an optional assignment. Another opportunity to earn tokens will be released for this week.</p></li>
<li><p>Homework 1 and Homework 2 are due Wednesday at midnight. Submit a token request form if you need an extension.</p></li>
</ul>
<p><strong>Question about Homework 2</strong>: There are two date-like columns. Which one should I use?</p>
<p><strong>Answer:</strong> Either is fine! Depending on which one you use, the values you get might be off-by-one from what the homework says the answer should be.</p>
<section id="working-with-dates-in-pandas">
<h2>Working with dates in pandas<a class="headerlink" href="#working-with-dates-in-pandas" title="Permalink to this headline">#</a></h2>
<p>The content of this portion of the lecture corresponds to SLO P6.</p>
<section id="quick-recap-of-last-lecture">
<h3>Quick recap of last lecture<a class="headerlink" href="#quick-recap-of-last-lecture" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;taxis.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>1</td>
      <td>1.60</td>
      <td>7.0</td>
      <td>2.15</td>
      <td>0.0</td>
      <td>12.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Lenox Hill West</td>
      <td>UN/Turtle Bay South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>1</td>
      <td>0.79</td>
      <td>5.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>9.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>Upper West Side South</td>
      <td>Upper West Side South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>1</td>
      <td>1.37</td>
      <td>7.5</td>
      <td>2.36</td>
      <td>0.0</td>
      <td>14.16</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Alphabet City</td>
      <td>West Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>1</td>
      <td>7.70</td>
      <td>27.0</td>
      <td>6.15</td>
      <td>0.0</td>
      <td>36.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Hudson Sq</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>3</td>
      <td>2.16</td>
      <td>9.0</td>
      <td>1.10</td>
      <td>0.0</td>
      <td>13.40</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Midtown East</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Convert the pickup and dropoff columns to datetime values using the pandas function <code class="docutils literal notranslate"><span class="pre">to_datetime</span></code>. Save the results as a new column in df named ‚Äúpicktime‚Äù and ‚Äúdroptime‚Äù.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#How we can create new columns</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;picktime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;droptime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;dropoff&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Notice that our new columns are all the way at the end!</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>picktime</th>
      <th>droptime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>1</td>
      <td>1.60</td>
      <td>7.0</td>
      <td>2.15</td>
      <td>0.0</td>
      <td>12.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Lenox Hill West</td>
      <td>UN/Turtle Bay South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>1</td>
      <td>0.79</td>
      <td>5.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>9.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>Upper West Side South</td>
      <td>Upper West Side South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>1</td>
      <td>1.37</td>
      <td>7.5</td>
      <td>2.36</td>
      <td>0.0</td>
      <td>14.16</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Alphabet City</td>
      <td>West Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>1</td>
      <td>7.70</td>
      <td>27.0</td>
      <td>6.15</td>
      <td>0.0</td>
      <td>36.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Hudson Sq</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>3</td>
      <td>2.16</td>
      <td>9.0</td>
      <td>1.10</td>
      <td>0.0</td>
      <td>13.40</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Midtown East</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6428</th>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>1</td>
      <td>0.75</td>
      <td>4.5</td>
      <td>1.06</td>
      <td>0.0</td>
      <td>6.36</td>
      <td>green</td>
      <td>credit card</td>
      <td>East Harlem North</td>
      <td>Central Harlem North</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
    </tr>
    <tr>
      <th>6429</th>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>1</td>
      <td>18.74</td>
      <td>58.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>58.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>Jamaica</td>
      <td>East Concourse/Concourse Village</td>
      <td>Queens</td>
      <td>Bronx</td>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
    </tr>
    <tr>
      <th>6430</th>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>1</td>
      <td>4.14</td>
      <td>16.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>17.30</td>
      <td>green</td>
      <td>cash</td>
      <td>Crown Heights North</td>
      <td>Bushwick North</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
    </tr>
    <tr>
      <th>6431</th>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>1</td>
      <td>1.12</td>
      <td>6.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>6.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>East New York</td>
      <td>East Flatbush/Remsen Village</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
    </tr>
    <tr>
      <th>6432</th>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>1</td>
      <td>3.85</td>
      <td>15.0</td>
      <td>3.36</td>
      <td>0.0</td>
      <td>20.16</td>
      <td>green</td>
      <td>credit card</td>
      <td>Boerum Hill</td>
      <td>Windsor Terrace</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
    </tr>
  </tbody>
</table>
<p>6433 rows √ó 16 columns</p>
</div></div></div>
</div>
<p>What‚Äôs the point of converting to datetime? These objects give us access to attributes and methods that we couldn‚Äôt use on strings.</p>
</section>
<section id="new-material">
<h3>New material<a class="headerlink" href="#new-material" title="Permalink to this headline">#</a></h3>
<p>Here‚Äôs how we can get all the methods and attributes of datetime objects available to us:</p>
<p>The letters <code class="docutils literal notranslate"><span class="pre">dt</span></code> tell pandas that we want to access datetime. This is called an accessor, and without it, we won‚Äôt have access to these methods and attributes.</p>
<p>It can be a little confusing to tell which are attributes and which are methods‚Ä¶the best thing to do is just look up what you need (or try both ways)‚Ä¶</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">dir</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;picktime&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;__annotations__&#39;,
 &#39;__class__&#39;,
 &#39;__delattr__&#39;,
 &#39;__dict__&#39;,
 &#39;__dir__&#39;,
 &#39;__doc__&#39;,
 &#39;__eq__&#39;,
 &#39;__format__&#39;,
 &#39;__frozen&#39;,
 &#39;__ge__&#39;,
 &#39;__getattribute__&#39;,
 &#39;__gt__&#39;,
 &#39;__hash__&#39;,
 &#39;__init__&#39;,
 &#39;__init_subclass__&#39;,
 &#39;__le__&#39;,
 &#39;__lt__&#39;,
 &#39;__module__&#39;,
 &#39;__ne__&#39;,
 &#39;__new__&#39;,
 &#39;__reduce__&#39;,
 &#39;__reduce_ex__&#39;,
 &#39;__repr__&#39;,
 &#39;__setattr__&#39;,
 &#39;__sizeof__&#39;,
 &#39;__str__&#39;,
 &#39;__subclasshook__&#39;,
 &#39;__weakref__&#39;,
 &#39;_accessors&#39;,
 &#39;_add_delegate_accessors&#39;,
 &#39;_constructor&#39;,
 &#39;_delegate_method&#39;,
 &#39;_delegate_property_get&#39;,
 &#39;_delegate_property_set&#39;,
 &#39;_dir_additions&#39;,
 &#39;_dir_deletions&#39;,
 &#39;_freeze&#39;,
 &#39;_get_values&#39;,
 &#39;_hidden_attrs&#39;,
 &#39;_parent&#39;,
 &#39;_reset_cache&#39;,
 &#39;ceil&#39;,
 &#39;date&#39;,
 &#39;day&#39;,
 &#39;day_name&#39;,
 &#39;day_of_week&#39;,
 &#39;day_of_year&#39;,
 &#39;dayofweek&#39;,
 &#39;dayofyear&#39;,
 &#39;days_in_month&#39;,
 &#39;daysinmonth&#39;,
 &#39;floor&#39;,
 &#39;freq&#39;,
 &#39;hour&#39;,
 &#39;is_leap_year&#39;,
 &#39;is_month_end&#39;,
 &#39;is_month_start&#39;,
 &#39;is_quarter_end&#39;,
 &#39;is_quarter_start&#39;,
 &#39;is_year_end&#39;,
 &#39;is_year_start&#39;,
 &#39;isocalendar&#39;,
 &#39;microsecond&#39;,
 &#39;minute&#39;,
 &#39;month&#39;,
 &#39;month_name&#39;,
 &#39;nanosecond&#39;,
 &#39;normalize&#39;,
 &#39;quarter&#39;,
 &#39;round&#39;,
 &#39;second&#39;,
 &#39;strftime&#39;,
 &#39;time&#39;,
 &#39;timetz&#39;,
 &#39;to_period&#39;,
 &#39;to_pydatetime&#39;,
 &#39;tz&#39;,
 &#39;tz_convert&#39;,
 &#39;tz_localize&#39;,
 &#39;week&#39;,
 &#39;weekday&#39;,
 &#39;weekofyear&#39;,
 &#39;year&#39;]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Make a new column ‚Äúday‚Äù containing the day of the week of the pickup. Use the <code class="docutils literal notranslate"><span class="pre">dt</span></code> accessor and then the method <code class="docutils literal notranslate"><span class="pre">day_name</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;day&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;picktime&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>picktime</th>
      <th>droptime</th>
      <th>day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>1</td>
      <td>1.60</td>
      <td>7.0</td>
      <td>2.15</td>
      <td>0.0</td>
      <td>12.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Lenox Hill West</td>
      <td>UN/Turtle Bay South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>Saturday</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>1</td>
      <td>0.79</td>
      <td>5.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>9.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>Upper West Side South</td>
      <td>Upper West Side South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>Monday</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>1</td>
      <td>1.37</td>
      <td>7.5</td>
      <td>2.36</td>
      <td>0.0</td>
      <td>14.16</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Alphabet City</td>
      <td>West Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>Wednesday</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>1</td>
      <td>7.70</td>
      <td>27.0</td>
      <td>6.15</td>
      <td>0.0</td>
      <td>36.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Hudson Sq</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>Sunday</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>3</td>
      <td>2.16</td>
      <td>9.0</td>
      <td>1.10</td>
      <td>0.0</td>
      <td>13.40</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Midtown East</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>Saturday</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6428</th>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>1</td>
      <td>0.75</td>
      <td>4.5</td>
      <td>1.06</td>
      <td>0.0</td>
      <td>6.36</td>
      <td>green</td>
      <td>credit card</td>
      <td>East Harlem North</td>
      <td>Central Harlem North</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>Sunday</td>
    </tr>
    <tr>
      <th>6429</th>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>1</td>
      <td>18.74</td>
      <td>58.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>58.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>Jamaica</td>
      <td>East Concourse/Concourse Village</td>
      <td>Queens</td>
      <td>Bronx</td>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>Sunday</td>
    </tr>
    <tr>
      <th>6430</th>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>1</td>
      <td>4.14</td>
      <td>16.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>17.30</td>
      <td>green</td>
      <td>cash</td>
      <td>Crown Heights North</td>
      <td>Bushwick North</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>Saturday</td>
    </tr>
    <tr>
      <th>6431</th>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>1</td>
      <td>1.12</td>
      <td>6.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>6.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>East New York</td>
      <td>East Flatbush/Remsen Village</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>Monday</td>
    </tr>
    <tr>
      <th>6432</th>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>1</td>
      <td>3.85</td>
      <td>15.0</td>
      <td>3.36</td>
      <td>0.0</td>
      <td>20.16</td>
      <td>green</td>
      <td>credit card</td>
      <td>Boerum Hill</td>
      <td>Windsor Terrace</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>Wednesday</td>
    </tr>
  </tbody>
</table>
<p>6433 rows √ó 17 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Make a new column ‚Äúduration‚Äù which stores how long the ride took.</p></li>
</ul>
<p>Because we made two columns containing date time values, we can just subtract them to get how long the taxi ride lasted. Notice, we could not do this if we had just stuck with strings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;droptime&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;picktime&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>picktime</th>
      <th>droptime</th>
      <th>day</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>1</td>
      <td>1.60</td>
      <td>7.0</td>
      <td>2.15</td>
      <td>0.0</td>
      <td>12.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Lenox Hill West</td>
      <td>UN/Turtle Bay South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>Saturday</td>
      <td>0 days 00:06:15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>1</td>
      <td>0.79</td>
      <td>5.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>9.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>Upper West Side South</td>
      <td>Upper West Side South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>Monday</td>
      <td>0 days 00:07:05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>1</td>
      <td>1.37</td>
      <td>7.5</td>
      <td>2.36</td>
      <td>0.0</td>
      <td>14.16</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Alphabet City</td>
      <td>West Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>Wednesday</td>
      <td>0 days 00:07:24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>1</td>
      <td>7.70</td>
      <td>27.0</td>
      <td>6.15</td>
      <td>0.0</td>
      <td>36.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Hudson Sq</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>Sunday</td>
      <td>0 days 00:25:52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>3</td>
      <td>2.16</td>
      <td>9.0</td>
      <td>1.10</td>
      <td>0.0</td>
      <td>13.40</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Midtown East</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>Saturday</td>
      <td>0 days 00:09:32</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6428</th>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>1</td>
      <td>0.75</td>
      <td>4.5</td>
      <td>1.06</td>
      <td>0.0</td>
      <td>6.36</td>
      <td>green</td>
      <td>credit card</td>
      <td>East Harlem North</td>
      <td>Central Harlem North</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>Sunday</td>
      <td>0 days 00:03:34</td>
    </tr>
    <tr>
      <th>6429</th>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>1</td>
      <td>18.74</td>
      <td>58.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>58.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>Jamaica</td>
      <td>East Concourse/Concourse Village</td>
      <td>Queens</td>
      <td>Bronx</td>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>Sunday</td>
      <td>0 days 00:56:23</td>
    </tr>
    <tr>
      <th>6430</th>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>1</td>
      <td>4.14</td>
      <td>16.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>17.30</td>
      <td>green</td>
      <td>cash</td>
      <td>Crown Heights North</td>
      <td>Bushwick North</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>Saturday</td>
      <td>0 days 00:19:07</td>
    </tr>
    <tr>
      <th>6431</th>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>1</td>
      <td>1.12</td>
      <td>6.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>6.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>East New York</td>
      <td>East Flatbush/Remsen Village</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>Monday</td>
      <td>0 days 00:05:04</td>
    </tr>
    <tr>
      <th>6432</th>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>1</td>
      <td>3.85</td>
      <td>15.0</td>
      <td>3.36</td>
      <td>0.0</td>
      <td>20.16</td>
      <td>green</td>
      <td>credit card</td>
      <td>Boerum Hill</td>
      <td>Windsor Terrace</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>Wednesday</td>
      <td>0 days 00:16:40</td>
    </tr>
  </tbody>
</table>
<p>6433 rows √ó 18 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#First three rows, first two columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">3</span><span class="p">,:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can see in row 0 that the person was picked up at 8:21pm and dropped off at 8:27pm. The whole trip took about 6 minutes, which is consistent with the duration that we computed above.</p>
</section>
</section>
<section id="working-with-strings-in-pandas">
<h2>Working with strings in pandas<a class="headerlink" href="#working-with-strings-in-pandas" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>How many rows in <code class="docutils literal notranslate"><span class="pre">df</span></code> have the word ‚ÄúAirport‚Äù in either the ‚Äúpickup_zone‚Äù column or the ‚Äúdropoff_zone‚Äù column. Do any of the rows have the word ‚ÄúAirport‚Äù in both columns?</p>
<ul>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">str</span></code> accessor and the <code class="docutils literal notranslate"><span class="pre">contains</span></code> method</p></li>
</ul>
</li>
</ul>
<p>Test cases before we solve the problem‚Ä¶</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup_zone&quot;</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0          Lenox Hill West
1    Upper West Side South
2            Alphabet City
Name: pickup_zone, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup_zone&quot;</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Alphabet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1    False
2     True
Name: pickup_zone, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup_zone&quot;</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;City&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1    False
2     True
Name: pickup_zone, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>We‚Äôll extend this idea to the entire pickup_zone column. Let‚Äôs see one more example‚Ä¶</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Check for something that never appears</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup_zone&quot;</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Gotham&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1    False
2    False
Name: pickup_zone, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Check: case sensitive?</span>
<span class="c1">#A: yes!</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup_zone&quot;</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;alphabet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1    False
2    False
Name: pickup_zone, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#still case sensitive</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup_zone&quot;</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;alphabet city&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1    False
2    False
Name: pickup_zone, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>Let‚Äôs start by checking for all rides which involve the airport in some capacity (e.g. either start or end at an airport‚Ä¶or both)</p>
<p>We might be concerned about case sensitivity. I know this dataset and know that if Airport appears, it will be capitalized.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Since we&#39;re dealing with pandas, we use | for &quot;or&quot;</span>
<span class="n">bool_ser</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup_zone&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Airport&quot;</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;dropoff_zone&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Airport&quot;</span><span class="p">))</span>
<span class="n">bool_ser</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       False
1       False
2       False
3       False
4       False
        ...  
6428    False
6429    False
6430    False
6431    False
6432    False
Length: 6433, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>It might look like there are not places where this is True, but we are just seeing the very beginning and end of the data. How could we quickly count how many rows this is true for?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bool_ser</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>407
</pre></div>
</div>
</div>
</div>
<p>There are 297 rows where either the pickup or dropoff involved an airport.</p>
<p>Let‚Äôs get the sub-DataFrame with these rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">bool_ser</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>picktime</th>
      <th>droptime</th>
      <th>day</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>2019-03-16 10:02:25</td>
      <td>2019-03-16 10:22:29</td>
      <td>1</td>
      <td>3.90</td>
      <td>17.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>17.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>LaGuardia Airport</td>
      <td>Astoria</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-16 10:02:25</td>
      <td>2019-03-16 10:22:29</td>
      <td>Saturday</td>
      <td>0 days 00:20:04</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2019-03-28 17:20:54</td>
      <td>2019-03-28 17:55:57</td>
      <td>1</td>
      <td>9.82</td>
      <td>31.50</td>
      <td>8.31</td>
      <td>5.76</td>
      <td>49.87</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>LaGuardia Airport</td>
      <td>Sutton Place/Turtle Bay North</td>
      <td>Queens</td>
      <td>Manhattan</td>
      <td>2019-03-28 17:20:54</td>
      <td>2019-03-28 17:55:57</td>
      <td>Thursday</td>
      <td>0 days 00:35:03</td>
    </tr>
    <tr>
      <th>43</th>
      <td>2019-03-27 19:39:16</td>
      <td>2019-03-27 20:00:26</td>
      <td>1</td>
      <td>9.50</td>
      <td>28.00</td>
      <td>0.00</td>
      <td>5.76</td>
      <td>35.06</td>
      <td>yellow</td>
      <td>cash</td>
      <td>LaGuardia Airport</td>
      <td>Washington Heights South</td>
      <td>Queens</td>
      <td>Manhattan</td>
      <td>2019-03-27 19:39:16</td>
      <td>2019-03-27 20:00:26</td>
      <td>Wednesday</td>
      <td>0 days 00:21:10</td>
    </tr>
    <tr>
      <th>53</th>
      <td>2019-03-20 18:49:24</td>
      <td>2019-03-20 19:12:40</td>
      <td>1</td>
      <td>13.45</td>
      <td>36.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>37.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>Sunnyside</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-20 18:49:24</td>
      <td>2019-03-20 19:12:40</td>
      <td>Wednesday</td>
      <td>0 days 00:23:16</td>
    </tr>
    <tr>
      <th>56</th>
      <td>2019-03-05 17:57:00</td>
      <td>2019-03-05 18:45:25</td>
      <td>2</td>
      <td>19.59</td>
      <td>52.00</td>
      <td>0.00</td>
      <td>5.76</td>
      <td>65.56</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>Upper East Side North</td>
      <td>Queens</td>
      <td>Manhattan</td>
      <td>2019-03-05 17:57:00</td>
      <td>2019-03-05 18:45:25</td>
      <td>Tuesday</td>
      <td>0 days 00:48:25</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6243</th>
      <td>2019-03-12 11:40:49</td>
      <td>2019-03-12 11:49:23</td>
      <td>1</td>
      <td>3.50</td>
      <td>12.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>12.80</td>
      <td>green</td>
      <td>cash</td>
      <td>Steinway</td>
      <td>LaGuardia Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-12 11:40:49</td>
      <td>2019-03-12 11:49:23</td>
      <td>Tuesday</td>
      <td>0 days 00:08:34</td>
    </tr>
    <tr>
      <th>6280</th>
      <td>2019-03-27 12:25:04</td>
      <td>2019-03-27 12:31:15</td>
      <td>1</td>
      <td>2.74</td>
      <td>10.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>10.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>Steinway</td>
      <td>LaGuardia Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-27 12:25:04</td>
      <td>2019-03-27 12:31:15</td>
      <td>Wednesday</td>
      <td>0 days 00:06:11</td>
    </tr>
    <tr>
      <th>6322</th>
      <td>2019-03-01 17:03:11</td>
      <td>2019-03-01 17:17:11</td>
      <td>1</td>
      <td>5.39</td>
      <td>17.00</td>
      <td>3.76</td>
      <td>0.00</td>
      <td>22.56</td>
      <td>green</td>
      <td>credit card</td>
      <td>Jamaica</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-01 17:03:11</td>
      <td>2019-03-01 17:17:11</td>
      <td>Friday</td>
      <td>0 days 00:14:00</td>
    </tr>
    <tr>
      <th>6396</th>
      <td>2019-03-15 17:44:09</td>
      <td>2019-03-15 18:20:25</td>
      <td>1</td>
      <td>11.44</td>
      <td>41.63</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>42.13</td>
      <td>green</td>
      <td>credit card</td>
      <td>Bushwick South</td>
      <td>LaGuardia Airport</td>
      <td>Brooklyn</td>
      <td>Queens</td>
      <td>2019-03-15 17:44:09</td>
      <td>2019-03-15 18:20:25</td>
      <td>Friday</td>
      <td>0 days 00:36:16</td>
    </tr>
    <tr>
      <th>6398</th>
      <td>2019-03-17 13:07:29</td>
      <td>2019-03-17 13:51:56</td>
      <td>1</td>
      <td>18.39</td>
      <td>50.50</td>
      <td>7.70</td>
      <td>0.00</td>
      <td>59.00</td>
      <td>green</td>
      <td>credit card</td>
      <td>DUMBO/Vinegar Hill</td>
      <td>JFK Airport</td>
      <td>Brooklyn</td>
      <td>Queens</td>
      <td>2019-03-17 13:07:29</td>
      <td>2019-03-17 13:51:56</td>
      <td>Sunday</td>
      <td>0 days 00:44:27</td>
    </tr>
  </tbody>
</table>
<p>407 rows √ó 18 columns</p>
</div></div></div>
</div>
<p>Now, let‚Äôs get all rides that start and end at an airport.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bool_ser2</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup_zone&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Airport&quot;</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;dropoff_zone&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Airport&quot;</span><span class="p">))</span>
<span class="n">bool_ser2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       False
1       False
2       False
3       False
4       False
        ...  
6428    False
6429    False
6430    False
6431    False
6432    False
Length: 6433, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bool_ser2</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">bool_ser2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>picktime</th>
      <th>droptime</th>
      <th>day</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>120</th>
      <td>2019-03-21 17:21:44</td>
      <td>2019-03-21 17:21:49</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-21 17:21:44</td>
      <td>2019-03-21 17:21:49</td>
      <td>Thursday</td>
      <td>0 days 00:00:05</td>
    </tr>
    <tr>
      <th>770</th>
      <td>2019-03-02 03:16:59</td>
      <td>2019-03-02 03:17:06</td>
      <td>0</td>
      <td>9.40</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.80</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-02 03:16:59</td>
      <td>2019-03-02 03:17:06</td>
      <td>Saturday</td>
      <td>0 days 00:00:07</td>
    </tr>
    <tr>
      <th>1080</th>
      <td>2019-03-04 14:17:05</td>
      <td>2019-03-04 14:17:13</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-04 14:17:05</td>
      <td>2019-03-04 14:17:13</td>
      <td>Monday</td>
      <td>0 days 00:00:08</td>
    </tr>
    <tr>
      <th>1089</th>
      <td>2019-03-10 01:43:32</td>
      <td>2019-03-10 01:45:22</td>
      <td>1</td>
      <td>0.37</td>
      <td>3.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-10 01:43:32</td>
      <td>2019-03-10 01:45:22</td>
      <td>Sunday</td>
      <td>0 days 00:01:50</td>
    </tr>
    <tr>
      <th>1416</th>
      <td>2019-03-09 13:16:32</td>
      <td>2019-03-09 13:46:11</td>
      <td>2</td>
      <td>12.39</td>
      <td>35.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>35.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>LaGuardia Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-09 13:16:32</td>
      <td>2019-03-09 13:46:11</td>
      <td>Saturday</td>
      <td>0 days 00:29:39</td>
    </tr>
    <tr>
      <th>1929</th>
      <td>2019-03-13 22:35:35</td>
      <td>2019-03-13 22:35:49</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.80</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-13 22:35:35</td>
      <td>2019-03-13 22:35:49</td>
      <td>Wednesday</td>
      <td>0 days 00:00:14</td>
    </tr>
    <tr>
      <th>2387</th>
      <td>2019-03-28 15:58:52</td>
      <td>2019-03-28 15:59:25</td>
      <td>1</td>
      <td>1.80</td>
      <td>69.06</td>
      <td>20.80</td>
      <td>0.00</td>
      <td>90.16</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-28 15:58:52</td>
      <td>2019-03-28 15:59:25</td>
      <td>Thursday</td>
      <td>0 days 00:00:33</td>
    </tr>
    <tr>
      <th>3571</th>
      <td>2019-03-22 16:47:41</td>
      <td>2019-03-22 16:47:50</td>
      <td>1</td>
      <td>0.81</td>
      <td>66.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>66.80</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-22 16:47:41</td>
      <td>2019-03-22 16:47:50</td>
      <td>Friday</td>
      <td>0 days 00:00:09</td>
    </tr>
    <tr>
      <th>4358</th>
      <td>2019-03-06 18:24:00</td>
      <td>2019-03-06 18:24:13</td>
      <td>2</td>
      <td>0.01</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-06 18:24:00</td>
      <td>2019-03-06 18:24:13</td>
      <td>Wednesday</td>
      <td>0 days 00:00:13</td>
    </tr>
    <tr>
      <th>5095</th>
      <td>2019-03-30 20:14:44</td>
      <td>2019-03-30 21:01:28</td>
      <td>3</td>
      <td>18.91</td>
      <td>52.00</td>
      <td>8.78</td>
      <td>5.76</td>
      <td>67.34</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-30 20:14:44</td>
      <td>2019-03-30 21:01:28</td>
      <td>Saturday</td>
      <td>0 days 00:46:44</td>
    </tr>
    <tr>
      <th>5364</th>
      <td>2019-03-17 16:59:17</td>
      <td>2019-03-17 18:04:08</td>
      <td>2</td>
      <td>36.70</td>
      <td>150.00</td>
      <td>0.00</td>
      <td>24.02</td>
      <td>174.82</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-17 16:59:17</td>
      <td>2019-03-17 18:04:08</td>
      <td>Sunday</td>
      <td>0 days 01:04:51</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>There was an issue above where I misspelled ‚ÄúAirport‚Äù. Below is the code we wrote to try troubleshooting.
Idea? Is it the fact that Airport is not the first word? Nope! We can check here‚Ä¶</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup_zone&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Airport&quot;</span><span class="p">)[</span><span class="mi">120</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Question: Is <code class="docutils literal notranslate"><span class="pre">Series.sum()</span></code> faster than <code class="docutils literal notranslate"><span class="pre">sum(Series)</span></code>.
Answer: Yes! <code class="docutils literal notranslate"><span class="pre">sum()</span></code> is a built-in python function and has to work for a large number of data types. On the other hand, <code class="docutils literal notranslate"><span class="pre">.sum()</span></code> is specialized for pandas Series and runs very fast:
* Series objects (like NumPy arrays) have elements all of the same data types
* Vectorized operations (has a way of working with the entire series at once)</p>
<p>Here is a slightly more organized way of getting the same answer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ps</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup_zone&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Airport&quot;</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;dropoff_zone&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Airport&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Or case</span>
<span class="n">df</span><span class="p">[</span><span class="n">ps</span> <span class="o">|</span> <span class="n">ds</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>picktime</th>
      <th>droptime</th>
      <th>day</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>2019-03-16 10:02:25</td>
      <td>2019-03-16 10:22:29</td>
      <td>1</td>
      <td>3.90</td>
      <td>17.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>17.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>LaGuardia Airport</td>
      <td>Astoria</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-16 10:02:25</td>
      <td>2019-03-16 10:22:29</td>
      <td>Saturday</td>
      <td>0 days 00:20:04</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2019-03-28 17:20:54</td>
      <td>2019-03-28 17:55:57</td>
      <td>1</td>
      <td>9.82</td>
      <td>31.50</td>
      <td>8.31</td>
      <td>5.76</td>
      <td>49.87</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>LaGuardia Airport</td>
      <td>Sutton Place/Turtle Bay North</td>
      <td>Queens</td>
      <td>Manhattan</td>
      <td>2019-03-28 17:20:54</td>
      <td>2019-03-28 17:55:57</td>
      <td>Thursday</td>
      <td>0 days 00:35:03</td>
    </tr>
    <tr>
      <th>43</th>
      <td>2019-03-27 19:39:16</td>
      <td>2019-03-27 20:00:26</td>
      <td>1</td>
      <td>9.50</td>
      <td>28.00</td>
      <td>0.00</td>
      <td>5.76</td>
      <td>35.06</td>
      <td>yellow</td>
      <td>cash</td>
      <td>LaGuardia Airport</td>
      <td>Washington Heights South</td>
      <td>Queens</td>
      <td>Manhattan</td>
      <td>2019-03-27 19:39:16</td>
      <td>2019-03-27 20:00:26</td>
      <td>Wednesday</td>
      <td>0 days 00:21:10</td>
    </tr>
    <tr>
      <th>53</th>
      <td>2019-03-20 18:49:24</td>
      <td>2019-03-20 19:12:40</td>
      <td>1</td>
      <td>13.45</td>
      <td>36.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>37.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>Sunnyside</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-20 18:49:24</td>
      <td>2019-03-20 19:12:40</td>
      <td>Wednesday</td>
      <td>0 days 00:23:16</td>
    </tr>
    <tr>
      <th>56</th>
      <td>2019-03-05 17:57:00</td>
      <td>2019-03-05 18:45:25</td>
      <td>2</td>
      <td>19.59</td>
      <td>52.00</td>
      <td>0.00</td>
      <td>5.76</td>
      <td>65.56</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>Upper East Side North</td>
      <td>Queens</td>
      <td>Manhattan</td>
      <td>2019-03-05 17:57:00</td>
      <td>2019-03-05 18:45:25</td>
      <td>Tuesday</td>
      <td>0 days 00:48:25</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6243</th>
      <td>2019-03-12 11:40:49</td>
      <td>2019-03-12 11:49:23</td>
      <td>1</td>
      <td>3.50</td>
      <td>12.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>12.80</td>
      <td>green</td>
      <td>cash</td>
      <td>Steinway</td>
      <td>LaGuardia Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-12 11:40:49</td>
      <td>2019-03-12 11:49:23</td>
      <td>Tuesday</td>
      <td>0 days 00:08:34</td>
    </tr>
    <tr>
      <th>6280</th>
      <td>2019-03-27 12:25:04</td>
      <td>2019-03-27 12:31:15</td>
      <td>1</td>
      <td>2.74</td>
      <td>10.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>10.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>Steinway</td>
      <td>LaGuardia Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-27 12:25:04</td>
      <td>2019-03-27 12:31:15</td>
      <td>Wednesday</td>
      <td>0 days 00:06:11</td>
    </tr>
    <tr>
      <th>6322</th>
      <td>2019-03-01 17:03:11</td>
      <td>2019-03-01 17:17:11</td>
      <td>1</td>
      <td>5.39</td>
      <td>17.00</td>
      <td>3.76</td>
      <td>0.00</td>
      <td>22.56</td>
      <td>green</td>
      <td>credit card</td>
      <td>Jamaica</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-01 17:03:11</td>
      <td>2019-03-01 17:17:11</td>
      <td>Friday</td>
      <td>0 days 00:14:00</td>
    </tr>
    <tr>
      <th>6396</th>
      <td>2019-03-15 17:44:09</td>
      <td>2019-03-15 18:20:25</td>
      <td>1</td>
      <td>11.44</td>
      <td>41.63</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>42.13</td>
      <td>green</td>
      <td>credit card</td>
      <td>Bushwick South</td>
      <td>LaGuardia Airport</td>
      <td>Brooklyn</td>
      <td>Queens</td>
      <td>2019-03-15 17:44:09</td>
      <td>2019-03-15 18:20:25</td>
      <td>Friday</td>
      <td>0 days 00:36:16</td>
    </tr>
    <tr>
      <th>6398</th>
      <td>2019-03-17 13:07:29</td>
      <td>2019-03-17 13:51:56</td>
      <td>1</td>
      <td>18.39</td>
      <td>50.50</td>
      <td>7.70</td>
      <td>0.00</td>
      <td>59.00</td>
      <td>green</td>
      <td>credit card</td>
      <td>DUMBO/Vinegar Hill</td>
      <td>JFK Airport</td>
      <td>Brooklyn</td>
      <td>Queens</td>
      <td>2019-03-17 13:07:29</td>
      <td>2019-03-17 13:51:56</td>
      <td>Sunday</td>
      <td>0 days 00:44:27</td>
    </tr>
  </tbody>
</table>
<p>407 rows √ó 18 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#And case</span>
<span class="n">df</span><span class="p">[</span><span class="n">ps</span> <span class="o">&amp;</span> <span class="n">ds</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>picktime</th>
      <th>droptime</th>
      <th>day</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>120</th>
      <td>2019-03-21 17:21:44</td>
      <td>2019-03-21 17:21:49</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-21 17:21:44</td>
      <td>2019-03-21 17:21:49</td>
      <td>Thursday</td>
      <td>0 days 00:00:05</td>
    </tr>
    <tr>
      <th>770</th>
      <td>2019-03-02 03:16:59</td>
      <td>2019-03-02 03:17:06</td>
      <td>0</td>
      <td>9.40</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.80</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-02 03:16:59</td>
      <td>2019-03-02 03:17:06</td>
      <td>Saturday</td>
      <td>0 days 00:00:07</td>
    </tr>
    <tr>
      <th>1080</th>
      <td>2019-03-04 14:17:05</td>
      <td>2019-03-04 14:17:13</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-04 14:17:05</td>
      <td>2019-03-04 14:17:13</td>
      <td>Monday</td>
      <td>0 days 00:00:08</td>
    </tr>
    <tr>
      <th>1089</th>
      <td>2019-03-10 01:43:32</td>
      <td>2019-03-10 01:45:22</td>
      <td>1</td>
      <td>0.37</td>
      <td>3.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-10 01:43:32</td>
      <td>2019-03-10 01:45:22</td>
      <td>Sunday</td>
      <td>0 days 00:01:50</td>
    </tr>
    <tr>
      <th>1416</th>
      <td>2019-03-09 13:16:32</td>
      <td>2019-03-09 13:46:11</td>
      <td>2</td>
      <td>12.39</td>
      <td>35.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>35.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>LaGuardia Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-09 13:16:32</td>
      <td>2019-03-09 13:46:11</td>
      <td>Saturday</td>
      <td>0 days 00:29:39</td>
    </tr>
    <tr>
      <th>1929</th>
      <td>2019-03-13 22:35:35</td>
      <td>2019-03-13 22:35:49</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.80</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-13 22:35:35</td>
      <td>2019-03-13 22:35:49</td>
      <td>Wednesday</td>
      <td>0 days 00:00:14</td>
    </tr>
    <tr>
      <th>2387</th>
      <td>2019-03-28 15:58:52</td>
      <td>2019-03-28 15:59:25</td>
      <td>1</td>
      <td>1.80</td>
      <td>69.06</td>
      <td>20.80</td>
      <td>0.00</td>
      <td>90.16</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-28 15:58:52</td>
      <td>2019-03-28 15:59:25</td>
      <td>Thursday</td>
      <td>0 days 00:00:33</td>
    </tr>
    <tr>
      <th>3571</th>
      <td>2019-03-22 16:47:41</td>
      <td>2019-03-22 16:47:50</td>
      <td>1</td>
      <td>0.81</td>
      <td>66.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>66.80</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-22 16:47:41</td>
      <td>2019-03-22 16:47:50</td>
      <td>Friday</td>
      <td>0 days 00:00:09</td>
    </tr>
    <tr>
      <th>4358</th>
      <td>2019-03-06 18:24:00</td>
      <td>2019-03-06 18:24:13</td>
      <td>2</td>
      <td>0.01</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-06 18:24:00</td>
      <td>2019-03-06 18:24:13</td>
      <td>Wednesday</td>
      <td>0 days 00:00:13</td>
    </tr>
    <tr>
      <th>5095</th>
      <td>2019-03-30 20:14:44</td>
      <td>2019-03-30 21:01:28</td>
      <td>3</td>
      <td>18.91</td>
      <td>52.00</td>
      <td>8.78</td>
      <td>5.76</td>
      <td>67.34</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-30 20:14:44</td>
      <td>2019-03-30 21:01:28</td>
      <td>Saturday</td>
      <td>0 days 00:46:44</td>
    </tr>
    <tr>
      <th>5364</th>
      <td>2019-03-17 16:59:17</td>
      <td>2019-03-17 18:04:08</td>
      <td>2</td>
      <td>36.70</td>
      <td>150.00</td>
      <td>0.00</td>
      <td>24.02</td>
      <td>174.82</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-17 16:59:17</td>
      <td>2019-03-17 18:04:08</td>
      <td>Sunday</td>
      <td>0 days 01:04:51</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="working-with-missing-values-in-pandas">
<h2>Working with missing values in pandas<a class="headerlink" href="#working-with-missing-values-in-pandas" title="Permalink to this headline">#</a></h2>
<p>Two main options for dealing with missing data:</p>
<ul class="simple">
<li><p>Ignore it! Drop the rows that have at least one missing value (Mostly what we‚Äôll do in Math 10).</p></li>
<li><p>Interpolate using known rows to put a good ‚Äúguess‚Äù for the missing value (not something we‚Äôll do in Math 10)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>picktime</th>
      <th>droptime</th>
      <th>day</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>1</td>
      <td>1.60</td>
      <td>7.0</td>
      <td>2.15</td>
      <td>0.0</td>
      <td>12.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Lenox Hill West</td>
      <td>UN/Turtle Bay South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>Saturday</td>
      <td>0 days 00:06:15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>1</td>
      <td>0.79</td>
      <td>5.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>9.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>Upper West Side South</td>
      <td>Upper West Side South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>Monday</td>
      <td>0 days 00:07:05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>1</td>
      <td>1.37</td>
      <td>7.5</td>
      <td>2.36</td>
      <td>0.0</td>
      <td>14.16</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Alphabet City</td>
      <td>West Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>Wednesday</td>
      <td>0 days 00:07:24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>1</td>
      <td>7.70</td>
      <td>27.0</td>
      <td>6.15</td>
      <td>0.0</td>
      <td>36.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Hudson Sq</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>Sunday</td>
      <td>0 days 00:25:52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>3</td>
      <td>2.16</td>
      <td>9.0</td>
      <td>1.10</td>
      <td>0.0</td>
      <td>13.40</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Midtown East</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>Saturday</td>
      <td>0 days 00:09:32</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6428</th>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>1</td>
      <td>0.75</td>
      <td>4.5</td>
      <td>1.06</td>
      <td>0.0</td>
      <td>6.36</td>
      <td>green</td>
      <td>credit card</td>
      <td>East Harlem North</td>
      <td>Central Harlem North</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>Sunday</td>
      <td>0 days 00:03:34</td>
    </tr>
    <tr>
      <th>6429</th>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>1</td>
      <td>18.74</td>
      <td>58.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>58.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>Jamaica</td>
      <td>East Concourse/Concourse Village</td>
      <td>Queens</td>
      <td>Bronx</td>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>Sunday</td>
      <td>0 days 00:56:23</td>
    </tr>
    <tr>
      <th>6430</th>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>1</td>
      <td>4.14</td>
      <td>16.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>17.30</td>
      <td>green</td>
      <td>cash</td>
      <td>Crown Heights North</td>
      <td>Bushwick North</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>Saturday</td>
      <td>0 days 00:19:07</td>
    </tr>
    <tr>
      <th>6431</th>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>1</td>
      <td>1.12</td>
      <td>6.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>6.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>East New York</td>
      <td>East Flatbush/Remsen Village</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>Monday</td>
      <td>0 days 00:05:04</td>
    </tr>
    <tr>
      <th>6432</th>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>1</td>
      <td>3.85</td>
      <td>15.0</td>
      <td>3.36</td>
      <td>0.0</td>
      <td>20.16</td>
      <td>green</td>
      <td>credit card</td>
      <td>Boerum Hill</td>
      <td>Windsor Terrace</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>Wednesday</td>
      <td>0 days 00:16:40</td>
    </tr>
  </tbody>
</table>
<p>6433 rows √ó 18 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Look at <code class="docutils literal notranslate"><span class="pre">df.info</span></code> again. Which rows have missing values?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 6433 entries, 0 to 6432
Data columns (total 18 columns):
 #   Column           Non-Null Count  Dtype          
---  ------           --------------  -----          
 0   pickup           6433 non-null   object         
 1   dropoff          6433 non-null   object         
 2   passengers       6433 non-null   int64          
 3   distance         6433 non-null   float64        
 4   fare             6433 non-null   float64        
 5   tip              6433 non-null   float64        
 6   tolls            6433 non-null   float64        
 7   total            6433 non-null   float64        
 8   color            6433 non-null   object         
 9   payment          6389 non-null   object         
 10  pickup_zone      6407 non-null   object         
 11  dropoff_zone     6388 non-null   object         
 12  pickup_borough   6407 non-null   object         
 13  dropoff_borough  6388 non-null   object         
 14  picktime         6433 non-null   datetime64[ns] 
 15  droptime         6433 non-null   datetime64[ns] 
 16  day              6433 non-null   object         
 17  duration         6433 non-null   timedelta64[ns]
dtypes: datetime64[ns](2), float64(5), int64(1), object(9), timedelta64[ns](1)
memory usage: 904.8+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Count how many values are missing from the payment column?</span>
<span class="mi">6433</span> <span class="o">-</span> <span class="mi">6389</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>44
</pre></div>
</div>
</div>
</div>
<p>Here‚Äôs a slightly nicer way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;payment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>44
</pre></div>
</div>
</div>
</div>
<p>A common task is to remove all the rows which are missing any values.</p>
<p>Here‚Äôs the easiest way:</p>
<p>Notice, the code below does not actually change <code class="docutils literal notranslate"><span class="pre">df</span></code>. It just displays what <code class="docutils literal notranslate"><span class="pre">df</span></code> looks like with  missing values. If I actually wanted to change <code class="docutils literal notranslate"><span class="pre">df</span></code> I‚Äôd need to include <code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">=...</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Notice row label 7 is missing!</span>
<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>picktime</th>
      <th>droptime</th>
      <th>day</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>1</td>
      <td>1.60</td>
      <td>7.0</td>
      <td>2.15</td>
      <td>0.0</td>
      <td>12.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Lenox Hill West</td>
      <td>UN/Turtle Bay South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>Saturday</td>
      <td>0 days 00:06:15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>1</td>
      <td>0.79</td>
      <td>5.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>9.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>Upper West Side South</td>
      <td>Upper West Side South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>Monday</td>
      <td>0 days 00:07:05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>1</td>
      <td>1.37</td>
      <td>7.5</td>
      <td>2.36</td>
      <td>0.0</td>
      <td>14.16</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Alphabet City</td>
      <td>West Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>Wednesday</td>
      <td>0 days 00:07:24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>1</td>
      <td>7.70</td>
      <td>27.0</td>
      <td>6.15</td>
      <td>0.0</td>
      <td>36.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Hudson Sq</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>Sunday</td>
      <td>0 days 00:25:52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>3</td>
      <td>2.16</td>
      <td>9.0</td>
      <td>1.10</td>
      <td>0.0</td>
      <td>13.40</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Midtown East</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>Saturday</td>
      <td>0 days 00:09:32</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6428</th>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>1</td>
      <td>0.75</td>
      <td>4.5</td>
      <td>1.06</td>
      <td>0.0</td>
      <td>6.36</td>
      <td>green</td>
      <td>credit card</td>
      <td>East Harlem North</td>
      <td>Central Harlem North</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>Sunday</td>
      <td>0 days 00:03:34</td>
    </tr>
    <tr>
      <th>6429</th>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>1</td>
      <td>18.74</td>
      <td>58.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>58.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>Jamaica</td>
      <td>East Concourse/Concourse Village</td>
      <td>Queens</td>
      <td>Bronx</td>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>Sunday</td>
      <td>0 days 00:56:23</td>
    </tr>
    <tr>
      <th>6430</th>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>1</td>
      <td>4.14</td>
      <td>16.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>17.30</td>
      <td>green</td>
      <td>cash</td>
      <td>Crown Heights North</td>
      <td>Bushwick North</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>Saturday</td>
      <td>0 days 00:19:07</td>
    </tr>
    <tr>
      <th>6431</th>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>1</td>
      <td>1.12</td>
      <td>6.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>6.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>East New York</td>
      <td>East Flatbush/Remsen Village</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>Monday</td>
      <td>0 days 00:05:04</td>
    </tr>
    <tr>
      <th>6432</th>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>1</td>
      <td>3.85</td>
      <td>15.0</td>
      <td>3.36</td>
      <td>0.0</td>
      <td>20.16</td>
      <td>green</td>
      <td>credit card</td>
      <td>Boerum Hill</td>
      <td>Windsor Terrace</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>Wednesday</td>
      <td>0 days 00:16:40</td>
    </tr>
  </tbody>
</table>
<p>6341 rows √ó 18 columns</p>
</div></div></div>
</div>
<p>Question: How could we remove a column with a missing value?
Answer: <code class="docutils literal notranslate"><span class="pre">dropna()</span></code> takes an axis keyword</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on method dropna in module pandas.core.frame:

dropna(axis: &#39;Axis&#39; = 0, how: &#39;str&#39; = &#39;any&#39;, thresh=None, subset: &#39;IndexLabel&#39; = None, inplace: &#39;bool&#39; = False) method of pandas.core.frame.DataFrame instance
    Remove missing values.
    
    See the :ref:`User Guide &lt;missing_data&gt;` for more on which values are
    considered missing, and how to work with missing data.
    
    Parameters
    ----------
    axis : {0 or &#39;index&#39;, 1 or &#39;columns&#39;}, default 0
        Determine if rows or columns which contain missing values are
        removed.
    
        * 0, or &#39;index&#39; : Drop rows which contain missing values.
        * 1, or &#39;columns&#39; : Drop columns which contain missing value.
    
        .. versionchanged:: 1.0.0
    
           Pass tuple or list to drop on multiple axes.
           Only a single axis is allowed.
    
    how : {&#39;any&#39;, &#39;all&#39;}, default &#39;any&#39;
        Determine if row or column is removed from DataFrame, when we have
        at least one NA or all NA.
    
        * &#39;any&#39; : If any NA values are present, drop that row or column.
        * &#39;all&#39; : If all values are NA, drop that row or column.
    
    thresh : int, optional
        Require that many non-NA values.
    subset : column label or sequence of labels, optional
        Labels along other axis to consider, e.g. if you are dropping rows
        these would be a list of columns to include.
    inplace : bool, default False
        If True, do operation inplace and return None.
    
    Returns
    -------
    DataFrame or None
        DataFrame with NA entries dropped from it or None if ``inplace=True``.
    
    See Also
    --------
    DataFrame.isna: Indicate missing values.
    DataFrame.notna : Indicate existing (non-missing) values.
    DataFrame.fillna : Replace missing values.
    Series.dropna : Drop missing values.
    Index.dropna : Drop missing indices.
    
    Examples
    --------
    &gt;&gt;&gt; df = pd.DataFrame({&quot;name&quot;: [&#39;Alfred&#39;, &#39;Batman&#39;, &#39;Catwoman&#39;],
    ...                    &quot;toy&quot;: [np.nan, &#39;Batmobile&#39;, &#39;Bullwhip&#39;],
    ...                    &quot;born&quot;: [pd.NaT, pd.Timestamp(&quot;1940-04-25&quot;),
    ...                             pd.NaT]})
    &gt;&gt;&gt; df
           name        toy       born
    0    Alfred        NaN        NaT
    1    Batman  Batmobile 1940-04-25
    2  Catwoman   Bullwhip        NaT
    
    Drop the rows where at least one element is missing.
    
    &gt;&gt;&gt; df.dropna()
         name        toy       born
    1  Batman  Batmobile 1940-04-25
    
    Drop the columns where at least one element is missing.
    
    &gt;&gt;&gt; df.dropna(axis=&#39;columns&#39;)
           name
    0    Alfred
    1    Batman
    2  Catwoman
    
    Drop the rows where all elements are missing.
    
    &gt;&gt;&gt; df.dropna(how=&#39;all&#39;)
           name        toy       born
    0    Alfred        NaN        NaT
    1    Batman  Batmobile 1940-04-25
    2  Catwoman   Bullwhip        NaT
    
    Keep only the rows with at least 2 non-NA values.
    
    &gt;&gt;&gt; df.dropna(thresh=2)
           name        toy       born
    1    Batman  Batmobile 1940-04-25
    2  Catwoman   Bullwhip        NaT
    
    Define in which columns to look for missing values.
    
    &gt;&gt;&gt; df.dropna(subset=[&#39;name&#39;, &#39;toy&#39;])
           name        toy       born
    1    Batman  Batmobile 1940-04-25
    2  Catwoman   Bullwhip        NaT
    
    Keep the DataFrame with valid entries in the same variable.
    
    &gt;&gt;&gt; df.dropna(inplace=True)
    &gt;&gt;&gt; df
         name        toy       born
    1  Batman  Batmobile 1940-04-25
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Should remove all columns with at least one missing value</span>
<span class="c1">#As a sanity check, compare with df.info()</span>
<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>picktime</th>
      <th>droptime</th>
      <th>day</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>1</td>
      <td>1.60</td>
      <td>7.0</td>
      <td>2.15</td>
      <td>0.0</td>
      <td>12.95</td>
      <td>yellow</td>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>Saturday</td>
      <td>0 days 00:06:15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>1</td>
      <td>0.79</td>
      <td>5.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>9.30</td>
      <td>yellow</td>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>Monday</td>
      <td>0 days 00:07:05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>1</td>
      <td>1.37</td>
      <td>7.5</td>
      <td>2.36</td>
      <td>0.0</td>
      <td>14.16</td>
      <td>yellow</td>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>Wednesday</td>
      <td>0 days 00:07:24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>1</td>
      <td>7.70</td>
      <td>27.0</td>
      <td>6.15</td>
      <td>0.0</td>
      <td>36.95</td>
      <td>yellow</td>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>Sunday</td>
      <td>0 days 00:25:52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>3</td>
      <td>2.16</td>
      <td>9.0</td>
      <td>1.10</td>
      <td>0.0</td>
      <td>13.40</td>
      <td>yellow</td>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>Saturday</td>
      <td>0 days 00:09:32</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6428</th>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>1</td>
      <td>0.75</td>
      <td>4.5</td>
      <td>1.06</td>
      <td>0.0</td>
      <td>6.36</td>
      <td>green</td>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>Sunday</td>
      <td>0 days 00:03:34</td>
    </tr>
    <tr>
      <th>6429</th>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>1</td>
      <td>18.74</td>
      <td>58.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>58.80</td>
      <td>green</td>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>Sunday</td>
      <td>0 days 00:56:23</td>
    </tr>
    <tr>
      <th>6430</th>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>1</td>
      <td>4.14</td>
      <td>16.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>17.30</td>
      <td>green</td>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>Saturday</td>
      <td>0 days 00:19:07</td>
    </tr>
    <tr>
      <th>6431</th>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>1</td>
      <td>1.12</td>
      <td>6.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>6.80</td>
      <td>green</td>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>Monday</td>
      <td>0 days 00:05:04</td>
    </tr>
    <tr>
      <th>6432</th>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>1</td>
      <td>3.85</td>
      <td>15.0</td>
      <td>3.36</td>
      <td>0.0</td>
      <td>20.16</td>
      <td>green</td>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>Wednesday</td>
      <td>0 days 00:16:40</td>
    </tr>
  </tbody>
</table>
<p>6433 rows √ó 13 columns</p>
</div></div></div>
</div>
<p>Here‚Äôs how we can remove missing rows without using <code class="docutils literal notranslate"><span class="pre">dropna</span></code>. This is just for practice with <code class="docutils literal notranslate"><span class="pre">any</span></code> and <code class="docutils literal notranslate"><span class="pre">all</span></code>‚Ä¶</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>picktime</th>
      <th>droptime</th>
      <th>day</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>1</td>
      <td>1.60</td>
      <td>7.0</td>
      <td>2.15</td>
      <td>0.0</td>
      <td>12.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Lenox Hill West</td>
      <td>UN/Turtle Bay South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>Saturday</td>
      <td>0 days 00:06:15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>1</td>
      <td>0.79</td>
      <td>5.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>9.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>Upper West Side South</td>
      <td>Upper West Side South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>Monday</td>
      <td>0 days 00:07:05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>1</td>
      <td>1.37</td>
      <td>7.5</td>
      <td>2.36</td>
      <td>0.0</td>
      <td>14.16</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Alphabet City</td>
      <td>West Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>Wednesday</td>
      <td>0 days 00:07:24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>1</td>
      <td>7.70</td>
      <td>27.0</td>
      <td>6.15</td>
      <td>0.0</td>
      <td>36.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Hudson Sq</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>Sunday</td>
      <td>0 days 00:25:52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>3</td>
      <td>2.16</td>
      <td>9.0</td>
      <td>1.10</td>
      <td>0.0</td>
      <td>13.40</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Midtown East</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>Saturday</td>
      <td>0 days 00:09:32</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6428</th>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>1</td>
      <td>0.75</td>
      <td>4.5</td>
      <td>1.06</td>
      <td>0.0</td>
      <td>6.36</td>
      <td>green</td>
      <td>credit card</td>
      <td>East Harlem North</td>
      <td>Central Harlem North</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>Sunday</td>
      <td>0 days 00:03:34</td>
    </tr>
    <tr>
      <th>6429</th>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>1</td>
      <td>18.74</td>
      <td>58.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>58.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>Jamaica</td>
      <td>East Concourse/Concourse Village</td>
      <td>Queens</td>
      <td>Bronx</td>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>Sunday</td>
      <td>0 days 00:56:23</td>
    </tr>
    <tr>
      <th>6430</th>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>1</td>
      <td>4.14</td>
      <td>16.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>17.30</td>
      <td>green</td>
      <td>cash</td>
      <td>Crown Heights North</td>
      <td>Bushwick North</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>Saturday</td>
      <td>0 days 00:19:07</td>
    </tr>
    <tr>
      <th>6431</th>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>1</td>
      <td>1.12</td>
      <td>6.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>6.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>East New York</td>
      <td>East Flatbush/Remsen Village</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>Monday</td>
      <td>0 days 00:05:04</td>
    </tr>
    <tr>
      <th>6432</th>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>1</td>
      <td>3.85</td>
      <td>15.0</td>
      <td>3.36</td>
      <td>0.0</td>
      <td>20.16</td>
      <td>green</td>
      <td>credit card</td>
      <td>Boerum Hill</td>
      <td>Windsor Terrace</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>Wednesday</td>
      <td>0 days 00:16:40</td>
    </tr>
  </tbody>
</table>
<p>6433 rows √ó 18 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       False
1       False
2       False
3       False
4       False
        ...  
6428    False
6429    False
6430    False
6431    False
6432    False
Length: 6433, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#All of the rows which have at least one missing value</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>picktime</th>
      <th>droptime</th>
      <th>day</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>2019-03-22 12:47:13</td>
      <td>2019-03-22 12:58:17</td>
      <td>0</td>
      <td>1.4</td>
      <td>8.5</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>11.80</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>Murray Hill</td>
      <td>Flatiron</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-22 12:47:13</td>
      <td>2019-03-22 12:58:17</td>
      <td>Friday</td>
      <td>0 days 00:11:04</td>
    </tr>
    <tr>
      <th>42</th>
      <td>2019-03-30 23:59:14</td>
      <td>2019-03-30 23:59:17</td>
      <td>1</td>
      <td>0.0</td>
      <td>80.0</td>
      <td>20.08</td>
      <td>0.0</td>
      <td>100.38</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-30 23:59:14</td>
      <td>2019-03-30 23:59:17</td>
      <td>Saturday</td>
      <td>0 days 00:00:03</td>
    </tr>
    <tr>
      <th>445</th>
      <td>2019-03-19 06:57:14</td>
      <td>2019-03-19 07:00:08</td>
      <td>1</td>
      <td>1.3</td>
      <td>5.5</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>6.30</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>Boerum Hill</td>
      <td>Columbia Street</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-19 06:57:14</td>
      <td>2019-03-19 07:00:08</td>
      <td>Tuesday</td>
      <td>0 days 00:02:54</td>
    </tr>
    <tr>
      <th>491</th>
      <td>2019-03-07 07:11:33</td>
      <td>2019-03-07 07:11:39</td>
      <td>1</td>
      <td>1.6</td>
      <td>2.5</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>5.80</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>Murray Hill</td>
      <td>Murray Hill</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-07 07:11:33</td>
      <td>2019-03-07 07:11:39</td>
      <td>Thursday</td>
      <td>0 days 00:00:06</td>
    </tr>
    <tr>
      <th>545</th>
      <td>2019-03-27 11:03:43</td>
      <td>2019-03-27 11:14:34</td>
      <td>1</td>
      <td>4.2</td>
      <td>15.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>15.80</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>LaGuardia Airport</td>
      <td>Forest Hills</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-27 11:03:43</td>
      <td>2019-03-27 11:14:34</td>
      <td>Wednesday</td>
      <td>0 days 00:10:51</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6118</th>
      <td>2019-03-30 00:49:48</td>
      <td>2019-03-30 00:49:56</td>
      <td>1</td>
      <td>0.0</td>
      <td>25.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>25.50</td>
      <td>green</td>
      <td>credit card</td>
      <td>Prospect Heights</td>
      <td>NaN</td>
      <td>Brooklyn</td>
      <td>NaN</td>
      <td>2019-03-30 00:49:48</td>
      <td>2019-03-30 00:49:56</td>
      <td>Saturday</td>
      <td>0 days 00:00:08</td>
    </tr>
    <tr>
      <th>6169</th>
      <td>2019-03-27 02:11:01</td>
      <td>2019-03-27 02:12:03</td>
      <td>1</td>
      <td>4.1</td>
      <td>3.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>4.30</td>
      <td>green</td>
      <td>NaN</td>
      <td>Jackson Heights</td>
      <td>Jackson Heights</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-27 02:11:01</td>
      <td>2019-03-27 02:12:03</td>
      <td>Wednesday</td>
      <td>0 days 00:01:02</td>
    </tr>
    <tr>
      <th>6311</th>
      <td>2019-03-12 07:10:30</td>
      <td>2019-03-12 07:14:18</td>
      <td>1</td>
      <td>0.7</td>
      <td>4.5</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>5.30</td>
      <td>green</td>
      <td>NaN</td>
      <td>Long Island City/Hunters Point</td>
      <td>Long Island City/Hunters Point</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>2019-03-12 07:10:30</td>
      <td>2019-03-12 07:14:18</td>
      <td>Tuesday</td>
      <td>0 days 00:03:48</td>
    </tr>
    <tr>
      <th>6314</th>
      <td>2019-03-28 22:36:04</td>
      <td>2019-03-28 22:36:07</td>
      <td>1</td>
      <td>0.0</td>
      <td>25.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>25.00</td>
      <td>green</td>
      <td>cash</td>
      <td>Jamaica</td>
      <td>NaN</td>
      <td>Queens</td>
      <td>NaN</td>
      <td>2019-03-28 22:36:04</td>
      <td>2019-03-28 22:36:07</td>
      <td>Thursday</td>
      <td>0 days 00:00:03</td>
    </tr>
    <tr>
      <th>6356</th>
      <td>2019-03-01 16:58:23</td>
      <td>2019-03-01 16:58:23</td>
      <td>1</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>4.80</td>
      <td>green</td>
      <td>cash</td>
      <td>Stuyvesant Heights</td>
      <td>NaN</td>
      <td>Brooklyn</td>
      <td>NaN</td>
      <td>2019-03-01 16:58:23</td>
      <td>2019-03-01 16:58:23</td>
      <td>Friday</td>
      <td>0 days 00:00:00</td>
    </tr>
  </tbody>
</table>
<p>92 rows √ó 18 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Keep all rows that have no missing values</span>
<span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>picktime</th>
      <th>droptime</th>
      <th>day</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>1</td>
      <td>1.60</td>
      <td>7.0</td>
      <td>2.15</td>
      <td>0.0</td>
      <td>12.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Lenox Hill West</td>
      <td>UN/Turtle Bay South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-23 20:21:09</td>
      <td>2019-03-23 20:27:24</td>
      <td>Saturday</td>
      <td>0 days 00:06:15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>1</td>
      <td>0.79</td>
      <td>5.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>9.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>Upper West Side South</td>
      <td>Upper West Side South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-04 16:11:55</td>
      <td>2019-03-04 16:19:00</td>
      <td>Monday</td>
      <td>0 days 00:07:05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>1</td>
      <td>1.37</td>
      <td>7.5</td>
      <td>2.36</td>
      <td>0.0</td>
      <td>14.16</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Alphabet City</td>
      <td>West Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-27 17:53:01</td>
      <td>2019-03-27 18:00:25</td>
      <td>Wednesday</td>
      <td>0 days 00:07:24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>1</td>
      <td>7.70</td>
      <td>27.0</td>
      <td>6.15</td>
      <td>0.0</td>
      <td>36.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Hudson Sq</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-10 01:23:59</td>
      <td>2019-03-10 01:49:51</td>
      <td>Sunday</td>
      <td>0 days 00:25:52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>3</td>
      <td>2.16</td>
      <td>9.0</td>
      <td>1.10</td>
      <td>0.0</td>
      <td>13.40</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Midtown East</td>
      <td>Yorkville West</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-30 13:27:42</td>
      <td>2019-03-30 13:37:14</td>
      <td>Saturday</td>
      <td>0 days 00:09:32</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6428</th>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>1</td>
      <td>0.75</td>
      <td>4.5</td>
      <td>1.06</td>
      <td>0.0</td>
      <td>6.36</td>
      <td>green</td>
      <td>credit card</td>
      <td>East Harlem North</td>
      <td>Central Harlem North</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>2019-03-31 09:51:53</td>
      <td>2019-03-31 09:55:27</td>
      <td>Sunday</td>
      <td>0 days 00:03:34</td>
    </tr>
    <tr>
      <th>6429</th>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>1</td>
      <td>18.74</td>
      <td>58.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>58.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>Jamaica</td>
      <td>East Concourse/Concourse Village</td>
      <td>Queens</td>
      <td>Bronx</td>
      <td>2019-03-31 17:38:00</td>
      <td>2019-03-31 18:34:23</td>
      <td>Sunday</td>
      <td>0 days 00:56:23</td>
    </tr>
    <tr>
      <th>6430</th>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>1</td>
      <td>4.14</td>
      <td>16.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>17.30</td>
      <td>green</td>
      <td>cash</td>
      <td>Crown Heights North</td>
      <td>Bushwick North</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-23 22:55:18</td>
      <td>2019-03-23 23:14:25</td>
      <td>Saturday</td>
      <td>0 days 00:19:07</td>
    </tr>
    <tr>
      <th>6431</th>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>1</td>
      <td>1.12</td>
      <td>6.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>6.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>East New York</td>
      <td>East Flatbush/Remsen Village</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-04 10:09:25</td>
      <td>2019-03-04 10:14:29</td>
      <td>Monday</td>
      <td>0 days 00:05:04</td>
    </tr>
    <tr>
      <th>6432</th>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>1</td>
      <td>3.85</td>
      <td>15.0</td>
      <td>3.36</td>
      <td>0.0</td>
      <td>20.16</td>
      <td>green</td>
      <td>credit card</td>
      <td>Boerum Hill</td>
      <td>Windsor Terrace</td>
      <td>Brooklyn</td>
      <td>Brooklyn</td>
      <td>2019-03-13 19:31:22</td>
      <td>2019-03-13 19:48:02</td>
      <td>Wednesday</td>
      <td>0 days 00:16:40</td>
    </tr>
  </tbody>
</table>
<p>6341 rows √ó 18 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Define <code class="docutils literal notranslate"><span class="pre">df_sub</span></code> to be the sub-DataFrame containing all the rows for which the ‚Äúpickup_zone‚Äù entry is missing. Use the <code class="docutils literal notranslate"><span class="pre">isna</span></code> method.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#series where pickup_zone is missing</span>
<span class="n">bool_ser</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup_zone&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="n">bool_ser</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       False
1       False
2       False
3       False
4       False
        ...  
6428    False
6429    False
6430    False
6431    False
6432    False
Name: pickup_zone, Length: 6433, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Sanity check: every entry in pickup_zone should be missing</span>
<span class="n">df</span><span class="p">[</span><span class="n">bool_ser</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>picktime</th>
      <th>droptime</th>
      <th>day</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42</th>
      <td>2019-03-30 23:59:14</td>
      <td>2019-03-30 23:59:17</td>
      <td>1</td>
      <td>0.00</td>
      <td>80.0</td>
      <td>20.08</td>
      <td>0.00</td>
      <td>100.38</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-30 23:59:14</td>
      <td>2019-03-30 23:59:17</td>
      <td>Saturday</td>
      <td>0 days 00:00:03</td>
    </tr>
    <tr>
      <th>606</th>
      <td>2019-03-19 15:04:40</td>
      <td>2019-03-19 15:06:15</td>
      <td>1</td>
      <td>0.40</td>
      <td>3.5</td>
      <td>1.35</td>
      <td>0.00</td>
      <td>8.15</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>Upper East Side South</td>
      <td>NaN</td>
      <td>Manhattan</td>
      <td>2019-03-19 15:04:40</td>
      <td>2019-03-19 15:06:15</td>
      <td>Tuesday</td>
      <td>0 days 00:01:35</td>
    </tr>
    <tr>
      <th>622</th>
      <td>2019-03-12 19:52:36</td>
      <td>2019-03-12 19:52:55</td>
      <td>3</td>
      <td>0.00</td>
      <td>120.0</td>
      <td>33.20</td>
      <td>12.50</td>
      <td>166.00</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-12 19:52:36</td>
      <td>2019-03-12 19:52:55</td>
      <td>Tuesday</td>
      <td>0 days 00:00:19</td>
    </tr>
    <tr>
      <th>671</th>
      <td>2019-03-09 22:45:46</td>
      <td>2019-03-09 22:46:50</td>
      <td>1</td>
      <td>0.40</td>
      <td>3.5</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>7.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>NaN</td>
      <td>Lincoln Square East</td>
      <td>NaN</td>
      <td>Manhattan</td>
      <td>2019-03-09 22:45:46</td>
      <td>2019-03-09 22:46:50</td>
      <td>Saturday</td>
      <td>0 days 00:01:04</td>
    </tr>
    <tr>
      <th>712</th>
      <td>2019-03-03 01:24:45</td>
      <td>2019-03-03 01:29:32</td>
      <td>1</td>
      <td>0.80</td>
      <td>5.0</td>
      <td>1.75</td>
      <td>0.00</td>
      <td>10.55</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>West Chelsea/Hudson Yards</td>
      <td>NaN</td>
      <td>Manhattan</td>
      <td>2019-03-03 01:24:45</td>
      <td>2019-03-03 01:29:32</td>
      <td>Sunday</td>
      <td>0 days 00:04:47</td>
    </tr>
    <tr>
      <th>970</th>
      <td>2019-03-29 00:02:00</td>
      <td>2019-03-29 00:02:05</td>
      <td>2</td>
      <td>0.00</td>
      <td>45.0</td>
      <td>5.00</td>
      <td>0.00</td>
      <td>50.30</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-29 00:02:00</td>
      <td>2019-03-29 00:02:05</td>
      <td>Friday</td>
      <td>0 days 00:00:05</td>
    </tr>
    <tr>
      <th>1108</th>
      <td>2019-03-10 09:33:13</td>
      <td>2019-03-10 09:52:04</td>
      <td>1</td>
      <td>13.40</td>
      <td>52.0</td>
      <td>11.70</td>
      <td>5.76</td>
      <td>70.26</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-10 09:33:13</td>
      <td>2019-03-10 09:52:04</td>
      <td>Sunday</td>
      <td>0 days 00:18:51</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>2019-03-19 16:43:59</td>
      <td>2019-03-19 17:37:22</td>
      <td>1</td>
      <td>17.82</td>
      <td>52.0</td>
      <td>13.11</td>
      <td>5.76</td>
      <td>78.67</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>Garment District</td>
      <td>NaN</td>
      <td>Manhattan</td>
      <td>2019-03-19 16:43:59</td>
      <td>2019-03-19 17:37:22</td>
      <td>Tuesday</td>
      <td>0 days 00:53:23</td>
    </tr>
    <tr>
      <th>2137</th>
      <td>2019-03-08 13:27:32</td>
      <td>2019-03-08 13:46:23</td>
      <td>1</td>
      <td>1.40</td>
      <td>12.0</td>
      <td>3.05</td>
      <td>0.00</td>
      <td>18.35</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-08 13:27:32</td>
      <td>2019-03-08 13:46:23</td>
      <td>Friday</td>
      <td>0 days 00:18:51</td>
    </tr>
    <tr>
      <th>2742</th>
      <td>2019-03-23 06:20:27</td>
      <td>2019-03-23 06:20:59</td>
      <td>1</td>
      <td>0.00</td>
      <td>55.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>55.80</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-23 06:20:27</td>
      <td>2019-03-23 06:20:59</td>
      <td>Saturday</td>
      <td>0 days 00:00:32</td>
    </tr>
    <tr>
      <th>3085</th>
      <td>2019-03-24 15:43:02</td>
      <td>2019-03-24 16:02:57</td>
      <td>1</td>
      <td>3.20</td>
      <td>14.5</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>15.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-24 15:43:02</td>
      <td>2019-03-24 16:02:57</td>
      <td>Sunday</td>
      <td>0 days 00:19:55</td>
    </tr>
    <tr>
      <th>3259</th>
      <td>2019-03-30 00:39:09</td>
      <td>2019-03-30 00:43:34</td>
      <td>1</td>
      <td>0.84</td>
      <td>5.0</td>
      <td>1.70</td>
      <td>0.00</td>
      <td>10.50</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-30 00:39:09</td>
      <td>2019-03-30 00:43:34</td>
      <td>Saturday</td>
      <td>0 days 00:04:25</td>
    </tr>
    <tr>
      <th>3644</th>
      <td>2019-03-19 23:30:50</td>
      <td>2019-03-19 23:32:33</td>
      <td>2</td>
      <td>0.00</td>
      <td>103.0</td>
      <td>20.65</td>
      <td>0.00</td>
      <td>123.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-19 23:30:50</td>
      <td>2019-03-19 23:32:33</td>
      <td>Tuesday</td>
      <td>0 days 00:01:43</td>
    </tr>
    <tr>
      <th>3793</th>
      <td>2019-03-24 06:07:30</td>
      <td>2019-03-24 06:12:22</td>
      <td>1</td>
      <td>1.50</td>
      <td>6.5</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>9.80</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Midtown East</td>
      <td>NaN</td>
      <td>Manhattan</td>
      <td>2019-03-24 06:07:30</td>
      <td>2019-03-24 06:12:22</td>
      <td>Sunday</td>
      <td>0 days 00:04:52</td>
    </tr>
    <tr>
      <th>3889</th>
      <td>2019-03-30 06:42:55</td>
      <td>2019-03-30 06:43:00</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.5</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-30 06:42:55</td>
      <td>2019-03-30 06:43:00</td>
      <td>Saturday</td>
      <td>0 days 00:00:05</td>
    </tr>
    <tr>
      <th>4118</th>
      <td>2019-03-15 14:01:54</td>
      <td>2019-03-15 14:01:59</td>
      <td>1</td>
      <td>0.00</td>
      <td>25.0</td>
      <td>5.06</td>
      <td>0.00</td>
      <td>30.36</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-15 14:01:54</td>
      <td>2019-03-15 14:01:59</td>
      <td>Friday</td>
      <td>0 days 00:00:05</td>
    </tr>
    <tr>
      <th>4127</th>
      <td>2019-03-01 05:18:21</td>
      <td>2019-03-01 05:18:30</td>
      <td>2</td>
      <td>0.04</td>
      <td>2.5</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-01 05:18:21</td>
      <td>2019-03-01 05:18:30</td>
      <td>Friday</td>
      <td>0 days 00:00:09</td>
    </tr>
    <tr>
      <th>4281</th>
      <td>2019-03-18 23:29:49</td>
      <td>2019-03-18 23:38:00</td>
      <td>1</td>
      <td>2.10</td>
      <td>9.0</td>
      <td>2.06</td>
      <td>0.00</td>
      <td>12.36</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-18 23:29:49</td>
      <td>2019-03-18 23:38:00</td>
      <td>Monday</td>
      <td>0 days 00:08:11</td>
    </tr>
    <tr>
      <th>4414</th>
      <td>2019-03-29 20:42:47</td>
      <td>2019-03-29 21:03:50</td>
      <td>1</td>
      <td>4.20</td>
      <td>17.0</td>
      <td>4.80</td>
      <td>5.76</td>
      <td>28.86</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-29 20:42:47</td>
      <td>2019-03-29 21:03:50</td>
      <td>Friday</td>
      <td>0 days 00:21:03</td>
    </tr>
    <tr>
      <th>4772</th>
      <td>2019-03-21 19:51:13</td>
      <td>2019-03-21 19:57:03</td>
      <td>1</td>
      <td>0.72</td>
      <td>5.5</td>
      <td>1.46</td>
      <td>0.00</td>
      <td>8.76</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-21 19:51:13</td>
      <td>2019-03-21 19:57:03</td>
      <td>Thursday</td>
      <td>0 days 00:05:50</td>
    </tr>
    <tr>
      <th>4941</th>
      <td>2019-03-01 08:12:28</td>
      <td>2019-03-01 08:17:19</td>
      <td>1</td>
      <td>0.83</td>
      <td>5.0</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>10.80</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-01 08:12:28</td>
      <td>2019-03-01 08:17:19</td>
      <td>Friday</td>
      <td>0 days 00:04:51</td>
    </tr>
    <tr>
      <th>5263</th>
      <td>2019-03-09 20:37:53</td>
      <td>2019-03-09 21:07:20</td>
      <td>1</td>
      <td>4.99</td>
      <td>22.0</td>
      <td>5.16</td>
      <td>0.00</td>
      <td>30.96</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-09 20:37:53</td>
      <td>2019-03-09 21:07:20</td>
      <td>Saturday</td>
      <td>0 days 00:29:27</td>
    </tr>
    <tr>
      <th>5493</th>
      <td>2019-03-06 12:14:00</td>
      <td>2019-03-06 12:14:00</td>
      <td>1</td>
      <td>0.00</td>
      <td>10.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>10.00</td>
      <td>green</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-06 12:14:00</td>
      <td>2019-03-06 12:14:00</td>
      <td>Wednesday</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>5624</th>
      <td>2019-03-11 14:04:50</td>
      <td>2019-03-11 14:04:50</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.5</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.30</td>
      <td>green</td>
      <td>cash</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-11 14:04:50</td>
      <td>2019-03-11 14:04:50</td>
      <td>Monday</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>5638</th>
      <td>2019-03-13 12:22:00</td>
      <td>2019-03-13 12:22:00</td>
      <td>1</td>
      <td>0.00</td>
      <td>10.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>10.00</td>
      <td>green</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-13 12:22:00</td>
      <td>2019-03-13 12:22:00</td>
      <td>Wednesday</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>6083</th>
      <td>2019-03-19 15:34:00</td>
      <td>2019-03-19 15:34:00</td>
      <td>1</td>
      <td>0.00</td>
      <td>5.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>5.00</td>
      <td>green</td>
      <td>credit card</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2019-03-19 15:34:00</td>
      <td>2019-03-19 15:34:00</td>
      <td>Tuesday</td>
      <td>0 days 00:00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="more-on-missing-values">
<h2>More on missing values<a class="headerlink" href="#more-on-missing-values" title="Permalink to this headline">#</a></h2>
<p>I want to show you a little bit of a more extreme case here. In the taxis data, pandas knew how to recognize the missing values. This will not always be the case!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;sampleData.csv&quot;</span><span class="p">)</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>-2.3</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.1</td>
      <td>1.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>?</td>
      <td>5.0</td>
      <td>?</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12.3</td>
      <td>-4.0</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7</td>
      <td>2.8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>6.0</td>
      <td>?</td>
    </tr>
    <tr>
      <th>6</th>
      <td>?</td>
      <td>1.0</td>
      <td>1.8</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>-1.0</td>
      <td>3.14</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The idea here is that the question marks represent missing data, but pandas doesn‚Äôt know that! This is going to cause some very big issues. Let‚Äôs see some examples.</p>
<p>Looking at <code class="docutils literal notranslate"><span class="pre">df2</span></code>, pandas thinks that ‚ÄúA‚Äù and ‚ÄúB‚Äù represent string data‚Ä¶this comes from the fact that quesiton marks are in these columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;32.1?12.375?2&#39;
</pre></div>
</div>
</div>
</div>
<p>This is an example of string concatenation. It takes strings and puts them together.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;15&quot;</span> <span class="o">+</span> <span class="s2">&quot;16&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;1516&#39;
</pre></div>
</div>
</div>
</div>
<p>Because pandas does not recognize ‚ÄúA‚Äù and ‚ÄúC‚Äù as numeric columns, we also lose information from <code class="docutils literal notranslate"><span class="pre">describe()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.062500</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3.466137</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-4.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-1.325000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.350000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>6.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Missing values are often handled automatically by pandas, but here‚Äôs how we can do it by hand, as we would need to in this case:</p>
<p>In this example, no rows are removed. We just replace all ‚Äú?‚Äù with <code class="docutils literal notranslate"><span class="pre">nan</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;sampleData.csv&quot;</span><span class="p">,</span><span class="n">na_values</span><span class="o">=</span><span class="s2">&quot;?&quot;</span><span class="p">)</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>-2.3</td>
      <td>-1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.1</td>
      <td>1.0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12.3</td>
      <td>-4.0</td>
      <td>4.10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7.0</td>
      <td>2.8</td>
      <td>3.00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5.0</td>
      <td>6.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.80</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2.0</td>
      <td>-1.0</td>
      <td>3.14</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>-2.3</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.1</td>
      <td>1.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>?</td>
      <td>5.0</td>
      <td>?</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12.3</td>
      <td>-4.0</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7</td>
      <td>2.8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>6.0</td>
      <td>?</td>
    </tr>
    <tr>
      <th>6</th>
      <td>?</td>
      <td>1.0</td>
      <td>1.8</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>-1.0</td>
      <td>3.14</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice! ‚ÄúA‚Äù and ‚ÄúC‚Äù are now recognized as columns with floating point numbers! <code class="docutils literal notranslate"><span class="pre">.sum()</span></code> and <code class="docutils literal notranslate"><span class="pre">.describe()</span></code> would work how we expect now.</p>
<p>How could I access the value <code class="docutils literal notranslate"><span class="pre">nan</span></code> directly?</p>
<p>By itself, I‚Äôll get an error</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [48],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">nan</span>

<span class="ne">NameError</span>: name &#39;nan&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nan
</pre></div>
</div>
</div>
</div>
<p>Warning: We never want to check for equality with <code class="docutils literal notranslate"><span class="pre">np.nan</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1    False
2     True
3    False
4    False
5    False
6     True
7    False
Name: A, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>float
</pre></div>
</div>
</div>
</div>
<p>Takeaway: Sometimes when you get errors involving floats, it‚Äôs really an error about missing values.</p>
</section>
<section id="getting-integer-locations-of-columns">
<h2>Getting integer locations of columns<a class="headerlink" href="#getting-integer-locations-of-columns" title="Permalink to this headline">#</a></h2>
<p>You might recall from an earlier part of lecture I wanted the integer-position of the ‚Äúpickup_borough‚Äù column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">taxis</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;taxis.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">taxis</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;pickup&#39;, &#39;dropoff&#39;, &#39;passengers&#39;, &#39;distance&#39;, &#39;fare&#39;, &#39;tip&#39;, &#39;tolls&#39;,
       &#39;total&#39;, &#39;color&#39;, &#39;payment&#39;, &#39;pickup_zone&#39;, &#39;dropoff_zone&#39;,
       &#39;pickup_borough&#39;, &#39;dropoff_borough&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Then, all I did was count from 0 to the pickup_borough column. You can imagine if I had hundreds of columns this method would be very sad :(</p>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">index</span></code> method of a <code class="docutils literal notranslate"><span class="pre">list</span></code> object</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#This data type is not so important for Math 10</span>
<span class="nb">type</span><span class="p">(</span><span class="n">taxis</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.indexes.base.Index
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mylist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">taxis</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">mylist</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;pickup&#39;,
 &#39;dropoff&#39;,
 &#39;passengers&#39;,
 &#39;distance&#39;,
 &#39;fare&#39;,
 &#39;tip&#39;,
 &#39;tolls&#39;,
 &#39;total&#39;,
 &#39;color&#39;,
 &#39;payment&#39;,
 &#39;pickup_zone&#39;,
 &#39;dropoff_zone&#39;,
 &#39;pickup_borough&#39;,
 &#39;dropoff_borough&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">mylist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>list
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mylist</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;pickup_borough&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Get a boolean array and then use <code class="docutils literal notranslate"><span class="pre">np.nonzero</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">taxis</span><span class="o">.</span><span class="n">columns</span> <span class="o">==</span> <span class="s2">&quot;pickup_borough&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([False, False, False, False, False, False, False, False, False,
       False, False, False,  True, False])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#This returns a tuple</span>
<span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">taxis</span><span class="o">.</span><span class="n">columns</span> <span class="o">==</span> <span class="s2">&quot;pickup_borough&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([12]),)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">taxis</span><span class="o">.</span><span class="n">columns</span> <span class="o">==</span> <span class="s2">&quot;pickup_borough&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([12])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">taxis</span><span class="o">.</span><span class="n">columns</span> <span class="o">==</span> <span class="s2">&quot;pickup_borough&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">taxis</span><span class="o">.</span><span class="n">columns</span> <span class="o">==</span> <span class="s2">&quot;pickup_borough&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([12]),)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">taxis</span><span class="o">.</span><span class="n">columns</span> <span class="o">==</span> <span class="s2">&quot;pickup_borough&quot;</span><span class="p">,</span><span class="s2">&quot;Yasmeen&quot;</span><span class="p">,</span><span class="s2">&quot;Anthony&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Anthony&#39;, &#39;Anthony&#39;, &#39;Anthony&#39;, &#39;Anthony&#39;, &#39;Anthony&#39;, &#39;Anthony&#39;,
       &#39;Anthony&#39;, &#39;Anthony&#39;, &#39;Anthony&#39;, &#39;Anthony&#39;, &#39;Anthony&#39;, &#39;Anthony&#39;,
       &#39;Yasmeen&#39;, &#39;Anthony&#39;], dtype=&#39;&lt;U7&#39;)
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p><font color = blue> This is where we got to in the lecture. To keep on schedule, I‚Äôll have Anthony go over this remaining material in discussion on Wednesday. </font></p>
<ul class="simple">
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">get_loc</span></code> method of a pandas <code class="docutils literal notranslate"><span class="pre">Index</span></code> object (credit: Bing chat)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s2">&quot;pickup_borough&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">get_indexer</span></code> method of a pandas <code class="docutils literal notranslate"><span class="pre">Index</span></code> object (credit: Bing chat)</p></li>
</ul>
<p>This method is very similar to <code class="docutils literal notranslate"><span class="pre">get_loc</span></code>, but has the additional functionality of being able to get the indices of multiple columns at once. If we wanted to do this with the other methods, it would be a lot more complicated and difficult.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_indexer</span><span class="p">([</span><span class="s2">&quot;pickup_borough&quot;</span><span class="p">,</span><span class="s2">&quot;dropoff_zone&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([12, 11])
</pre></div>
</div>
</div>
</div>
</section>
<section id="shuffling-and-sampling-data">
<h2>Shuffling and sampling data<a class="headerlink" href="#shuffling-and-sampling-data" title="Permalink to this headline">#</a></h2>
<p>In the next section of the notes, I want to still use the taxis data, but have the rows shuffled so that the row labels don‚Äôt necessarily match their integer positions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;taxis.csv&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the above code <code class="docutils literal notranslate"><span class="pre">frac</span></code> tells us what portion of the data to keep. In this case, we keep 10%. The argument <code class="docutils literal notranslate"><span class="pre">random_state</span></code> is functionally very similar to seeded random numbers in NumPy. It‚Äôs what allows us to get reproducible results. The <code class="docutils literal notranslate"><span class="pre">df</span></code> that results on your end should be the same as what‚Äôs displayed here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>890</th>
      <td>2019-03-09 16:32:40</td>
      <td>2019-03-09 16:49:32</td>
      <td>2</td>
      <td>2.70</td>
      <td>13.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>16.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>Midtown North</td>
      <td>Kips Bay</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>5870</th>
      <td>2019-03-26 11:04:06</td>
      <td>2019-03-26 11:09:23</td>
      <td>1</td>
      <td>0.64</td>
      <td>5.5</td>
      <td>1.26</td>
      <td>0.0</td>
      <td>7.56</td>
      <td>green</td>
      <td>credit card</td>
      <td>Morningside Heights</td>
      <td>Manhattanville</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>686</th>
      <td>2019-03-27 15:02:00</td>
      <td>2019-03-27 15:31:19</td>
      <td>1</td>
      <td>3.79</td>
      <td>20.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>23.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>East Chelsea</td>
      <td>Manhattan Valley</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>4937</th>
      <td>2019-03-02 19:50:23</td>
      <td>2019-03-02 20:04:19</td>
      <td>2</td>
      <td>1.60</td>
      <td>10.0</td>
      <td>2.75</td>
      <td>0.0</td>
      <td>16.55</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>TriBeCa/Civic Center</td>
      <td>East Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>2659</th>
      <td>2019-03-18 21:36:06</td>
      <td>2019-03-18 21:48:31</td>
      <td>1</td>
      <td>1.10</td>
      <td>8.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>11.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>Midtown North</td>
      <td>Midtown North</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice that rows in integer positions 0,1, and 2 correspond to labels 890,5870, and 686.</p>
<p>I know that the original DataFrame has 6433 rows. Let‚Äôs check and see if we really got 10% of the rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(643, 14)
</pre></div>
</div>
</div>
</div>
<p>This looks good! We have 10% of the rows.</p>
<p>For the next portion of the notes, I want to keep the full dataset, just with the rows shuffled. I‚Äôll specify a <code class="docutils literal notranslate"><span class="pre">frac=1</span></code>, in this case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;taxis.csv&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Checking the shape, we see that we really do have the entire dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(6433, 14)
</pre></div>
</div>
</div>
</div>
</section>
<section id="strings-in-pandas-revisited-worse-approach-1-iloc-and-for-loops">
<h2>Strings in pandas revisited: Worse approach 1 (<code class="docutils literal notranslate"><span class="pre">iloc</span></code> and for-loops)<a class="headerlink" href="#strings-in-pandas-revisited-worse-approach-1-iloc-and-for-loops" title="Permalink to this headline">#</a></h2>
<p>Question from earlier in the lecture:</p>
<ul class="simple">
<li><p><em>How many rows in <code class="docutils literal notranslate"><span class="pre">df</span></code> have the word ‚ÄúAirport‚Äù in either the ‚Äúpickup_zone‚Äù column or the ‚Äúdropoff_zone‚Äù column. Do any of the rows have the word ‚ÄúAirport‚Äù in both columns?</em></p></li>
</ul>
<p>The solution that we wrote together earlier really is one of the best ways I know how to solve this problem. The point of this section of the notes is to get some practice with indexing and for-loops.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6433
</pre></div>
</div>
</div>
</div>
<p>The logic of the following attemp is good, but we‚Äôll run into an error‚Ä¶</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_inds</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1">#there&#39;s almost always a better way of iterating</span>
<span class="c1">#than range(len(...))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)):</span>
    <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;Airport&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;Airport&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">11</span><span class="p">]):</span>
        <span class="n">good_inds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [75],</span> in <span class="ni">&lt;cell line: 5&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1">#there&#39;s almost always a better way of iterating</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1">#than range(len(...))</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)):</span>
<span class="ne">----&gt; </span><span class="mi">6</span>     <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;Airport&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;Airport&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">11</span><span class="p">]):</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>         <span class="n">good_inds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="ne">TypeError</span>: argument of type &#39;float&#39; is not iterable
</pre></div>
</div>
</div>
</div>
<p>Would you believe that this is an issue with missing values? Hint: What‚Äôs the datatype of <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#does this example convince you?</span>
<span class="s2">&quot;Airport&quot;</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [76],</span> in <span class="ni">&lt;cell line: 2&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">#does this example convince you?</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="s2">&quot;Airport&quot;</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="ne">TypeError</span>: argument of type &#39;float&#39; is not iterable
</pre></div>
</div>
</div>
</div>
<p>The way we can get around this is by using a ‚Äútry-except‚Äù block:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_inds</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1">#there&#39;s almost always a better way of iterating</span>
<span class="c1">#than range(len(...))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;Airport&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;Airport&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">11</span><span class="p">]):</span>
            <span class="n">good_inds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="c1">#go to the next step of the for-loop without breaking</span>
        <span class="k">continue</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_inds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[517, 642, 1117, 1239, 1461, 2032, 3576, 3971, 4970, 5417, 5773]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">good_inds</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2387</th>
      <td>2019-03-28 15:58:52</td>
      <td>2019-03-28 15:59:25</td>
      <td>1</td>
      <td>1.80</td>
      <td>69.06</td>
      <td>20.80</td>
      <td>0.00</td>
      <td>90.16</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>1080</th>
      <td>2019-03-04 14:17:05</td>
      <td>2019-03-04 14:17:13</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>120</th>
      <td>2019-03-21 17:21:44</td>
      <td>2019-03-21 17:21:49</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>5364</th>
      <td>2019-03-17 16:59:17</td>
      <td>2019-03-17 18:04:08</td>
      <td>2</td>
      <td>36.70</td>
      <td>150.00</td>
      <td>0.00</td>
      <td>24.02</td>
      <td>174.82</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>1929</th>
      <td>2019-03-13 22:35:35</td>
      <td>2019-03-13 22:35:49</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.80</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>3571</th>
      <td>2019-03-22 16:47:41</td>
      <td>2019-03-22 16:47:50</td>
      <td>1</td>
      <td>0.81</td>
      <td>66.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>66.80</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>1416</th>
      <td>2019-03-09 13:16:32</td>
      <td>2019-03-09 13:46:11</td>
      <td>2</td>
      <td>12.39</td>
      <td>35.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>35.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>LaGuardia Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>4358</th>
      <td>2019-03-06 18:24:00</td>
      <td>2019-03-06 18:24:13</td>
      <td>2</td>
      <td>0.01</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>1089</th>
      <td>2019-03-10 01:43:32</td>
      <td>2019-03-10 01:45:22</td>
      <td>1</td>
      <td>0.37</td>
      <td>3.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>5095</th>
      <td>2019-03-30 20:14:44</td>
      <td>2019-03-30 21:01:28</td>
      <td>3</td>
      <td>18.91</td>
      <td>52.00</td>
      <td>8.78</td>
      <td>5.76</td>
      <td>67.34</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>770</th>
      <td>2019-03-02 03:16:59</td>
      <td>2019-03-02 03:17:06</td>
      <td>0</td>
      <td>9.40</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.80</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#this gives an error because pandas is looking for columns with these names</span>
<span class="n">df</span><span class="p">[</span><span class="n">good_inds</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">Input In [80],</span> in <span class="ni">&lt;cell line: 2&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">#this gives an error because pandas is looking for columns with these names</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">df</span><span class="p">[</span><span class="n">good_inds</span><span class="p">]</span>

<span class="nn">File ~/opt/miniconda3/envs/math9/lib/python3.9/site-packages/pandas/core/frame.py:3511,</span> in <span class="ni">DataFrame.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">3509</span>     <span class="k">if</span> <span class="n">is_iterator</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">3510</span>         <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3511</span>     <span class="n">indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">_get_indexer_strict</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;columns&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">3513</span> <span class="c1"># take() does not accept boolean indexers</span>
<span class="g g-Whitespace">   </span><span class="mi">3514</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="s2">&quot;dtype&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>

<span class="nn">File ~/opt/miniconda3/envs/math9/lib/python3.9/site-packages/pandas/core/indexes/base.py:5796,</span> in <span class="ni">Index._get_indexer_strict</span><span class="nt">(self, key, axis_name)</span>
<span class="g g-Whitespace">   </span><span class="mi">5793</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">5794</span>     <span class="n">keyarr</span><span class="p">,</span> <span class="n">indexer</span><span class="p">,</span> <span class="n">new_indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reindex_non_unique</span><span class="p">(</span><span class="n">keyarr</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">5796</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raise_if_missing</span><span class="p">(</span><span class="n">keyarr</span><span class="p">,</span> <span class="n">indexer</span><span class="p">,</span> <span class="n">axis_name</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5798</span> <span class="n">keyarr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">indexer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5799</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">Index</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">5800</span>     <span class="c1"># GH 42790 - Preserve name from an Index</span>

<span class="nn">File ~/opt/miniconda3/envs/math9/lib/python3.9/site-packages/pandas/core/indexes/base.py:5856,</span> in <span class="ni">Index._raise_if_missing</span><span class="nt">(self, key, indexer, axis_name)</span>
<span class="g g-Whitespace">   </span><span class="mi">5854</span>     <span class="k">if</span> <span class="n">use_interval_msg</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">5855</span>         <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">5856</span>     <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;None of [</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">] are in the [</span><span class="si">{</span><span class="n">axis_name</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5858</span> <span class="n">not_found</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ensure_index</span><span class="p">(</span><span class="n">key</span><span class="p">)[</span><span class="n">missing_mask</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="g g-Whitespace">   </span><span class="mi">5859</span> <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">not_found</span><span class="si">}</span><span class="s2"> not in index&quot;</span><span class="p">)</span>

<span class="ne">KeyError</span>: &quot;None of [Int64Index([517, 642, 1117, 1239, 1461, 2032, 3576, 3971, 4970, 5417, 5773], dtype=&#39;int64&#39;)] are in the [columns]&quot;
</pre></div>
</div>
</div>
</div>
</section>
<section id="strings-in-pandas-revisited-worse-approach-2-loc-and-for-loops">
<h2>Strings in pandas revisited: Worse approach 2 (loc and for-loops)<a class="headerlink" href="#strings-in-pandas-revisited-worse-approach-2-loc-and-for-loops" title="Permalink to this headline">#</a></h2>
<p>In this section of the notes, we‚Äôll be solving the same problem as before, but now in a slightly different way.</p>
<p>This method will require that we check that no indices are repeated in <code class="docutils literal notranslate"><span class="pre">df</span></code>. This typically is already true, but it‚Äôs not a requirement of DataFrames.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#attribute that holds the LHS #s</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Int64Index([890, 5870, 686, 4937, 2659], dtype=&#39;int64&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>890</th>
      <td>2019-03-09 16:32:40</td>
      <td>2019-03-09 16:49:32</td>
      <td>2</td>
      <td>2.70</td>
      <td>13.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>16.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>Midtown North</td>
      <td>Kips Bay</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>5870</th>
      <td>2019-03-26 11:04:06</td>
      <td>2019-03-26 11:09:23</td>
      <td>1</td>
      <td>0.64</td>
      <td>5.5</td>
      <td>1.26</td>
      <td>0.0</td>
      <td>7.56</td>
      <td>green</td>
      <td>credit card</td>
      <td>Morningside Heights</td>
      <td>Manhattanville</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>686</th>
      <td>2019-03-27 15:02:00</td>
      <td>2019-03-27 15:31:19</td>
      <td>1</td>
      <td>3.79</td>
      <td>20.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>23.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>East Chelsea</td>
      <td>Manhattan Valley</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>4937</th>
      <td>2019-03-02 19:50:23</td>
      <td>2019-03-02 20:04:19</td>
      <td>2</td>
      <td>1.60</td>
      <td>10.0</td>
      <td>2.75</td>
      <td>0.0</td>
      <td>16.55</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>TriBeCa/Civic Center</td>
      <td>East Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>2659</th>
      <td>2019-03-18 21:36:06</td>
      <td>2019-03-18 21:48:31</td>
      <td>1</td>
      <td>1.10</td>
      <td>8.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>11.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>Midtown North</td>
      <td>Midtown North</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#checks if two rows have the same name </span>
<span class="c1">#returns true if there are no repeats</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_unique</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_inds</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;Airport&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s2">&quot;pickup_zone&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;Airport&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s2">&quot;dropoff_zone&quot;</span><span class="p">]):</span>
            <span class="n">good_inds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">continue</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_inds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2387, 1080, 120, 5364, 1929, 3571, 1416, 4358, 1089, 5095, 770]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">good_inds</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2387</th>
      <td>2019-03-28 15:58:52</td>
      <td>2019-03-28 15:59:25</td>
      <td>1</td>
      <td>1.80</td>
      <td>69.06</td>
      <td>20.80</td>
      <td>0.00</td>
      <td>90.16</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>1080</th>
      <td>2019-03-04 14:17:05</td>
      <td>2019-03-04 14:17:13</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>120</th>
      <td>2019-03-21 17:21:44</td>
      <td>2019-03-21 17:21:49</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>5364</th>
      <td>2019-03-17 16:59:17</td>
      <td>2019-03-17 18:04:08</td>
      <td>2</td>
      <td>36.70</td>
      <td>150.00</td>
      <td>0.00</td>
      <td>24.02</td>
      <td>174.82</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>1929</th>
      <td>2019-03-13 22:35:35</td>
      <td>2019-03-13 22:35:49</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.80</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>3571</th>
      <td>2019-03-22 16:47:41</td>
      <td>2019-03-22 16:47:50</td>
      <td>1</td>
      <td>0.81</td>
      <td>66.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>66.80</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>1416</th>
      <td>2019-03-09 13:16:32</td>
      <td>2019-03-09 13:46:11</td>
      <td>2</td>
      <td>12.39</td>
      <td>35.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>35.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>LaGuardia Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>4358</th>
      <td>2019-03-06 18:24:00</td>
      <td>2019-03-06 18:24:13</td>
      <td>2</td>
      <td>0.01</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>1089</th>
      <td>2019-03-10 01:43:32</td>
      <td>2019-03-10 01:45:22</td>
      <td>1</td>
      <td>0.37</td>
      <td>3.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>5095</th>
      <td>2019-03-30 20:14:44</td>
      <td>2019-03-30 21:01:28</td>
      <td>3</td>
      <td>18.91</td>
      <td>52.00</td>
      <td>8.78</td>
      <td>5.76</td>
      <td>67.34</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>770</th>
      <td>2019-03-02 03:16:59</td>
      <td>2019-03-02 03:17:06</td>
      <td>0</td>
      <td>9.40</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.80</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="strings-in-pandas-revisited-worse-approach-3-helper-function-and-map">
<h2>Strings in pandas revisited: Worse approach 3 (helper function and <code class="docutils literal notranslate"><span class="pre">map</span></code>)<a class="headerlink" href="#strings-in-pandas-revisited-worse-approach-3-helper-function-and-map" title="Permalink to this headline">#</a></h2>
<p>We start now by writing a helper function which checks if the word ‚ÄúAirport‚Äù is contained in a given string.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">has_airport</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;Airport&quot;</span> <span class="ow">in</span> <span class="n">s</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">has_airport</span><span class="p">(</span><span class="s2">&quot;Math 10&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">has_airport</span><span class="p">(</span><span class="s2">&quot;Los Angeles International Airport&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Let‚Äôs now define <code class="docutils literal notranslate"><span class="pre">ser1</span></code> and <code class="docutils literal notranslate"><span class="pre">ser2</span></code> to be the Series that we‚Äôre looking at:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ser1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup_zone&quot;</span><span class="p">]</span>
<span class="n">ser2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;dropoff_zone&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#how does map work?</span>
<span class="n">help</span><span class="p">(</span><span class="n">ser1</span><span class="o">.</span><span class="n">map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on method map in module pandas.core.series:

map(arg, na_action=None) -&gt; &#39;Series&#39; method of pandas.core.series.Series instance
    Map values of Series according to an input mapping or function.
    
    Used for substituting each value in a Series with another value,
    that may be derived from a function, a ``dict`` or
    a :class:`Series`.
    
    Parameters
    ----------
    arg : function, collections.abc.Mapping subclass or Series
        Mapping correspondence.
    na_action : {None, &#39;ignore&#39;}, default None
        If &#39;ignore&#39;, propagate NaN values, without passing them to the
        mapping correspondence.
    
    Returns
    -------
    Series
        Same index as caller.
    
    See Also
    --------
    Series.apply : For applying more complex functions on a Series.
    DataFrame.apply : Apply a function row-/column-wise.
    DataFrame.applymap : Apply a function elementwise on a whole DataFrame.
    
    Notes
    -----
    When ``arg`` is a dictionary, values in Series that are not in the
    dictionary (as keys) are converted to ``NaN``. However, if the
    dictionary is a ``dict`` subclass that defines ``__missing__`` (i.e.
    provides a method for default values), then this default is used
    rather than ``NaN``.
    
    Examples
    --------
    &gt;&gt;&gt; s = pd.Series([&#39;cat&#39;, &#39;dog&#39;, np.nan, &#39;rabbit&#39;])
    &gt;&gt;&gt; s
    0      cat
    1      dog
    2      NaN
    3   rabbit
    dtype: object
    
    ``map`` accepts a ``dict`` or a ``Series``. Values that are not found
    in the ``dict`` are converted to ``NaN``, unless the dict has a default
    value (e.g. ``defaultdict``):
    
    &gt;&gt;&gt; s.map({&#39;cat&#39;: &#39;kitten&#39;, &#39;dog&#39;: &#39;puppy&#39;})
    0   kitten
    1    puppy
    2      NaN
    3      NaN
    dtype: object
    
    It also accepts a function:
    
    &gt;&gt;&gt; s.map(&#39;I am a {}&#39;.format)
    0       I am a cat
    1       I am a dog
    2       I am a nan
    3    I am a rabbit
    dtype: object
    
    To avoid applying the function to missing values (and keep them as
    ``NaN``) ``na_action=&#39;ignore&#39;`` can be used:
    
    &gt;&gt;&gt; s.map(&#39;I am a {}&#39;.format, na_action=&#39;ignore&#39;)
    0     I am a cat
    1     I am a dog
    2            NaN
    3  I am a rabbit
    dtype: object
</pre></div>
</div>
</div>
</div>
<p>Notice, we‚Äôll still get an error because of the missing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ser1</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">has_airport</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [92],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">ser1</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">has_airport</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/envs/math9/lib/python3.9/site-packages/pandas/core/series.py:4237,</span> in <span class="ni">Series.map</span><span class="nt">(self, arg, na_action)</span>
<span class="g g-Whitespace">   </span><span class="mi">4162</span> <span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">na_action</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Series</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4163</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">4164</span><span class="sd">     Map values of Series according to an input mapping or function.</span>
<span class="g g-Whitespace">   </span><span class="mi">4165</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">4235</span><span class="sd">     dtype: object</span>
<span class="g g-Whitespace">   </span><span class="mi">4236</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">4237</span>     <span class="n">new_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_values</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">na_action</span><span class="o">=</span><span class="n">na_action</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4238</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constructor</span><span class="p">(</span><span class="n">new_values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">__finalize__</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">4239</span>         <span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;map&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">4240</span>     <span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/envs/math9/lib/python3.9/site-packages/pandas/core/base.py:880,</span> in <span class="ni">IndexOpsMixin._map_values</span><span class="nt">(self, mapper, na_action)</span>
<span class="g g-Whitespace">    </span><span class="mi">877</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">879</span> <span class="c1"># mapper is a function</span>
<span class="ne">--&gt; </span><span class="mi">880</span> <span class="n">new_values</span> <span class="o">=</span> <span class="n">map_f</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">mapper</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">882</span> <span class="k">return</span> <span class="n">new_values</span>

<span class="nn">File ~/opt/miniconda3/envs/math9/lib/python3.9/site-packages/pandas/_libs/lib.pyx:2870,</span> in <span class="ni">pandas._libs.lib.map_infer</span><span class="nt">()</span>

<span class="nn">Input In [87],</span> in <span class="ni">has_airport</span><span class="nt">(s)</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="k">def</span> <span class="nf">has_airport</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="ne">----&gt; </span><span class="mi">2</span>     <span class="k">return</span> <span class="s2">&quot;Airport&quot;</span> <span class="ow">in</span> <span class="n">s</span>

<span class="ne">TypeError</span>: argument of type &#39;float&#39; is not iterable
</pre></div>
</div>
</div>
</div>
<p>Here‚Äôs how we can fix it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#we see a lot of False, but that&#39;s just because we&#39;re</span>
<span class="c1">#looking at the first and last portions of the data</span>
<span class="n">ser1</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">has_airport</span><span class="p">,</span><span class="n">na_action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>890     False
5870    False
686     False
4937    False
2659    False
        ...  
1180    False
3441    False
1344    False
4623    False
1289    False
Name: pickup_zone, Length: 6433, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Putting everything together</span>
<span class="n">df</span><span class="p">[</span><span class="n">ser1</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">has_airport</span><span class="p">,</span><span class="n">na_action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">ser2</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">has_airport</span><span class="p">,</span><span class="n">na_action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2387</th>
      <td>2019-03-28 15:58:52</td>
      <td>2019-03-28 15:59:25</td>
      <td>1</td>
      <td>1.80</td>
      <td>69.06</td>
      <td>20.80</td>
      <td>0.00</td>
      <td>90.16</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>1080</th>
      <td>2019-03-04 14:17:05</td>
      <td>2019-03-04 14:17:13</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>120</th>
      <td>2019-03-21 17:21:44</td>
      <td>2019-03-21 17:21:49</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>5364</th>
      <td>2019-03-17 16:59:17</td>
      <td>2019-03-17 18:04:08</td>
      <td>2</td>
      <td>36.70</td>
      <td>150.00</td>
      <td>0.00</td>
      <td>24.02</td>
      <td>174.82</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>1929</th>
      <td>2019-03-13 22:35:35</td>
      <td>2019-03-13 22:35:49</td>
      <td>1</td>
      <td>0.00</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.80</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>3571</th>
      <td>2019-03-22 16:47:41</td>
      <td>2019-03-22 16:47:50</td>
      <td>1</td>
      <td>0.81</td>
      <td>66.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>66.80</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>1416</th>
      <td>2019-03-09 13:16:32</td>
      <td>2019-03-09 13:46:11</td>
      <td>2</td>
      <td>12.39</td>
      <td>35.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>35.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>LaGuardia Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>4358</th>
      <td>2019-03-06 18:24:00</td>
      <td>2019-03-06 18:24:13</td>
      <td>2</td>
      <td>0.01</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.30</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>1089</th>
      <td>2019-03-10 01:43:32</td>
      <td>2019-03-10 01:45:22</td>
      <td>1</td>
      <td>0.37</td>
      <td>3.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>5095</th>
      <td>2019-03-30 20:14:44</td>
      <td>2019-03-30 21:01:28</td>
      <td>3</td>
      <td>18.91</td>
      <td>52.00</td>
      <td>8.78</td>
      <td>5.76</td>
      <td>67.34</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
    <tr>
      <th>770</th>
      <td>2019-03-02 03:16:59</td>
      <td>2019-03-02 03:17:06</td>
      <td>0</td>
      <td>9.40</td>
      <td>2.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>3.80</td>
      <td>yellow</td>
      <td>NaN</td>
      <td>JFK Airport</td>
      <td>JFK Airport</td>
      <td>Queens</td>
      <td>Queens</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<a style='text-decoration:none;line-height:16px;display:flex;color:#5B5B62;padding:10px;justify-content:end;' href='https://deepnote.com?utm_source=created-in-deepnote-cell&projectId=4aec107f-5338-46c0-b0c8-0121a9a2432a' target="_blank">
<img alt='Created in deepnote.com' style='display:inline;max-height:16px;margin:0px;margin-right:7.5px;' src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgODAgODAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkxhbmRpbmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyMzUuMDAwMDAwLCAtNzkuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjM1LjAwMDAwMCwgNzkuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0yMCIgZmlsbD0iIzAyNjVCNCIgcG9pbnRzPSIyLjM3NjIzNzYyIDgwIDM4LjA0NzY2NjcgODAgNTcuODIxNzgyMiA3My44MDU3NTkyIDU3LjgyMTc4MjIgMzIuNzU5MjczOSAzOS4xNDAyMjc4IDMxLjY4MzE2ODMiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNS4wMDc3MTgsODAgQzQyLjkwNjIwMDcsNzYuNDU0OTM1OCA0Ny41NjQ5MTY3LDcxLjU0MjI2NzEgNDguOTgzODY2LDY1LjI2MTk5MzkgQzUxLjExMjI4OTksNTUuODQxNTg0MiA0MS42NzcxNzk1LDQ5LjIxMjIyODQgMjUuNjIzOTg0Niw0OS4yMTIyMjg0IEMyNS40ODQ5Mjg5LDQ5LjEyNjg0NDggMjkuODI2MTI5Niw0My4yODM4MjQ4IDM4LjY0NzU4NjksMzEuNjgzMTY4MyBMNzIuODcxMjg3MSwzMi41NTQ0MjUgTDY1LjI4MDk3Myw2Ny42NzYzNDIxIEw1MS4xMTIyODk5LDc3LjM3NjE0NCBMMzUuMDA3NzE4LDgwIFoiIGlkPSJQYXRoLTIyIiBmaWxsPSIjMDAyODY4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMCwzNy43MzA0NDA1IEwyNy4xMTQ1MzcsMC4yNTcxMTE0MzYgQzYyLjM3MTUxMjMsLTEuOTkwNzE3MDEgODAsMTAuNTAwMzkyNyA4MCwzNy43MzA0NDA1IEM4MCw2NC45NjA0ODgyIDY0Ljc3NjUwMzgsNzkuMDUwMzQxNCAzNC4zMjk1MTEzLDgwIEM0Ny4wNTUzNDg5LDc3LjU2NzA4MDggNTMuNDE4MjY3Nyw3MC4zMTM2MTAzIDUzLjQxODI2NzcsNTguMjM5NTg4NSBDNTMuNDE4MjY3Nyw0MC4xMjg1NTU3IDM2LjMwMzk1NDQsMzcuNzMwNDQwNSAyNS4yMjc0MTcsMzcuNzMwNDQwNSBDMTcuODQzMDU4NiwzNy43MzA0NDA1IDkuNDMzOTE5NjYsMzcuNzMwNDQwNSAwLDM3LjczMDQ0MDUgWiIgaWQ9IlBhdGgtMTkiIGZpbGw9IiMzNzkzRUYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+' > </img>
Created in <span style='font-weight:600;margin-left:4px;'>Deepnote</span></a></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../w2vid.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Week 2 Lecture Videos</p>
      </div>
    </a>
    <a class="right-next"
       href="lec5.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lecture 5: August 16th, 2023</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-dates-in-pandas">Working with dates in pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-recap-of-last-lecture">Quick recap of last lecture</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#new-material">New material</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-strings-in-pandas">Working with strings in pandas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-missing-values-in-pandas">Working with missing values in pandas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-on-missing-values">More on missing values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-integer-locations-of-columns">Getting integer locations of columns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shuffling-and-sampling-data">Shuffling and sampling data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strings-in-pandas-revisited-worse-approach-1-iloc-and-for-loops">Strings in pandas revisited: Worse approach 1 (<code class="docutils literal notranslate"><span class="pre">iloc</span></code> and for-loops)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strings-in-pandas-revisited-worse-approach-2-loc-and-for-loops">Strings in pandas revisited: Worse approach 2 (loc and for-loops)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strings-in-pandas-revisited-worse-approach-3-helper-function-and-map">Strings in pandas revisited: Worse approach 3 (helper function and <code class="docutils literal notranslate"><span class="pre">map</span></code>)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Christopher Davis and Yasmeen Baki
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      ¬© Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>