

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Lecture 10: August 28th, 2023 &#8212; Math 10, Summer Session II 2023</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/lec10';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lecture 11: August 30th, 2023" href="lec11.html" />
    <link rel="prev" title="Lecture 9: August 25th, 2023" href="lec9.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/anteater.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/anteater.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    UC Irvine, Math 10, Summer 2023
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w1vid.html">Week 1 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec1.html">Lecture 1: August 7th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../worksheets/wkst1.html">Discussion 1: August 7th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec2.html">Lecture 2: August 9th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../worksheets/wkst2.html">Discussion 2: August 9th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec3.html">Lecture 3: August 11th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w2vid.html">Week 2 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec4.html">Lecture 4: August 14th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec5.html">Lecture 5: August 16th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec6.html">Lecture 6: August 18th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w3vid.html">Week 3 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec7.html">Lecture 7: August 21st, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec8.html">Lecture 8: August 23nd, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec9.html">Lecture 9: August 25th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lecture 10: August 28th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec11.html">Lecture 11: August 30th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec12.html">Lecture 12: September 1st, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w5vid.html">Week 5 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec13.html">Lecture 13: September 6th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec14.html">Lecture 14: September 8th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Final Project</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../final/final.html">🎉 Final Project Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final/extra.html">Possible Extra Topics</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ybaki97/Math10-SSI23" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ybaki97/Math10-SSI23/issues/new?title=Issue%20on%20page%20%2Flectures/lec10.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lectures/lec10.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lecture 10: August 28th, 2023</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#last-time">Last Time</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-linear-regression-coefficients">Interpreting Linear Regression Coefficients</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-and-examples-so-far">Recap and Examples So Far</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spotify-data">Spotify Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-mpg-dataset">The mpg dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-the-linear-regression-model-work">How does the linear regression model work?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-coefficients-by-hand">Computing the coefficients by hand</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lecture-10-august-28th-2023">
<h1>Lecture 10: August 28th, 2023<a class="headerlink" href="#lecture-10-august-28th-2023" title="Permalink to this headline">#</a></h1>
<p><strong>Updates and Reminders:</strong></p>
<ul class="simple">
<li><p>Homework 5 and Homework 6 are posted and due Friday at midnight. Definitely attend discussion to get started and have questions answered.</p></li>
<li><p>Complete EDA outcomes by Wednesday at midnight.</p></li>
<li><p>Wednesday we’ll go over instructions for the final project (either in lecture or discussion, depending on where we end up in lecture today).</p></li>
<li><p>Monday, September 4th is a holiday. We will not be having lecture or discussion.</p></li>
</ul>
<p>Last lecture there was a question about if we could increase the maximum number of rows allowed in a DataFrame for plotting with Altair. I wasn’t sure how to do it, but I have found out! <a class="reference external" href="https://altair-viz.github.io/user_guide/large_datasets.html">Check out this link.</a> The following code should also work for some larger datasets that we’ve seen in the class (e.g. the taxis dataset).</p>
<p><code class="docutils literal notranslate"><span class="pre">alt.data_transformers.enable('default',max_rows=10000)</span></code></p>
<p><strong>Today:</strong></p>
<ul class="simple">
<li><p>Linear regression with multiple input features</p></li>
<li><p>Mathematical introduction to linear regression and computing coefficients by hand</p></li>
<li><p>Polynomial regression</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_regression</span>
</pre></div>
</div>
</div>
</div>
<section id="last-time">
<h2>Last Time<a class="headerlink" href="#last-time" title="Permalink to this headline">#</a></h2>
<section id="interpreting-linear-regression-coefficients">
<h3>Interpreting Linear Regression Coefficients<a class="headerlink" href="#interpreting-linear-regression-coefficients" title="Permalink to this headline">#</a></h3>
<p>Recall that last time we were working with the taxis dataset. We considered the sub-DataFrame where the distance traveled was strictly greater than 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pre</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;taxis&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_pre</span><span class="p">[</span><span class="n">df_pre</span><span class="p">[</span><span class="s2">&quot;distance&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4972, 14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2871</th>
      <td>2019-03-12 20:28:02</td>
      <td>2019-03-12 20:43:16</td>
      <td>1</td>
      <td>2.80</td>
      <td>12.0</td>
      <td>3.15</td>
      <td>0.00</td>
      <td>18.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Upper East Side South</td>
      <td>East Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>898</th>
      <td>2019-03-24 13:17:38</td>
      <td>2019-03-24 13:31:41</td>
      <td>1</td>
      <td>1.20</td>
      <td>10.0</td>
      <td>2.65</td>
      <td>0.00</td>
      <td>15.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Murray Hill</td>
      <td>Clinton East</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>845</th>
      <td>2019-03-04 13:22:23</td>
      <td>2019-03-04 13:38:07</td>
      <td>1</td>
      <td>2.10</td>
      <td>11.5</td>
      <td>2.96</td>
      <td>0.00</td>
      <td>17.76</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Midtown East</td>
      <td>Upper West Side South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>1580</th>
      <td>2019-03-21 23:31:03</td>
      <td>2019-03-21 23:42:56</td>
      <td>1</td>
      <td>3.35</td>
      <td>12.0</td>
      <td>3.16</td>
      <td>0.00</td>
      <td>18.96</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Kips Bay</td>
      <td>Lincoln Square East</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
    </tr>
    <tr>
      <th>4002</th>
      <td>2019-03-16 08:55:35</td>
      <td>2019-03-16 09:37:31</td>
      <td>3</td>
      <td>10.70</td>
      <td>39.0</td>
      <td>9.10</td>
      <td>5.76</td>
      <td>54.66</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Manhattan Valley</td>
      <td>LaGuardia Airport</td>
      <td>Manhattan</td>
      <td>Queens</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Add a new column to the DataFrame, called “hour”, which contains the hour at which the pickup occurred.</p></li>
</ul>
<p>Notice that the pickup and dropoff columns are already stored as datetime values, so we don’t need to do any conversion here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;hour&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2871</th>
      <td>2019-03-12 20:28:02</td>
      <td>2019-03-12 20:43:16</td>
      <td>1</td>
      <td>2.80</td>
      <td>12.0</td>
      <td>3.15</td>
      <td>0.00</td>
      <td>18.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Upper East Side South</td>
      <td>East Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>20</td>
    </tr>
    <tr>
      <th>898</th>
      <td>2019-03-24 13:17:38</td>
      <td>2019-03-24 13:31:41</td>
      <td>1</td>
      <td>1.20</td>
      <td>10.0</td>
      <td>2.65</td>
      <td>0.00</td>
      <td>15.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Murray Hill</td>
      <td>Clinton East</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>13</td>
    </tr>
    <tr>
      <th>845</th>
      <td>2019-03-04 13:22:23</td>
      <td>2019-03-04 13:38:07</td>
      <td>1</td>
      <td>2.10</td>
      <td>11.5</td>
      <td>2.96</td>
      <td>0.00</td>
      <td>17.76</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Midtown East</td>
      <td>Upper West Side South</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>13</td>
    </tr>
    <tr>
      <th>1580</th>
      <td>2019-03-21 23:31:03</td>
      <td>2019-03-21 23:42:56</td>
      <td>1</td>
      <td>3.35</td>
      <td>12.0</td>
      <td>3.16</td>
      <td>0.00</td>
      <td>18.96</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Kips Bay</td>
      <td>Lincoln Square East</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>23</td>
    </tr>
    <tr>
      <th>4002</th>
      <td>2019-03-16 08:55:35</td>
      <td>2019-03-16 09:37:31</td>
      <td>3</td>
      <td>10.70</td>
      <td>39.0</td>
      <td>9.10</td>
      <td>5.76</td>
      <td>54.66</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Manhattan Valley</td>
      <td>LaGuardia Airport</td>
      <td>Manhattan</td>
      <td>Queens</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1812</th>
      <td>2019-03-22 15:07:37</td>
      <td>2019-03-22 15:15:51</td>
      <td>1</td>
      <td>1.20</td>
      <td>7.5</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>10.80</td>
      <td>yellow</td>
      <td>cash</td>
      <td>Clinton East</td>
      <td>Midtown North</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2191</th>
      <td>2019-03-25 16:04:47</td>
      <td>2019-03-25 16:48:51</td>
      <td>1</td>
      <td>13.11</td>
      <td>52.0</td>
      <td>13.11</td>
      <td>5.76</td>
      <td>78.67</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>South Jamaica</td>
      <td>Flushing Meadows-Corona Park</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>16</td>
    </tr>
    <tr>
      <th>4827</th>
      <td>2019-03-13 21:49:00</td>
      <td>2019-03-13 22:02:04</td>
      <td>1</td>
      <td>2.68</td>
      <td>11.0</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>15.80</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>East Chelsea</td>
      <td>Alphabet City</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>21</td>
    </tr>
    <tr>
      <th>4326</th>
      <td>2019-03-28 08:22:07</td>
      <td>2019-03-28 08:33:50</td>
      <td>1</td>
      <td>1.60</td>
      <td>9.0</td>
      <td>2.00</td>
      <td>0.00</td>
      <td>14.30</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Battery Park City</td>
      <td>TriBeCa/Civic Center</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>8</td>
    </tr>
    <tr>
      <th>5779</th>
      <td>2019-03-31 20:09:49</td>
      <td>2019-03-31 20:17:33</td>
      <td>1</td>
      <td>1.47</td>
      <td>7.5</td>
      <td>2.20</td>
      <td>0.00</td>
      <td>11.00</td>
      <td>green</td>
      <td>credit card</td>
      <td>Forest Hills</td>
      <td>Glendale</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
<p>4972 rows × 15 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Remove all rows from the DataFrame where the hour is 16 or earlier. (So we are only using late afternoon and evening taxi rides.)</p></li>
</ul>
<p>Think about how traffic changes throughout the day. There’s typically a morning rush hour and an evening rush hour, with low traffic between these hours.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;hour&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2871</th>
      <td>2019-03-12 20:28:02</td>
      <td>2019-03-12 20:43:16</td>
      <td>1</td>
      <td>2.80</td>
      <td>12.0</td>
      <td>3.15</td>
      <td>0.0</td>
      <td>18.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Upper East Side South</td>
      <td>East Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>20</td>
    </tr>
    <tr>
      <th>1580</th>
      <td>2019-03-21 23:31:03</td>
      <td>2019-03-21 23:42:56</td>
      <td>1</td>
      <td>3.35</td>
      <td>12.0</td>
      <td>3.16</td>
      <td>0.0</td>
      <td>18.96</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Kips Bay</td>
      <td>Lincoln Square East</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>23</td>
    </tr>
    <tr>
      <th>6369</th>
      <td>2019-03-26 18:15:56</td>
      <td>2019-03-26 18:41:22</td>
      <td>6</td>
      <td>6.81</td>
      <td>23.0</td>
      <td>2.00</td>
      <td>0.0</td>
      <td>26.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>Astoria</td>
      <td>Middle Village</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>18</td>
    </tr>
    <tr>
      <th>5930</th>
      <td>2019-03-04 21:16:10</td>
      <td>2019-03-04 21:29:01</td>
      <td>1</td>
      <td>2.85</td>
      <td>12.0</td>
      <td>3.32</td>
      <td>0.0</td>
      <td>16.62</td>
      <td>green</td>
      <td>credit card</td>
      <td>Elmhurst/Maspeth</td>
      <td>Forest Hills</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>21</td>
    </tr>
    <tr>
      <th>2783</th>
      <td>2019-03-25 23:26:21</td>
      <td>2019-03-25 23:35:57</td>
      <td>3</td>
      <td>2.50</td>
      <td>10.5</td>
      <td>2.85</td>
      <td>0.0</td>
      <td>17.15</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Upper East Side North</td>
      <td>Bloomingdale</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Add a new column to the DataFrame, called “duration”, which contains the amount of time in minutes of the taxi ride.</p></li>
</ul>
<p>Hint 1. Because the “dropoff” and “pickup” columns are already date-time values, we can subtract one from the other and pandas will know what to do.</p>
<p>Hint 2. I expected there to be a minutes attribute (after using the dt accessor) but there wasn’t. Call <code class="docutils literal notranslate"><span class="pre">dir</span></code> to see some options.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;pickup&#39;, &#39;dropoff&#39;, &#39;passengers&#39;, &#39;distance&#39;, &#39;fare&#39;, &#39;tip&#39;, &#39;tolls&#39;,
       &#39;total&#39;, &#39;color&#39;, &#39;payment&#39;, &#39;pickup_zone&#39;, &#39;dropoff_zone&#39;,
       &#39;pickup_borough&#39;, &#39;dropoff_borough&#39;, &#39;hour&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;dropoff&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pickup&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/ct/dspwzk2n6kb19j3s9g3ldtc80000gn/T/ipykernel_22426/2650549470.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[&quot;duration&quot;] = df[&quot;dropoff&quot;] - df[&quot;pickup&quot;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>hour</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2871</th>
      <td>2019-03-12 20:28:02</td>
      <td>2019-03-12 20:43:16</td>
      <td>1</td>
      <td>2.80</td>
      <td>12.0</td>
      <td>3.15</td>
      <td>0.0</td>
      <td>18.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Upper East Side South</td>
      <td>East Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>20</td>
      <td>0 days 00:15:14</td>
    </tr>
    <tr>
      <th>1580</th>
      <td>2019-03-21 23:31:03</td>
      <td>2019-03-21 23:42:56</td>
      <td>1</td>
      <td>3.35</td>
      <td>12.0</td>
      <td>3.16</td>
      <td>0.0</td>
      <td>18.96</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Kips Bay</td>
      <td>Lincoln Square East</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>23</td>
      <td>0 days 00:11:53</td>
    </tr>
    <tr>
      <th>6369</th>
      <td>2019-03-26 18:15:56</td>
      <td>2019-03-26 18:41:22</td>
      <td>6</td>
      <td>6.81</td>
      <td>23.0</td>
      <td>2.00</td>
      <td>0.0</td>
      <td>26.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>Astoria</td>
      <td>Middle Village</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>18</td>
      <td>0 days 00:25:26</td>
    </tr>
    <tr>
      <th>5930</th>
      <td>2019-03-04 21:16:10</td>
      <td>2019-03-04 21:29:01</td>
      <td>1</td>
      <td>2.85</td>
      <td>12.0</td>
      <td>3.32</td>
      <td>0.0</td>
      <td>16.62</td>
      <td>green</td>
      <td>credit card</td>
      <td>Elmhurst/Maspeth</td>
      <td>Forest Hills</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>21</td>
      <td>0 days 00:12:51</td>
    </tr>
    <tr>
      <th>2783</th>
      <td>2019-03-25 23:26:21</td>
      <td>2019-03-25 23:35:57</td>
      <td>3</td>
      <td>2.50</td>
      <td>10.5</td>
      <td>2.85</td>
      <td>0.0</td>
      <td>17.15</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Upper East Side North</td>
      <td>Bloomingdale</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>23</td>
      <td>0 days 00:09:36</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">dir</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;__annotations__&#39;,
 &#39;__class__&#39;,
 &#39;__delattr__&#39;,
 &#39;__dict__&#39;,
 &#39;__dir__&#39;,
 &#39;__doc__&#39;,
 &#39;__eq__&#39;,
 &#39;__format__&#39;,
 &#39;__frozen&#39;,
 &#39;__ge__&#39;,
 &#39;__getattribute__&#39;,
 &#39;__gt__&#39;,
 &#39;__hash__&#39;,
 &#39;__init__&#39;,
 &#39;__init_subclass__&#39;,
 &#39;__le__&#39;,
 &#39;__lt__&#39;,
 &#39;__module__&#39;,
 &#39;__ne__&#39;,
 &#39;__new__&#39;,
 &#39;__reduce__&#39;,
 &#39;__reduce_ex__&#39;,
 &#39;__repr__&#39;,
 &#39;__setattr__&#39;,
 &#39;__sizeof__&#39;,
 &#39;__str__&#39;,
 &#39;__subclasshook__&#39;,
 &#39;__weakref__&#39;,
 &#39;_accessors&#39;,
 &#39;_add_delegate_accessors&#39;,
 &#39;_constructor&#39;,
 &#39;_delegate_method&#39;,
 &#39;_delegate_property_get&#39;,
 &#39;_delegate_property_set&#39;,
 &#39;_dir_additions&#39;,
 &#39;_dir_deletions&#39;,
 &#39;_freeze&#39;,
 &#39;_get_values&#39;,
 &#39;_hidden_attrs&#39;,
 &#39;_parent&#39;,
 &#39;_reset_cache&#39;,
 &#39;ceil&#39;,
 &#39;components&#39;,
 &#39;days&#39;,
 &#39;floor&#39;,
 &#39;freq&#39;,
 &#39;microseconds&#39;,
 &#39;nanoseconds&#39;,
 &#39;round&#39;,
 &#39;seconds&#39;,
 &#39;to_pytimedelta&#39;,
 &#39;total_seconds&#39;]
</pre></div>
</div>
</div>
</div>
<p>One thing to notice is that there are relatively few options available here (especially to when we call <code class="docutils literal notranslate"><span class="pre">dir</span></code> for things in NumPy). Since there’s no minutes attribute, how about we use seconds and convert to minutes ourselves.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/ct/dspwzk2n6kb19j3s9g3ldtc80000gn/T/ipykernel_22426/365044000.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[&quot;duration&quot;] = df[&quot;duration&quot;].dt.seconds
</pre></div>
</div>
</div>
</div>
<p>This is what all of the warnings have been about. I already converted “duration” to seconds, which is now represented as an integer. If I run the above cell again, I get an error because now “duration” not longer is datetime values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Divide by 60 to get the number of minutes</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span><span class="o">/</span><span class="mi">60</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/ct/dspwzk2n6kb19j3s9g3ldtc80000gn/T/ipykernel_22426/3948586737.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[&quot;duration&quot;] = df[&quot;duration&quot;]/60
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pickup</th>
      <th>dropoff</th>
      <th>passengers</th>
      <th>distance</th>
      <th>fare</th>
      <th>tip</th>
      <th>tolls</th>
      <th>total</th>
      <th>color</th>
      <th>payment</th>
      <th>pickup_zone</th>
      <th>dropoff_zone</th>
      <th>pickup_borough</th>
      <th>dropoff_borough</th>
      <th>hour</th>
      <th>duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2871</th>
      <td>2019-03-12 20:28:02</td>
      <td>2019-03-12 20:43:16</td>
      <td>1</td>
      <td>2.80</td>
      <td>12.0</td>
      <td>3.15</td>
      <td>0.0</td>
      <td>18.95</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Upper East Side South</td>
      <td>East Village</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>20</td>
      <td>15.233333</td>
    </tr>
    <tr>
      <th>1580</th>
      <td>2019-03-21 23:31:03</td>
      <td>2019-03-21 23:42:56</td>
      <td>1</td>
      <td>3.35</td>
      <td>12.0</td>
      <td>3.16</td>
      <td>0.0</td>
      <td>18.96</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Kips Bay</td>
      <td>Lincoln Square East</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>23</td>
      <td>11.883333</td>
    </tr>
    <tr>
      <th>6369</th>
      <td>2019-03-26 18:15:56</td>
      <td>2019-03-26 18:41:22</td>
      <td>6</td>
      <td>6.81</td>
      <td>23.0</td>
      <td>2.00</td>
      <td>0.0</td>
      <td>26.80</td>
      <td>green</td>
      <td>credit card</td>
      <td>Astoria</td>
      <td>Middle Village</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>18</td>
      <td>25.433333</td>
    </tr>
    <tr>
      <th>5930</th>
      <td>2019-03-04 21:16:10</td>
      <td>2019-03-04 21:29:01</td>
      <td>1</td>
      <td>2.85</td>
      <td>12.0</td>
      <td>3.32</td>
      <td>0.0</td>
      <td>16.62</td>
      <td>green</td>
      <td>credit card</td>
      <td>Elmhurst/Maspeth</td>
      <td>Forest Hills</td>
      <td>Queens</td>
      <td>Queens</td>
      <td>21</td>
      <td>12.850000</td>
    </tr>
    <tr>
      <th>2783</th>
      <td>2019-03-25 23:26:21</td>
      <td>2019-03-25 23:35:57</td>
      <td>3</td>
      <td>2.50</td>
      <td>10.5</td>
      <td>2.85</td>
      <td>0.0</td>
      <td>17.15</td>
      <td>yellow</td>
      <td>credit card</td>
      <td>Upper East Side North</td>
      <td>Bloomingdale</td>
      <td>Manhattan</td>
      <td>Manhattan</td>
      <td>23</td>
      <td>9.600000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Fit a new <code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code> object, this time using “distance”, “hour”, “passengers” as the input features, and using “duration” as the target value.</p></li>
</ul>
<p>Remember our workflow for scikit-learn
1.) Import (already done)
2.) Instantiate…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>3.) Fit</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span><span class="s2">&quot;hour&quot;</span><span class="p">,</span><span class="s2">&quot;passengers&quot;</span><span class="p">]],</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div></div></div>
</div>
<p><strong>Sanity Check:</strong> We’re asking how does distance, the hour of the day, and the number of passengers influence how many minutes a taxi ride will take.
Predictions:</p>
<ul class="simple">
<li><p>Distance: We expect that the greater the distance, the longer the taxi ride will take.</p></li>
<li><p>Hour: Remember, we’re looking at 5:00pm and after. As we move away from rush hour (5:00pm), we expect the taxi ride to take less time.</p></li>
<li><p>Passengers: Do we expect the number of passengers to have an influence on the duration of the ride? We don’t expect this to have too much influence on the duration of the taxi ride, but we’ll find out.</p></li>
</ul>
<p>Now, let’s get the coefficients…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#[&quot;distance&quot;,&quot;hour&quot;,&quot;passengers&quot;]</span>
<span class="n">reg</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 2.394538  , -0.59737863, -0.08703218])
</pre></div>
</div>
</div>
</div>
<p>Very important topic: being able to interpret what these coefficients are saying. Pay particular attention to the signs.</p>
<p>The coefficient for distance is positive; this makes sense, because as the number of miles we travel increases, we expect the duration of the ride to take longer.</p>
<p>The coefficient for the hour is negative; this is saying that as the hour increases (remember we are looking after 5:00pm), the duration of the taxi ride is shorter. The reason we restricted to after 5:00pm, is because we don’t expect the duration to decrease consistently throughout the day. There is traffic in the morning, when we also expect the duration of the taxi ride to be longer. If we included all hours of the day, we could expect this coefficient to be less accurate.</p>
<p>The last coefficient deals with the number of passengers. While it is negative, it is very close to 0; this tells us that the number of passengers doesn’t really say much about the duration of the taxi ride. Notice: the number of passengers in the care is pretty small, so this coefficient multiplied with the number of passengers is still a pretty small number. We’ll see examples later today where coefficients might be small, but the column they correspond to has huge numbers, we expect more of an influence of the coefficients in this case.</p>
<p><strong>Reminder of the model:</strong></p>
<div class="math notranslate nohighlight">
\[
\text{duration} \approx c_0 + c_1*\text{distance} + c_2*\text{hour} + c_3*\text{passengers}
\]</div>
<p>You can kind of think of the coefficients like partial derivatives. For example, as we increase the distance by 1 mile, we can expect the time to go up by 2.4 minutes.</p>
</section>
</section>
<section id="recap-and-examples-so-far">
<h2>Recap and Examples So Far<a class="headerlink" href="#recap-and-examples-so-far" title="Permalink to this headline">#</a></h2>
<p>The coefficients in each of the following should all make intuitive sense, except for the number of passengers in the taxis dataset. Recall that we don’t expect the number of passengers to make a difference to the duration of the taxi ride.</p>
<section id="spotify-data">
<h3>Spotify Data<a class="headerlink" href="#spotify-data" title="Permalink to this headline">#</a></h3>
<p>Here, “Acousticness” is opposite “Electronic”, and “Valence” is a measure of happiness/positivity.</p>
<ul class="simple">
<li><p>Input features (predictors): <code class="docutils literal notranslate"><span class="pre">[&quot;Acousticness&quot;,</span> <span class="pre">&quot;Speechiness&quot;,</span> <span class="pre">&quot;Valence&quot;]</span></code></p></li>
<li><p>Target: “Energy”</p></li>
<li><p>Coefficients: <code class="docutils literal notranslate"><span class="pre">[-0.33557117,</span> <span class="pre">-0.08205736,</span>&#160; <span class="pre">0.21893852]</span></code></p></li>
</ul>
<p>“The story the coefficients are telling us”</p>
<ul class="simple">
<li><p>The more acousticness a song has, the less energy it has</p></li>
<li><p>I’d say “Speechiness” is similar to the “passengers” situation; it’s pretty close to zero</p></li>
<li><p>The more valence a song has, the more energy it has</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spotdata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;spotify.csv&quot;</span><span class="p">,</span><span class="n">na_values</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg2</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">reg2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">spotdata</span><span class="p">[[</span><span class="s2">&quot;Acousticness&quot;</span><span class="p">,</span> <span class="s2">&quot;Speechiness&quot;</span><span class="p">,</span> <span class="s2">&quot;Valence&quot;</span><span class="p">]],</span><span class="n">spotdata</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">])</span>
<span class="n">reg2</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.33557117, -0.08205736,  0.21893852])
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-mpg-dataset">
<h3>The mpg dataset<a class="headerlink" href="#the-mpg-dataset" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mpg</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;mpg&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Input features: <code class="docutils literal notranslate"><span class="pre">[&quot;horsepower&quot;,</span> <span class="pre">&quot;weight&quot;,</span> <span class="pre">&quot;model_year&quot;,</span> <span class="pre">&quot;cylinders&quot;]</span></code>
Target: mpg
Coefficients: <code class="docutils literal notranslate"><span class="pre">[-0.00361502,</span> <span class="pre">-0.00627463,</span>&#160; <span class="pre">0.74663191,</span> <span class="pre">-0.1276871</span> <span class="pre">]</span></code></p>
<p>Notice that as “model_year” increases, so does “mpg”. This makes sense because newer cars tend to have better fuel economy.</p>
<p>Warning: We haven’t scaled any data yet. What this means is that the orders of magnitude of each input feature could be wildly different. For instance, “cylinders” is a number between 1 and 8 in this dataset, while “weight” is in the thousands of pounds. This will influence the magnitude of the coefficients, and it’s hard at this point to say which, if any, coefficient “is the most important”. For now, the more important thing is looking at the signs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg3</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">reg3</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">mpg</span><span class="p">[[</span><span class="s2">&quot;horsepower&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="s2">&quot;model_year&quot;</span><span class="p">,</span> <span class="s2">&quot;cylinders&quot;</span><span class="p">]],</span><span class="n">mpg</span><span class="p">[</span><span class="s2">&quot;mpg&quot;</span><span class="p">])</span>
<span class="n">reg3</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.00361502, -0.00627463,  0.74663191, -0.1276871 ])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="how-does-the-linear-regression-model-work">
<h2>How does the linear regression model work?<a class="headerlink" href="#how-does-the-linear-regression-model-work" title="Permalink to this headline">#</a></h2>
<p>First, we’ll have a short iPad section on some of the math behind the linear regression that scikit-learn uses. We won’t go through all of the details, but it will be enought to try testing some examples by hand.</p>
<p><img alt="" src="../_images/Teaching-49.jpg" /></p>
<p><img alt="" src="../_images/Teaching-50.jpg" /></p>
<p><img alt="" src="../_images/Teaching-51.jpg" /></p>
<p><img alt="" src="../_images/Teaching-52.jpg" /></p>
<p><img alt="" src="../_images/Teaching-53.jpg" /></p>
<p><img alt="" src="../_images/Teaching-54.jpg" /></p>
<p>Here, we generate sample data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_regression</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">115</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;input&quot;</span><span class="p">:</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="s2">&quot;target&quot;</span><span class="p">:</span><span class="n">y</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<section id="computing-the-coefficients-by-hand">
<h3>Computing the coefficients by hand<a class="headerlink" href="#computing-the-coefficients-by-hand" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Compute the coefficients of an ordinary least squares linear regression for our sample data. Then verify your answers by fitting a <code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code> object.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xvalues</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xvalues</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-1.8084713 ,  0.62178653, -0.82618176,  1.60925431,  1.9240453 ,
        0.60836198, -0.93190121,  1.231978  ,  0.21530948,  1.43236953])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-87.46955972,  27.84651384, -39.92172546,  98.37056305,
       164.22459134,  62.81480042, -42.08652976,  76.75523358,
        32.3430665 ,  96.18407347])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sumx</span> <span class="o">=</span> <span class="n">xvalues</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sumy</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b1</span> <span class="o">=</span> <span class="p">((</span><span class="n">xvalues</span> <span class="o">-</span> <span class="n">sumx</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">sumy</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="p">((</span><span class="n">xvalues</span> <span class="o">-</span> <span class="n">sumx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">b1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>60.82851283962949
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b0</span> <span class="o">=</span> <span class="n">sumy</span> <span class="o">-</span> <span class="n">b1</span><span class="o">*</span><span class="n">sumx</span>
<span class="n">b0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.109050087251138
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([60.82851284])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span><span class="o">.</span><span class="n">intercept_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.109050087251141
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Plot the sample data and the line determined by performing linear regression.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;pred&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c1</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;target&quot;</span>
<span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;pred&quot;</span>
<span class="p">)</span>
<span class="n">c1</span><span class="o">+</span><span class="n">c2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-3c9f38eabc4b4c328fff86b223977de5.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-3c9f38eabc4b4c328fff86b223977de5.vega-embed details,
  #altair-viz-3c9f38eabc4b4c328fff86b223977de5.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-3c9f38eabc4b4c328fff86b223977de5"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-3c9f38eabc4b4c328fff86b223977de5") {
      outputDiv = document.getElementById("altair-viz-3c9f38eabc4b4c328fff86b223977de5");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "circle", "size": 100}, "encoding": {"x": {"field": "input", "type": "quantitative"}, "y": {"field": "target", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "red"}, "encoding": {"x": {"field": "input", "type": "quantitative"}, "y": {"field": "pred", "type": "quantitative"}}}], "data": {"name": "data-48f29fdebd5feee668eaa24651b1a1d5"}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-48f29fdebd5feee668eaa24651b1a1d5": [{"input": -1.8084712954315207, "target": -87.46955971536616, "pred": -95.8975693270065}, {"input": 0.621786533732277, "target": 27.8465138366401, "pred": 51.93140023789366}, {"input": -0.8261817570671143, "target": -39.921725464221254, "pred": -36.146357530373464}, {"input": 1.6092543057526454, "target": 98.37056304524937, "pred": 111.99759628695497}, {"input": 1.9240453020544521, "target": 164.2245913396463, "pred": 131.14586444729918}, {"input": 0.6083619755049371, "target": 62.81480042274558, "pred": 51.11480432539556}, {"input": -0.9319012092216943, "target": -42.08652976133884, "pred": -42.57711458315693}, {"input": 1.2319779997533098, "target": 76.7552335803455, "pred": 89.0484396633864}, {"input": 0.2153094803244058, "target": 32.343066495889104, "pred": 27.20600557565821}, {"input": 1.4323695253485995, "target": 96.18407346747384, "pred": 101.2379581510124}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>That’s all we got to today. We’ll pick up next time with polynomial regression.</p>
<a style='text-decoration:none;line-height:16px;display:flex;color:#5B5B62;padding:10px;justify-content:end;' href='https://deepnote.com?utm_source=created-in-deepnote-cell&projectId=972a638f-3e7f-40c8-a23e-8d9b3f176627' target="_blank">
<img alt='Created in deepnote.com' style='display:inline;max-height:16px;margin:0px;margin-right:7.5px;' src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgODAgODAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkxhbmRpbmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyMzUuMDAwMDAwLCAtNzkuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjM1LjAwMDAwMCwgNzkuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0yMCIgZmlsbD0iIzAyNjVCNCIgcG9pbnRzPSIyLjM3NjIzNzYyIDgwIDM4LjA0NzY2NjcgODAgNTcuODIxNzgyMiA3My44MDU3NTkyIDU3LjgyMTc4MjIgMzIuNzU5MjczOSAzOS4xNDAyMjc4IDMxLjY4MzE2ODMiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNS4wMDc3MTgsODAgQzQyLjkwNjIwMDcsNzYuNDU0OTM1OCA0Ny41NjQ5MTY3LDcxLjU0MjI2NzEgNDguOTgzODY2LDY1LjI2MTk5MzkgQzUxLjExMjI4OTksNTUuODQxNTg0MiA0MS42NzcxNzk1LDQ5LjIxMjIyODQgMjUuNjIzOTg0Niw0OS4yMTIyMjg0IEMyNS40ODQ5Mjg5LDQ5LjEyNjg0NDggMjkuODI2MTI5Niw0My4yODM4MjQ4IDM4LjY0NzU4NjksMzEuNjgzMTY4MyBMNzIuODcxMjg3MSwzMi41NTQ0MjUgTDY1LjI4MDk3Myw2Ny42NzYzNDIxIEw1MS4xMTIyODk5LDc3LjM3NjE0NCBMMzUuMDA3NzE4LDgwIFoiIGlkPSJQYXRoLTIyIiBmaWxsPSIjMDAyODY4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMCwzNy43MzA0NDA1IEwyNy4xMTQ1MzcsMC4yNTcxMTE0MzYgQzYyLjM3MTUxMjMsLTEuOTkwNzE3MDEgODAsMTAuNTAwMzkyNyA4MCwzNy43MzA0NDA1IEM4MCw2NC45NjA0ODgyIDY0Ljc3NjUwMzgsNzkuMDUwMzQxNCAzNC4zMjk1MTEzLDgwIEM0Ny4wNTUzNDg5LDc3LjU2NzA4MDggNTMuNDE4MjY3Nyw3MC4zMTM2MTAzIDUzLjQxODI2NzcsNTguMjM5NTg4NSBDNTMuNDE4MjY3Nyw0MC4xMjg1NTU3IDM2LjMwMzk1NDQsMzcuNzMwNDQwNSAyNS4yMjc0MTcsMzcuNzMwNDQwNSBDMTcuODQzMDU4NiwzNy43MzA0NDA1IDkuNDMzOTE5NjYsMzcuNzMwNDQwNSAwLDM3LjczMDQ0MDUgWiIgaWQ9IlBhdGgtMTkiIGZpbGw9IiMzNzkzRUYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+' > </img>
Created in <span style='font-weight:600;margin-left:4px;'>Deepnote</span></a></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="lec9.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lecture 9: August 25th, 2023</p>
      </div>
    </a>
    <a class="right-next"
       href="lec11.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lecture 11: August 30th, 2023</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#last-time">Last Time</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-linear-regression-coefficients">Interpreting Linear Regression Coefficients</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-and-examples-so-far">Recap and Examples So Far</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spotify-data">Spotify Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-mpg-dataset">The mpg dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-the-linear-regression-model-work">How does the linear regression model work?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-coefficients-by-hand">Computing the coefficients by hand</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Christopher Davis and Yasmeen Baki
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>