

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Lecture 12: September 1st, 2023 &#8212; Math 10, Summer Session II 2023</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/lec12';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Week 5 Lecture Videos" href="../w5vid.html" />
    <link rel="prev" title="Lecture 11: August 30th, 2023" href="lec11.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/confuse.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/confuse.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    UC Irvine, Math 10, Summer 2023
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w1vid.html">Week 1 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec1.html">Lecture 1: August 7th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../worksheets/wkst1.html">Discussion 1: August 7th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec2.html">Lecture 2: August 9th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../worksheets/wkst2.html">Discussion 2: August 9th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec3.html">Lecture 3: August 11th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w2vid.html">Week 2 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec4.html">Lecture 4: August 14th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec5.html">Lecture 5: August 16th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec6.html">Lecture 6: August 18th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w3vid.html">Week 3 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec7.html">Lecture 7: August 21st, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec8.html">Lecture 8: August 23nd, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec9.html">Lecture 9: August 25th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lec10.html">Lecture 10: August 28th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec11.html">Lecture 11: August 30th, 2023</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lecture 12: September 1st, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../w5vid.html">Week 5 Lecture Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec13.html">Lecture 13: September 6th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="lec14.html">Lecture 14: September 8th, 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Final Project and Finals Week</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lec15.html">Lecture 15: September 11th, 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final/final.html">🎉 Final Project Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final/extra.html">Possible Extra Topics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Projects</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../students/proj.html">Student Projects</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../students/brianbui/BrianBui.html">League of Legends 13.13</a></li>
<li class="toctree-l2"><a class="reference internal" href="../students/titusdejong/TitusdeJong.html">Detecting events in Timestamp data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../students/yufeng/YuFeng.html">Predict Diabetes Based on Various Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../students/harrisonhong/HarrisonHong.html">Mushroom Edibility Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../students/shayankermani/ShayanKermani.html">Online Chess Games Examination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../students/laurenkim/LaurenKim.html">Predicting Formula 1 Constructor’s Champion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../students/jameslai/JamesLai.html">COVID-19 Data Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../students/BaoyeLiu.html">Heart Disease Graph</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ybaki97/Math10-SSI23" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ybaki97/Math10-SSI23/issues/new?title=Issue%20on%20page%20%2Flectures/lec12.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lectures/lec12.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lecture 12: September 1st, 2023</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#happy-september">🎃 🍁 Happy September!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-measures-for-regression">Performance measures for regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-on-polynomial-regression">More on Polynomial Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-random-data">Generating Random Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polynomialfeatures">PolynomialFeatures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-pipeline-to-combine-multiple-step">Using <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> to combine multiple step</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overfitting">Overfitting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dividing-into-a-training-set-and-a-test-set">Dividing into a training set and a test set</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performing-polynomial-regression-for-each-degree">Performing Polynomial Regression for Each Degree</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-the-performance-part-1">Evaluating the Performance, Part 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-the-performance-part-2">Evaluating the Performance, Part 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-polynomial-fits">Plotting the polynomial fits</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lecture-12-september-1st-2023">
<h1>Lecture 12: September 1st, 2023<a class="headerlink" href="#lecture-12-september-1st-2023" title="Permalink to this headline">#</a></h1>
<section id="happy-september">
<h2>🎃 🍁 Happy September!<a class="headerlink" href="#happy-september" title="Permalink to this headline">#</a></h2>
<p>Remember! Monday is a holiday, so there will be no lecture or discussion :( I’ll post some videos that you can watch on Tuesday so that we don’t get too far behind.</p>
</section>
<section id="performance-measures-for-regression">
<h2>Performance measures for regression<a class="headerlink" href="#performance-measures-for-regression" title="Permalink to this headline">#</a></h2>
<p>Let’s consider the following dataset, which only has four points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas as pd
import altair as alt
import numpy as np
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df = pd.DataFrame({
    &quot;x&quot;:np.arange(4),
    &quot;y&quot;:[0,2,-10,6]},
)
df
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>-10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Plot <code class="docutils literal notranslate"><span class="pre">df</span></code> using Altair to see how the data looks.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>alt.Chart(df).mark_circle(size=150).encode(
    x=&quot;x&quot;,
    y=&quot;y&quot;
)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-b4a5fa8f57704087ab89bf3b920b9493.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-b4a5fa8f57704087ab89bf3b920b9493.vega-embed details,
  #altair-viz-b4a5fa8f57704087ab89bf3b920b9493.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b4a5fa8f57704087ab89bf3b920b9493"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b4a5fa8f57704087ab89bf3b920b9493") {
      outputDiv = document.getElementById("altair-viz-b4a5fa8f57704087ab89bf3b920b9493");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-dd2f37c2feb906cd9c4f4b68fb9fb7ee"}, "mark": {"type": "circle", "size": 150}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-dd2f37c2feb906cd9c4f4b68fb9fb7ee": [{"x": 0, "y": 0}, {"x": 1, "y": 2}, {"x": 2, "y": -10}, {"x": 3, "y": 6}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<ul class="simple">
<li><p>Our goal is to figure out which of the following linear models best fits our data.</p>
<ul>
<li><p>Line A: <span class="math notranslate nohighlight">\(f(x) = 2x\)</span></p></li>
<li><p>Line B: <span class="math notranslate nohighlight">\(f(x) = 0.6x - 1.4\)</span></p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>Add columns to <code class="docutils literal notranslate"><span class="pre">df</span></code> corresponding to these lines. Name the new columns “lineA” and “lineB”.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#correct, but overly complicated
df[&quot;lineA&quot;] = df[&quot;x&quot;].map(lambda x: 2*x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#better
df[&quot;lineA&quot;] = 2*df[&quot;x&quot;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#Now, we do the same thing for line B
df[&quot;lineB&quot;] = 0.6*df[&quot;x&quot;] - 1.4
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>lineA</th>
      <th>lineB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-1.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>-0.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>-10</td>
      <td>4</td>
      <td>-0.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>6</td>
      <td>6</td>
      <td>0.4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Line A and Line B represent two different possible linear models for our data.</p>
<ul class="simple">
<li><p>Plot the data together with these lines, using the color red for Line A and the color black for Line B. Use a base chart so that you are not repeating the same code three times.</p></li>
</ul>
<p>The idea of a base chart is that we first include the data that’s common to all of the charts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>base = alt.Chart(df).encode(
    x=&quot;x&quot;
)
</pre></div>
</div>
</div>
</div>
<p>Notice, <code class="docutils literal notranslate"><span class="pre">base</span></code> on its own gives an error if we try to see it; it’s not a valid chart (notice it doesn’t have something like <code class="docutils literal notranslate"><span class="pre">mark_cirlce</span></code>/<code class="docutils literal notranslate"><span class="pre">mark_line</span></code> etc.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>base
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">SchemaValidationError</span><span class="g g-Whitespace">                     </span>Traceback (most recent call last)
<span class="nn">File ~/venv/lib/python3.9/site-packages/altair/vegalite/v5/api.py:2520,</span> in <span class="ni">Chart.to_dict</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2518</span>     <span class="n">copy</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">InlineData</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[{}])</span>
<span class="g g-Whitespace">   </span><span class="mi">2519</span>     <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Chart</span><span class="p">,</span> <span class="n">copy</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2520</span> <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/venv/lib/python3.9/site-packages/altair/vegalite/v5/api.py:850,</span> in <span class="ni">TopLevelMixin.to_dict</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">845</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>
<span class="g g-Whitespace">    </span><span class="mi">847</span> <span class="c1"># TopLevelMixin instance does not necessarily have to_dict defined</span>
<span class="g g-Whitespace">    </span><span class="mi">848</span> <span class="c1"># but due to how Altair is set up this should hold.</span>
<span class="g g-Whitespace">    </span><span class="mi">849</span> <span class="c1"># Too complex to type hint right now</span>
<span class="ne">--&gt; </span><span class="mi">850</span> <span class="n">dct</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">TopLevelMixin</span><span class="p">,</span> <span class="n">copy</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
<span class="g g-Whitespace">    </span><span class="mi">852</span> <span class="c1"># TODO: following entries are added after validation. Should they be validated?</span>
<span class="g g-Whitespace">    </span><span class="mi">853</span> <span class="k">if</span> <span class="n">is_top_level</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">854</span>     <span class="c1"># since this is top-level we add $schema if it&#39;s missing</span>

<span class="nn">File ~/venv/lib/python3.9/site-packages/altair/utils/schemapi.py:814,</span> in <span class="ni">SchemaBase.to_dict</span><span class="nt">(self, validate, ignore, context)</span>
<span class="g g-Whitespace">    </span><span class="mi">807</span>         <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">808</span>     <span class="k">except</span> <span class="n">jsonschema</span><span class="o">.</span><span class="n">ValidationError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">809</span>         <span class="c1"># We do not raise `from err` as else the resulting</span>
<span class="g g-Whitespace">    </span><span class="mi">810</span>         <span class="c1"># traceback is very long as it contains part</span>
<span class="g g-Whitespace">    </span><span class="mi">811</span>         <span class="c1"># of the Vega-Lite schema. It would also first</span>
<span class="g g-Whitespace">    </span><span class="mi">812</span>         <span class="c1"># show the less helpful ValidationError instead of</span>
<span class="g g-Whitespace">    </span><span class="mi">813</span>         <span class="c1"># the more user friendly SchemaValidationError</span>
<span class="ne">--&gt; </span><span class="mi">814</span>         <span class="k">raise</span> <span class="n">SchemaValidationError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
<span class="g g-Whitespace">    </span><span class="mi">815</span> <span class="k">return</span> <span class="n">result</span>

<span class="ne">SchemaValidationError</span>: &#39;{&#39;data&#39;: {&#39;name&#39;: &#39;data-e85beb7529ff9a23a83e49d3894e7618&#39;}, &#39;encoding&#39;: {&#39;x&#39;: {&#39;field&#39;: &#39;x&#39;, &#39;type&#39;: &#39;quantitative&#39;}}}&#39; is an invalid value.

<span class="s1">&#39;mark&#39;</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">required</span> <span class="nb">property</span>
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>alt.Chart(...)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#Notice this is the same as the first plot from today
c1 = base.mark_circle(size=150).encode(y=&quot;y&quot;)
c1
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-fc86927500974a00a219bf2c89b9887f.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-fc86927500974a00a219bf2c89b9887f.vega-embed details,
  #altair-viz-fc86927500974a00a219bf2c89b9887f.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-fc86927500974a00a219bf2c89b9887f"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-fc86927500974a00a219bf2c89b9887f") {
      outputDiv = document.getElementById("altair-viz-fc86927500974a00a219bf2c89b9887f");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-e85beb7529ff9a23a83e49d3894e7618"}, "mark": {"type": "circle", "size": 150}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-e85beb7529ff9a23a83e49d3894e7618": [{"x": 0, "y": 0, "lineA": 0, "lineB": -1.4}, {"x": 1, "y": 2, "lineA": 2, "lineB": -0.7999999999999999}, {"x": 2, "y": -10, "lineA": 4, "lineB": -0.19999999999999996}, {"x": 3, "y": 6, "lineA": 6, "lineB": 0.3999999999999999}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#Now let&#39;s plot lineA
c2 = base.mark_line(color=&quot;red&quot;).encode(y=&quot;lineA&quot;)
c2
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-523dfb0cb29b4b33968487b780b832e7.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-523dfb0cb29b4b33968487b780b832e7.vega-embed details,
  #altair-viz-523dfb0cb29b4b33968487b780b832e7.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-523dfb0cb29b4b33968487b780b832e7"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-523dfb0cb29b4b33968487b780b832e7") {
      outputDiv = document.getElementById("altair-viz-523dfb0cb29b4b33968487b780b832e7");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-e85beb7529ff9a23a83e49d3894e7618"}, "mark": {"type": "line", "color": "red"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "lineA", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-e85beb7529ff9a23a83e49d3894e7618": [{"x": 0, "y": 0, "lineA": 0, "lineB": -1.4}, {"x": 1, "y": 2, "lineA": 2, "lineB": -0.7999999999999999}, {"x": 2, "y": -10, "lineA": 4, "lineB": -0.19999999999999996}, {"x": 3, "y": 6, "lineA": 6, "lineB": 0.3999999999999999}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#Now let&#39;s plot lineB
c3 = base.mark_line(color=&quot;black&quot;).encode(y=&quot;lineB&quot;)
c3
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-c27a5292d5224fabb0b354e31b82d926.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-c27a5292d5224fabb0b354e31b82d926.vega-embed details,
  #altair-viz-c27a5292d5224fabb0b354e31b82d926.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-c27a5292d5224fabb0b354e31b82d926"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-c27a5292d5224fabb0b354e31b82d926") {
      outputDiv = document.getElementById("altair-viz-c27a5292d5224fabb0b354e31b82d926");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-e85beb7529ff9a23a83e49d3894e7618"}, "mark": {"type": "line", "color": "black"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "lineB", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-e85beb7529ff9a23a83e49d3894e7618": [{"x": 0, "y": 0, "lineA": 0, "lineB": -1.4}, {"x": 1, "y": 2, "lineA": 2, "lineB": -0.7999999999999999}, {"x": 2, "y": -10, "lineA": 4, "lineB": -0.19999999999999996}, {"x": 3, "y": 6, "lineA": 6, "lineB": 0.3999999999999999}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Now, let’s see these three charts all together:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>c1 + c2 + c3
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-f2ef884006184be4aca738cd5a8aa63d.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-f2ef884006184be4aca738cd5a8aa63d.vega-embed details,
  #altair-viz-f2ef884006184be4aca738cd5a8aa63d.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-f2ef884006184be4aca738cd5a8aa63d"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-f2ef884006184be4aca738cd5a8aa63d") {
      outputDiv = document.getElementById("altair-viz-f2ef884006184be4aca738cd5a8aa63d");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "circle", "size": 150}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "red"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "lineA", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "black"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "lineB", "type": "quantitative"}}}], "data": {"name": "data-e85beb7529ff9a23a83e49d3894e7618"}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-e85beb7529ff9a23a83e49d3894e7618": [{"x": 0, "y": 0, "lineA": 0, "lineB": -1.4}, {"x": 1, "y": 2, "lineA": 2, "lineB": -0.7999999999999999}, {"x": 2, "y": -10, "lineA": 4, "lineB": -0.19999999999999996}, {"x": 3, "y": 6, "lineA": 6, "lineB": 0.3999999999999999}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<ul class="simple">
<li><p>Which line fits the data better?</p></li>
</ul>
<p>There’s no single correct answer to this question! If you said black or red, we could justify either. It’s going to depend on how we measure “better”.</p>
<ul class="simple">
<li><p>Using scikit-learn, find the line of best fit (Linear Regression) for this data. How does it compare to the above lines?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>from sklearn.linear_model import LinearRegression
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>reg = LinearRegression()
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>reg.fit(df[[&quot;x&quot;]],df[&quot;y&quot;])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>lineA</th>
      <th>lineB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-1.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>-0.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>-10</td>
      <td>4</td>
      <td>-0.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>6</td>
      <td>6</td>
      <td>0.4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Why did I set a target of “y” and not something like “lineA”? Recall that we already have the equations for lineA and lineB. We want to find the line of best fit for our data, which we do not know the equation for.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#coeff
reg.coef_
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.6])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>reg.intercept_
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.4
</pre></div>
</div>
</div>
</div>
<p>Notice, this gives us lineB! This is the black line in our above plot, and it definitely appears to be a little worse of a fit than the red line…but sklearn is telling us this is the best line of all possible lines. What’s going on?</p>
<p>Recall, <code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code> minimizes mean squared error (MSE). So, if we compute the MSE for both of the lines, we should see that line B performs better than line A.</p>
<ul class="simple">
<li><p>Import the <code class="docutils literal notranslate"><span class="pre">mean_squared_error</span></code> function from sklearn.metrics. Which of our lines fits the data better according to this metric?</p></li>
</ul>
<p><strong>Important point:</strong> When computing errors (or loss functions), a smaller number is better.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>from sklearn.metrics import mean_squared_error
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mean_squared_error(df[&quot;y&quot;],df[&quot;lineA&quot;])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>49.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mean_squared_error(df[&quot;y&quot;],df[&quot;lineB&quot;])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>34.300000000000004
</pre></div>
</div>
</div>
</div>
<p>According to MSE, Line B performs better. Recall, this is what ‘LinearRegression’ minimizes.</p>
<p>As a reminder, here is how MSE is computed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>lineA</th>
      <th>lineB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-1.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>-0.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>-10</td>
      <td>4</td>
      <td>-0.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>6</td>
      <td>6</td>
      <td>0.4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#compute MSE for lineA versus y by hand
((df[&quot;lineA&quot;] - df[&quot;y&quot;])**2).mean()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>49.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#now for lineB
((df[&quot;lineB&quot;] - df[&quot;y&quot;])**2).mean()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>34.300000000000004
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Import the <code class="docutils literal notranslate"><span class="pre">mean_absolute_error</span></code> function from sklearn.metrics. Which of our lines fits the data better according to this metric?</p></li>
</ul>
<p>MAE works almost exactly the same as MSE, except now we take absolute instead of squaring to deal with possible negative values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>from sklearn.metrics import mean_absolute_error
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mean_absolute_error(df[&quot;y&quot;],df[&quot;lineA&quot;])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mean_absolute_error(df[&quot;y&quot;],df[&quot;lineB&quot;])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.9
</pre></div>
</div>
</div>
</div>
<p>Notice now that lineA performs better, since it has a smaller MAE.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#let&#39;s do this computation by hand
((df[&quot;lineA&quot;] - df[&quot;y&quot;]).abs()).mean()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.5
</pre></div>
</div>
</div>
</div>
<p>Question from the chat: Which method for error is more precise?</p>
<p>No good answer; it’s going to depend on what you’re looking for in a model. One comment, is that you might be tempted to think that MAE is beter in this case because it produces smaller numbers than MSE, but this is not the case. There’s no good way to compare these different error measures. Another thing I’ve seen before (and something you can even see in this example) is that MSE tends to be more sensitive to outliers; this might be something to consider, depending on your data.</p>
<p>Main takeaways from this portion of the lecture: different performance measures will lead to different definitions of “best” fit. In theory, the smallest possible MSE/MAE woud be zero, but in this case it’s impossible since no line can go through all 4 data points. This is similar to real life examples as well, we never expect our data to be perfectly linear.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mean_squared_error(df[&quot;y&quot;],df[&quot;y&quot;])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="more-on-polynomial-regression">
<h2>More on Polynomial Regression<a class="headerlink" href="#more-on-polynomial-regression" title="Permalink to this headline">#</a></h2>
<p>In the last lecture, we saw how to fit our data to a degree three polynomial. This took quite a bit of work, so the focus of this portion of the lecture will be on how to automate some of those steps.</p>
<section id="generating-random-data">
<h3>Generating Random Data<a class="headerlink" href="#generating-random-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>deg = 3
rng = np.random.default_rng(seed=27)
m = rng.integers(low=-5, high=5, size=deg+1)
print(m)
df = pd.DataFrame({&quot;x&quot;: np.arange(-3, 2, 0.1)})
df[&quot;y_true&quot;] = 0
for i in range(len(m)):
    df[&quot;y_true&quot;] += m[i]*df[&quot;x&quot;]**i

df[&quot;y&quot;] = df[&quot;y_true&quot;] + rng.normal(scale=5, size=len(df))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-5  1 -3 -2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y_true</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-3.000000e+00</td>
      <td>19.000</td>
      <td>23.824406</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-2.900000e+00</td>
      <td>15.648</td>
      <td>10.237108</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-2.800000e+00</td>
      <td>12.584</td>
      <td>16.919087</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-2.700000e+00</td>
      <td>9.796</td>
      <td>8.955196</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-2.600000e+00</td>
      <td>7.272</td>
      <td>6.323695</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-2.500000e+00</td>
      <td>5.000</td>
      <td>10.602832</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-2.400000e+00</td>
      <td>2.968</td>
      <td>0.784105</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-2.300000e+00</td>
      <td>1.164</td>
      <td>-5.234227</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-2.200000e+00</td>
      <td>-0.424</td>
      <td>-2.771499</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-2.100000e+00</td>
      <td>-1.808</td>
      <td>-7.792136</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-2.000000e+00</td>
      <td>-3.000</td>
      <td>-12.199286</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-1.900000e+00</td>
      <td>-4.012</td>
      <td>-4.739785</td>
    </tr>
    <tr>
      <th>12</th>
      <td>-1.800000e+00</td>
      <td>-4.856</td>
      <td>-2.864605</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-1.700000e+00</td>
      <td>-5.544</td>
      <td>-16.354306</td>
    </tr>
    <tr>
      <th>14</th>
      <td>-1.600000e+00</td>
      <td>-6.088</td>
      <td>-6.015613</td>
    </tr>
    <tr>
      <th>15</th>
      <td>-1.500000e+00</td>
      <td>-6.500</td>
      <td>-5.224009</td>
    </tr>
    <tr>
      <th>16</th>
      <td>-1.400000e+00</td>
      <td>-6.792</td>
      <td>-5.926045</td>
    </tr>
    <tr>
      <th>17</th>
      <td>-1.300000e+00</td>
      <td>-6.976</td>
      <td>-13.326468</td>
    </tr>
    <tr>
      <th>18</th>
      <td>-1.200000e+00</td>
      <td>-7.064</td>
      <td>-8.618807</td>
    </tr>
    <tr>
      <th>19</th>
      <td>-1.100000e+00</td>
      <td>-7.068</td>
      <td>-7.999078</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-1.000000e+00</td>
      <td>-7.000</td>
      <td>-4.835120</td>
    </tr>
    <tr>
      <th>21</th>
      <td>-9.000000e-01</td>
      <td>-6.872</td>
      <td>-13.308757</td>
    </tr>
    <tr>
      <th>22</th>
      <td>-8.000000e-01</td>
      <td>-6.696</td>
      <td>-4.778936</td>
    </tr>
    <tr>
      <th>23</th>
      <td>-7.000000e-01</td>
      <td>-6.484</td>
      <td>-1.524600</td>
    </tr>
    <tr>
      <th>24</th>
      <td>-6.000000e-01</td>
      <td>-6.248</td>
      <td>-17.686227</td>
    </tr>
    <tr>
      <th>25</th>
      <td>-5.000000e-01</td>
      <td>-6.000</td>
      <td>-4.880304</td>
    </tr>
    <tr>
      <th>26</th>
      <td>-4.000000e-01</td>
      <td>-5.752</td>
      <td>-13.385067</td>
    </tr>
    <tr>
      <th>27</th>
      <td>-3.000000e-01</td>
      <td>-5.516</td>
      <td>-6.368335</td>
    </tr>
    <tr>
      <th>28</th>
      <td>-2.000000e-01</td>
      <td>-5.304</td>
      <td>-8.704742</td>
    </tr>
    <tr>
      <th>29</th>
      <td>-1.000000e-01</td>
      <td>-5.128</td>
      <td>1.240175</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2.664535e-15</td>
      <td>-5.000</td>
      <td>-4.714457</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1.000000e-01</td>
      <td>-4.932</td>
      <td>-0.955557</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2.000000e-01</td>
      <td>-4.936</td>
      <td>-10.169895</td>
    </tr>
    <tr>
      <th>33</th>
      <td>3.000000e-01</td>
      <td>-5.024</td>
      <td>-2.721364</td>
    </tr>
    <tr>
      <th>34</th>
      <td>4.000000e-01</td>
      <td>-5.208</td>
      <td>1.903864</td>
    </tr>
    <tr>
      <th>35</th>
      <td>5.000000e-01</td>
      <td>-5.500</td>
      <td>-9.036285</td>
    </tr>
    <tr>
      <th>36</th>
      <td>6.000000e-01</td>
      <td>-5.912</td>
      <td>-2.582631</td>
    </tr>
    <tr>
      <th>37</th>
      <td>7.000000e-01</td>
      <td>-6.456</td>
      <td>-4.049151</td>
    </tr>
    <tr>
      <th>38</th>
      <td>8.000000e-01</td>
      <td>-7.144</td>
      <td>-7.467370</td>
    </tr>
    <tr>
      <th>39</th>
      <td>9.000000e-01</td>
      <td>-7.988</td>
      <td>-14.245467</td>
    </tr>
    <tr>
      <th>40</th>
      <td>1.000000e+00</td>
      <td>-9.000</td>
      <td>-7.584490</td>
    </tr>
    <tr>
      <th>41</th>
      <td>1.100000e+00</td>
      <td>-10.192</td>
      <td>-11.543440</td>
    </tr>
    <tr>
      <th>42</th>
      <td>1.200000e+00</td>
      <td>-11.576</td>
      <td>-8.565901</td>
    </tr>
    <tr>
      <th>43</th>
      <td>1.300000e+00</td>
      <td>-13.164</td>
      <td>-9.269588</td>
    </tr>
    <tr>
      <th>44</th>
      <td>1.400000e+00</td>
      <td>-14.968</td>
      <td>-7.295300</td>
    </tr>
    <tr>
      <th>45</th>
      <td>1.500000e+00</td>
      <td>-17.000</td>
      <td>-21.182783</td>
    </tr>
    <tr>
      <th>46</th>
      <td>1.600000e+00</td>
      <td>-19.272</td>
      <td>-14.946791</td>
    </tr>
    <tr>
      <th>47</th>
      <td>1.700000e+00</td>
      <td>-21.796</td>
      <td>-18.291899</td>
    </tr>
    <tr>
      <th>48</th>
      <td>1.800000e+00</td>
      <td>-24.584</td>
      <td>-24.206884</td>
    </tr>
    <tr>
      <th>49</th>
      <td>1.900000e+00</td>
      <td>-27.648</td>
      <td>-24.589037</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s pick through the above code in a little more depth</p>
<ul class="simple">
<li><p>I’m trying to generate data that fits a cubic polynomial. Notice <code class="docutils literal notranslate"><span class="pre">deg</span> <span class="pre">=</span> <span class="pre">3</span></code> makes it easy to change the code if I want to pick a polynomial of a different degree.</p></li>
<li><p>The line <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">=</span> <span class="pre">rng.integers...</span></code> is picking <code class="docutils literal notranslate"><span class="pre">deg+1</span></code> random integers between -5 and 5, these will serve as the coefficients for our cubic polynomial: <span class="math notranslate nohighlight">\(c_3x^3 + c_2x^2 + c_1x + c_0\)</span>.</p></li>
<li><p>Then we create a DataFrame that stores x values.</p></li>
<li><p>Lines 7-8 of the code build the polynomial for each value of x. The column “y_true” has perfectly cubic data.</p></li>
<li><p>The last part of the code adds random noise to our data so that it is not perfectly cubic. Notice we use normally distributed random numbers instead of uniformly distributed random numbers (from [0,1]) so that my noise is not all within 1 unit of the actualy data.</p></li>
</ul>
<p>Notice, we can improve the code above by using enumerate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>m
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-5,  1, -3, -2])
</pre></div>
</div>
</div>
</div>
<p>Recall that enumerate pairs the values of m with corresponding indices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>list(enumerate(m))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(0, -5), (1, 1), (2, -3), (3, -2)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>help(enumerate)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on class enumerate in module builtins:

class enumerate(object)
 |  enumerate(iterable, start=0)
 |  
 |  Return an enumerate object.
 |  
 |    iterable
 |      an object supporting iteration
 |  
 |  The enumerate object yields pairs containing a count (from start, which
 |  defaults to zero) and a value yielded by the iterable argument.
 |  
 |  enumerate is useful for obtaining an indexed list:
 |      (0, seq[0]), (1, seq[1]), (2, seq[2]), ...
 |  
 |  Methods defined here:
 |  
 |  __getattribute__(self, name, /)
 |      Return getattr(self, name).
 |  
 |  __iter__(self, /)
 |      Implement iter(self).
 |  
 |  __next__(self, /)
 |      Implement next(self).
 |  
 |  __reduce__(...)
 |      Return state information for pickling.
 |  
 |  ----------------------------------------------------------------------
 |  Class methods defined here:
 |  
 |  __class_getitem__(...) from builtins.type
 |      See PEP 585
 |  
 |  ----------------------------------------------------------------------
 |  Static methods defined here:
 |  
 |  __new__(*args, **kwargs) from builtins.type
 |      Create and return a new object.  See help(type) for accurate signature.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>deg = 3
rng = np.random.default_rng(seed=27)
m = rng.integers(low=-5, high=5, size=deg+1)
print(m)
df = pd.DataFrame({&quot;x&quot;: np.arange(-3, 2, 0.1)})
df[&quot;y_true&quot;] = 0
for c in enumerate(m):
    df[&quot;y_true&quot;] += c[1]*df[&quot;x&quot;]**c[0]

df[&quot;y&quot;] = df[&quot;y_true&quot;] + rng.normal(scale=5, size=len(df))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-5  1 -3 -2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>for c in enumerate(m):
    print(c)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, -5)
(1, 1)
(2, -3)
(3, -2)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Plot the noisy data so we have an idea of how it looks. Call the resulting chart <code class="docutils literal notranslate"><span class="pre">c1</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>c1 = alt.Chart(df).mark_circle().encode(
    x=&quot;x&quot;,
    y=&quot;y&quot;
)
c1
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-69725be05f2b4996a33c774f79651fcd.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-69725be05f2b4996a33c774f79651fcd.vega-embed details,
  #altair-viz-69725be05f2b4996a33c774f79651fcd.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-69725be05f2b4996a33c774f79651fcd"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-69725be05f2b4996a33c774f79651fcd") {
      outputDiv = document.getElementById("altair-viz-69725be05f2b4996a33c774f79651fcd");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-dae704ec33fdd0f59cc04c6673678175"}, "mark": {"type": "circle"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-dae704ec33fdd0f59cc04c6673678175": [{"x": -3.0, "y_true": 19.0, "y": 23.824405650704584}, {"x": -2.9, "y_true": 15.647999999999996, "y": 10.237108055098796}, {"x": -2.8, "y_true": 12.583999999999993, "y": 16.91908679057319}, {"x": -2.6999999999999997, "y_true": 9.795999999999992, "y": 8.955196204317206}, {"x": -2.5999999999999996, "y_true": 7.271999999999991, "y": 6.323695104370164}, {"x": -2.4999999999999996, "y_true": 4.999999999999989, "y": 10.602832278036008}, {"x": -2.3999999999999995, "y_true": 2.967999999999993, "y": 0.7841046813223418}, {"x": -2.2999999999999994, "y_true": 1.1639999999999908, "y": -5.234226812329393}, {"x": -2.1999999999999993, "y_true": -0.4240000000000137, "y": -2.7714988713165125}, {"x": -2.099999999999999, "y_true": -1.808000000000014, "y": -7.792135811821553}, {"x": -1.9999999999999991, "y_true": -3.0000000000000107, "y": -12.199285711986715}, {"x": -1.899999999999999, "y_true": -4.012000000000011, "y": -4.739784849269134}, {"x": -1.799999999999999, "y_true": -4.856000000000009, "y": -2.864605133958004}, {"x": -1.6999999999999988, "y_true": -5.544000000000008, "y": -16.3543063737946}, {"x": -1.5999999999999988, "y_true": -6.088000000000006, "y": -6.015613468222883}, {"x": -1.4999999999999987, "y_true": -6.5000000000000036, "y": -5.224009421444809}, {"x": -1.3999999999999986, "y_true": -6.792000000000003, "y": -5.926044796345713}, {"x": -1.2999999999999985, "y_true": -6.976000000000002, "y": -13.326467602050318}, {"x": -1.1999999999999984, "y_true": -7.064000000000001, "y": -8.618806640209073}, {"x": -1.0999999999999983, "y_true": -7.067999999999998, "y": -7.999078323585601}, {"x": -0.9999999999999982, "y_true": -6.999999999999998, "y": -4.835119581575062}, {"x": -0.8999999999999981, "y_true": -6.871999999999996, "y": -13.308756625035866}, {"x": -0.799999999999998, "y_true": -6.695999999999996, "y": -4.778936156426603}, {"x": -0.699999999999998, "y_true": -6.4839999999999955, "y": -1.524599833485449}, {"x": -0.5999999999999979, "y_true": -6.247999999999995, "y": -17.68622693729956}, {"x": -0.4999999999999978, "y_true": -5.999999999999995, "y": -4.880304361628128}, {"x": -0.3999999999999977, "y_true": -5.7519999999999945, "y": -13.38506705601617}, {"x": -0.2999999999999976, "y_true": -5.515999999999995, "y": -6.368334641163491}, {"x": -0.1999999999999975, "y_true": -5.303999999999996, "y": -8.704741835733941}, {"x": -0.09999999999999742, "y_true": -5.127999999999997, "y": 1.2401753336845394}, {"x": 2.6645352591003757e-15, "y_true": -4.999999999999997, "y": -4.71445657964094}, {"x": 0.10000000000000275, "y_true": -4.931999999999999, "y": -0.9555565402837516}, {"x": 0.20000000000000284, "y_true": -4.936000000000002, "y": -10.16989462767013}, {"x": 0.30000000000000293, "y_true": -5.024000000000004, "y": -2.7213636464572986}, {"x": 0.400000000000003, "y_true": -5.208000000000007, "y": 1.90386367809573}, {"x": 0.5000000000000031, "y_true": -5.50000000000001, "y": -9.036284597169002}, {"x": 0.6000000000000032, "y_true": -5.912000000000015, "y": -2.5826311606487367}, {"x": 0.7000000000000033, "y_true": -6.456000000000021, "y": -4.049151482825412}, {"x": 0.8000000000000034, "y_true": -7.144000000000027, "y": -7.467369873682661}, {"x": 0.9000000000000035, "y_true": -7.988000000000032, "y": -14.245467115049165}, {"x": 1.0000000000000036, "y_true": -9.000000000000039, "y": -7.58449011919938}, {"x": 1.1000000000000032, "y_true": -10.192000000000041, "y": -11.5434400342294}, {"x": 1.2000000000000037, "y_true": -11.576000000000054, "y": -8.565901471871978}, {"x": 1.3000000000000043, "y_true": -13.164000000000073, "y": -9.269587854684678}, {"x": 1.400000000000004, "y_true": -14.968000000000075, "y": -7.295299533414727}, {"x": 1.5000000000000036, "y_true": -17.000000000000078, "y": -21.18278332190194}, {"x": 1.600000000000004, "y_true": -19.272000000000098, "y": -14.946790703056552}, {"x": 1.7000000000000046, "y_true": -21.796000000000124, "y": -18.291898867126424}, {"x": 1.8000000000000043, "y_true": -24.584000000000124, "y": -24.2068839018185}, {"x": 1.900000000000004, "y_true": -27.648000000000124, "y": -24.589036941447688}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Notice that our data looks roughly cubic, but not perfectly so. This is a good thing! We’ll see if sklearn can estimate the curve :)</p>
</section>
<section id="polynomialfeatures">
<h3>PolynomialFeatures<a class="headerlink" href="#polynomialfeatures" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Demonstrate the <code class="docutils literal notranslate"><span class="pre">PolynomialFeatures</span></code> class from <code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing</span></code> by evaluating it on the “x” column in <code class="docutils literal notranslate"><span class="pre">df</span></code>. Use a <code class="docutils literal notranslate"><span class="pre">degree</span></code> value of 3.
Note: this class uses <code class="docutils literal notranslate"><span class="pre">transform</span></code> rather than <code class="docutils literal notranslate"><span class="pre">predict</span></code> in the final step.</p></li>
</ul>
<p>We still have our usual workflow:
import &gt; instantiate &gt; fit &gt; transform</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>from sklearn.preprocessing import PolynomialFeatures
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>poly = PolynomialFeatures(degree=3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>type(poly)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sklearn.preprocessing._polynomial.PolynomialFeatures
</pre></div>
</div>
</div>
</div>
<p>This is a new-to-us object from sklearn!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y_true</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-3.000000e+00</td>
      <td>19.000</td>
      <td>23.824406</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-2.900000e+00</td>
      <td>15.648</td>
      <td>10.237108</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-2.800000e+00</td>
      <td>12.584</td>
      <td>16.919087</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-2.700000e+00</td>
      <td>9.796</td>
      <td>8.955196</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-2.600000e+00</td>
      <td>7.272</td>
      <td>6.323695</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-2.500000e+00</td>
      <td>5.000</td>
      <td>10.602832</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-2.400000e+00</td>
      <td>2.968</td>
      <td>0.784105</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-2.300000e+00</td>
      <td>1.164</td>
      <td>-5.234227</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-2.200000e+00</td>
      <td>-0.424</td>
      <td>-2.771499</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-2.100000e+00</td>
      <td>-1.808</td>
      <td>-7.792136</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-2.000000e+00</td>
      <td>-3.000</td>
      <td>-12.199286</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-1.900000e+00</td>
      <td>-4.012</td>
      <td>-4.739785</td>
    </tr>
    <tr>
      <th>12</th>
      <td>-1.800000e+00</td>
      <td>-4.856</td>
      <td>-2.864605</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-1.700000e+00</td>
      <td>-5.544</td>
      <td>-16.354306</td>
    </tr>
    <tr>
      <th>14</th>
      <td>-1.600000e+00</td>
      <td>-6.088</td>
      <td>-6.015613</td>
    </tr>
    <tr>
      <th>15</th>
      <td>-1.500000e+00</td>
      <td>-6.500</td>
      <td>-5.224009</td>
    </tr>
    <tr>
      <th>16</th>
      <td>-1.400000e+00</td>
      <td>-6.792</td>
      <td>-5.926045</td>
    </tr>
    <tr>
      <th>17</th>
      <td>-1.300000e+00</td>
      <td>-6.976</td>
      <td>-13.326468</td>
    </tr>
    <tr>
      <th>18</th>
      <td>-1.200000e+00</td>
      <td>-7.064</td>
      <td>-8.618807</td>
    </tr>
    <tr>
      <th>19</th>
      <td>-1.100000e+00</td>
      <td>-7.068</td>
      <td>-7.999078</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-1.000000e+00</td>
      <td>-7.000</td>
      <td>-4.835120</td>
    </tr>
    <tr>
      <th>21</th>
      <td>-9.000000e-01</td>
      <td>-6.872</td>
      <td>-13.308757</td>
    </tr>
    <tr>
      <th>22</th>
      <td>-8.000000e-01</td>
      <td>-6.696</td>
      <td>-4.778936</td>
    </tr>
    <tr>
      <th>23</th>
      <td>-7.000000e-01</td>
      <td>-6.484</td>
      <td>-1.524600</td>
    </tr>
    <tr>
      <th>24</th>
      <td>-6.000000e-01</td>
      <td>-6.248</td>
      <td>-17.686227</td>
    </tr>
    <tr>
      <th>25</th>
      <td>-5.000000e-01</td>
      <td>-6.000</td>
      <td>-4.880304</td>
    </tr>
    <tr>
      <th>26</th>
      <td>-4.000000e-01</td>
      <td>-5.752</td>
      <td>-13.385067</td>
    </tr>
    <tr>
      <th>27</th>
      <td>-3.000000e-01</td>
      <td>-5.516</td>
      <td>-6.368335</td>
    </tr>
    <tr>
      <th>28</th>
      <td>-2.000000e-01</td>
      <td>-5.304</td>
      <td>-8.704742</td>
    </tr>
    <tr>
      <th>29</th>
      <td>-1.000000e-01</td>
      <td>-5.128</td>
      <td>1.240175</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2.664535e-15</td>
      <td>-5.000</td>
      <td>-4.714457</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1.000000e-01</td>
      <td>-4.932</td>
      <td>-0.955557</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2.000000e-01</td>
      <td>-4.936</td>
      <td>-10.169895</td>
    </tr>
    <tr>
      <th>33</th>
      <td>3.000000e-01</td>
      <td>-5.024</td>
      <td>-2.721364</td>
    </tr>
    <tr>
      <th>34</th>
      <td>4.000000e-01</td>
      <td>-5.208</td>
      <td>1.903864</td>
    </tr>
    <tr>
      <th>35</th>
      <td>5.000000e-01</td>
      <td>-5.500</td>
      <td>-9.036285</td>
    </tr>
    <tr>
      <th>36</th>
      <td>6.000000e-01</td>
      <td>-5.912</td>
      <td>-2.582631</td>
    </tr>
    <tr>
      <th>37</th>
      <td>7.000000e-01</td>
      <td>-6.456</td>
      <td>-4.049151</td>
    </tr>
    <tr>
      <th>38</th>
      <td>8.000000e-01</td>
      <td>-7.144</td>
      <td>-7.467370</td>
    </tr>
    <tr>
      <th>39</th>
      <td>9.000000e-01</td>
      <td>-7.988</td>
      <td>-14.245467</td>
    </tr>
    <tr>
      <th>40</th>
      <td>1.000000e+00</td>
      <td>-9.000</td>
      <td>-7.584490</td>
    </tr>
    <tr>
      <th>41</th>
      <td>1.100000e+00</td>
      <td>-10.192</td>
      <td>-11.543440</td>
    </tr>
    <tr>
      <th>42</th>
      <td>1.200000e+00</td>
      <td>-11.576</td>
      <td>-8.565901</td>
    </tr>
    <tr>
      <th>43</th>
      <td>1.300000e+00</td>
      <td>-13.164</td>
      <td>-9.269588</td>
    </tr>
    <tr>
      <th>44</th>
      <td>1.400000e+00</td>
      <td>-14.968</td>
      <td>-7.295300</td>
    </tr>
    <tr>
      <th>45</th>
      <td>1.500000e+00</td>
      <td>-17.000</td>
      <td>-21.182783</td>
    </tr>
    <tr>
      <th>46</th>
      <td>1.600000e+00</td>
      <td>-19.272</td>
      <td>-14.946791</td>
    </tr>
    <tr>
      <th>47</th>
      <td>1.700000e+00</td>
      <td>-21.796</td>
      <td>-18.291899</td>
    </tr>
    <tr>
      <th>48</th>
      <td>1.800000e+00</td>
      <td>-24.584</td>
      <td>-24.206884</td>
    </tr>
    <tr>
      <th>49</th>
      <td>1.900000e+00</td>
      <td>-27.648</td>
      <td>-24.589037</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>poly.fit(df[[&quot;x&quot;]])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>PolynomialFeatures(degree=3)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">PolynomialFeatures</label><div class="sk-toggleable__content"><pre>PolynomialFeatures(degree=3)</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#gives an error :(
poly.predict(df[[&quot;x&quot;]])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">44</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">#gives an error :(</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;x&quot;</span><span class="p">]])</span>

<span class="ne">AttributeError</span>: &#39;PolynomialFeatures&#39; object has no attribute &#39;predict&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#notice this result is kind of difficult to understand
poly.transform(df[[&quot;x&quot;]])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.00000000e+00, -3.00000000e+00,  9.00000000e+00,
        -2.70000000e+01],
       [ 1.00000000e+00, -2.90000000e+00,  8.41000000e+00,
        -2.43890000e+01],
       [ 1.00000000e+00, -2.80000000e+00,  7.84000000e+00,
        -2.19520000e+01],
       [ 1.00000000e+00, -2.70000000e+00,  7.29000000e+00,
        -1.96830000e+01],
       [ 1.00000000e+00, -2.60000000e+00,  6.76000000e+00,
        -1.75760000e+01],
       [ 1.00000000e+00, -2.50000000e+00,  6.25000000e+00,
        -1.56250000e+01],
       [ 1.00000000e+00, -2.40000000e+00,  5.76000000e+00,
        -1.38240000e+01],
       [ 1.00000000e+00, -2.30000000e+00,  5.29000000e+00,
        -1.21670000e+01],
       [ 1.00000000e+00, -2.20000000e+00,  4.84000000e+00,
        -1.06480000e+01],
       [ 1.00000000e+00, -2.10000000e+00,  4.41000000e+00,
        -9.26100000e+00],
       [ 1.00000000e+00, -2.00000000e+00,  4.00000000e+00,
        -8.00000000e+00],
       [ 1.00000000e+00, -1.90000000e+00,  3.61000000e+00,
        -6.85900000e+00],
       [ 1.00000000e+00, -1.80000000e+00,  3.24000000e+00,
        -5.83200000e+00],
       [ 1.00000000e+00, -1.70000000e+00,  2.89000000e+00,
        -4.91300000e+00],
       [ 1.00000000e+00, -1.60000000e+00,  2.56000000e+00,
        -4.09600000e+00],
       [ 1.00000000e+00, -1.50000000e+00,  2.25000000e+00,
        -3.37500000e+00],
       [ 1.00000000e+00, -1.40000000e+00,  1.96000000e+00,
        -2.74400000e+00],
       [ 1.00000000e+00, -1.30000000e+00,  1.69000000e+00,
        -2.19700000e+00],
       [ 1.00000000e+00, -1.20000000e+00,  1.44000000e+00,
        -1.72800000e+00],
       [ 1.00000000e+00, -1.10000000e+00,  1.21000000e+00,
        -1.33100000e+00],
       [ 1.00000000e+00, -1.00000000e+00,  1.00000000e+00,
        -1.00000000e+00],
       [ 1.00000000e+00, -9.00000000e-01,  8.10000000e-01,
        -7.29000000e-01],
       [ 1.00000000e+00, -8.00000000e-01,  6.40000000e-01,
        -5.12000000e-01],
       [ 1.00000000e+00, -7.00000000e-01,  4.90000000e-01,
        -3.43000000e-01],
       [ 1.00000000e+00, -6.00000000e-01,  3.60000000e-01,
        -2.16000000e-01],
       [ 1.00000000e+00, -5.00000000e-01,  2.50000000e-01,
        -1.25000000e-01],
       [ 1.00000000e+00, -4.00000000e-01,  1.60000000e-01,
        -6.40000000e-02],
       [ 1.00000000e+00, -3.00000000e-01,  9.00000000e-02,
        -2.70000000e-02],
       [ 1.00000000e+00, -2.00000000e-01,  4.00000000e-02,
        -8.00000000e-03],
       [ 1.00000000e+00, -1.00000000e-01,  1.00000000e-02,
        -1.00000000e-03],
       [ 1.00000000e+00,  2.66453526e-15,  7.09974815e-30,
         1.89175293e-44],
       [ 1.00000000e+00,  1.00000000e-01,  1.00000000e-02,
         1.00000000e-03],
       [ 1.00000000e+00,  2.00000000e-01,  4.00000000e-02,
         8.00000000e-03],
       [ 1.00000000e+00,  3.00000000e-01,  9.00000000e-02,
         2.70000000e-02],
       [ 1.00000000e+00,  4.00000000e-01,  1.60000000e-01,
         6.40000000e-02],
       [ 1.00000000e+00,  5.00000000e-01,  2.50000000e-01,
         1.25000000e-01],
       [ 1.00000000e+00,  6.00000000e-01,  3.60000000e-01,
         2.16000000e-01],
       [ 1.00000000e+00,  7.00000000e-01,  4.90000000e-01,
         3.43000000e-01],
       [ 1.00000000e+00,  8.00000000e-01,  6.40000000e-01,
         5.12000000e-01],
       [ 1.00000000e+00,  9.00000000e-01,  8.10000000e-01,
         7.29000000e-01],
       [ 1.00000000e+00,  1.00000000e+00,  1.00000000e+00,
         1.00000000e+00],
       [ 1.00000000e+00,  1.10000000e+00,  1.21000000e+00,
         1.33100000e+00],
       [ 1.00000000e+00,  1.20000000e+00,  1.44000000e+00,
         1.72800000e+00],
       [ 1.00000000e+00,  1.30000000e+00,  1.69000000e+00,
         2.19700000e+00],
       [ 1.00000000e+00,  1.40000000e+00,  1.96000000e+00,
         2.74400000e+00],
       [ 1.00000000e+00,  1.50000000e+00,  2.25000000e+00,
         3.37500000e+00],
       [ 1.00000000e+00,  1.60000000e+00,  2.56000000e+00,
         4.09600000e+00],
       [ 1.00000000e+00,  1.70000000e+00,  2.89000000e+00,
         4.91300000e+00],
       [ 1.00000000e+00,  1.80000000e+00,  3.24000000e+00,
         5.83200000e+00],
       [ 1.00000000e+00,  1.90000000e+00,  3.61000000e+00,
         6.85900000e+00]])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>To make the result easier to read, put the transformed data into a pandas DataFrame named <code class="docutils literal notranslate"><span class="pre">df_poly</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df_poly = pd.DataFrame(poly.transform(df[[&quot;x&quot;]]))
df_poly
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>-3.000000e+00</td>
      <td>9.000000e+00</td>
      <td>-2.700000e+01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>-2.900000e+00</td>
      <td>8.410000e+00</td>
      <td>-2.438900e+01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>-2.800000e+00</td>
      <td>7.840000e+00</td>
      <td>-2.195200e+01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>-2.700000e+00</td>
      <td>7.290000e+00</td>
      <td>-1.968300e+01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>-2.600000e+00</td>
      <td>6.760000e+00</td>
      <td>-1.757600e+01</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.0</td>
      <td>-2.500000e+00</td>
      <td>6.250000e+00</td>
      <td>-1.562500e+01</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.0</td>
      <td>-2.400000e+00</td>
      <td>5.760000e+00</td>
      <td>-1.382400e+01</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.0</td>
      <td>-2.300000e+00</td>
      <td>5.290000e+00</td>
      <td>-1.216700e+01</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.0</td>
      <td>-2.200000e+00</td>
      <td>4.840000e+00</td>
      <td>-1.064800e+01</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.0</td>
      <td>-2.100000e+00</td>
      <td>4.410000e+00</td>
      <td>-9.261000e+00</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.0</td>
      <td>-2.000000e+00</td>
      <td>4.000000e+00</td>
      <td>-8.000000e+00</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.0</td>
      <td>-1.900000e+00</td>
      <td>3.610000e+00</td>
      <td>-6.859000e+00</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.0</td>
      <td>-1.800000e+00</td>
      <td>3.240000e+00</td>
      <td>-5.832000e+00</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1.0</td>
      <td>-1.700000e+00</td>
      <td>2.890000e+00</td>
      <td>-4.913000e+00</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.0</td>
      <td>-1.600000e+00</td>
      <td>2.560000e+00</td>
      <td>-4.096000e+00</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1.0</td>
      <td>-1.500000e+00</td>
      <td>2.250000e+00</td>
      <td>-3.375000e+00</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1.0</td>
      <td>-1.400000e+00</td>
      <td>1.960000e+00</td>
      <td>-2.744000e+00</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1.0</td>
      <td>-1.300000e+00</td>
      <td>1.690000e+00</td>
      <td>-2.197000e+00</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1.0</td>
      <td>-1.200000e+00</td>
      <td>1.440000e+00</td>
      <td>-1.728000e+00</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1.0</td>
      <td>-1.100000e+00</td>
      <td>1.210000e+00</td>
      <td>-1.331000e+00</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1.0</td>
      <td>-1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>-1.000000e+00</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.0</td>
      <td>-9.000000e-01</td>
      <td>8.100000e-01</td>
      <td>-7.290000e-01</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1.0</td>
      <td>-8.000000e-01</td>
      <td>6.400000e-01</td>
      <td>-5.120000e-01</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1.0</td>
      <td>-7.000000e-01</td>
      <td>4.900000e-01</td>
      <td>-3.430000e-01</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1.0</td>
      <td>-6.000000e-01</td>
      <td>3.600000e-01</td>
      <td>-2.160000e-01</td>
    </tr>
    <tr>
      <th>25</th>
      <td>1.0</td>
      <td>-5.000000e-01</td>
      <td>2.500000e-01</td>
      <td>-1.250000e-01</td>
    </tr>
    <tr>
      <th>26</th>
      <td>1.0</td>
      <td>-4.000000e-01</td>
      <td>1.600000e-01</td>
      <td>-6.400000e-02</td>
    </tr>
    <tr>
      <th>27</th>
      <td>1.0</td>
      <td>-3.000000e-01</td>
      <td>9.000000e-02</td>
      <td>-2.700000e-02</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1.0</td>
      <td>-2.000000e-01</td>
      <td>4.000000e-02</td>
      <td>-8.000000e-03</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1.0</td>
      <td>-1.000000e-01</td>
      <td>1.000000e-02</td>
      <td>-1.000000e-03</td>
    </tr>
    <tr>
      <th>30</th>
      <td>1.0</td>
      <td>2.664535e-15</td>
      <td>7.099748e-30</td>
      <td>1.891753e-44</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1.0</td>
      <td>1.000000e-01</td>
      <td>1.000000e-02</td>
      <td>1.000000e-03</td>
    </tr>
    <tr>
      <th>32</th>
      <td>1.0</td>
      <td>2.000000e-01</td>
      <td>4.000000e-02</td>
      <td>8.000000e-03</td>
    </tr>
    <tr>
      <th>33</th>
      <td>1.0</td>
      <td>3.000000e-01</td>
      <td>9.000000e-02</td>
      <td>2.700000e-02</td>
    </tr>
    <tr>
      <th>34</th>
      <td>1.0</td>
      <td>4.000000e-01</td>
      <td>1.600000e-01</td>
      <td>6.400000e-02</td>
    </tr>
    <tr>
      <th>35</th>
      <td>1.0</td>
      <td>5.000000e-01</td>
      <td>2.500000e-01</td>
      <td>1.250000e-01</td>
    </tr>
    <tr>
      <th>36</th>
      <td>1.0</td>
      <td>6.000000e-01</td>
      <td>3.600000e-01</td>
      <td>2.160000e-01</td>
    </tr>
    <tr>
      <th>37</th>
      <td>1.0</td>
      <td>7.000000e-01</td>
      <td>4.900000e-01</td>
      <td>3.430000e-01</td>
    </tr>
    <tr>
      <th>38</th>
      <td>1.0</td>
      <td>8.000000e-01</td>
      <td>6.400000e-01</td>
      <td>5.120000e-01</td>
    </tr>
    <tr>
      <th>39</th>
      <td>1.0</td>
      <td>9.000000e-01</td>
      <td>8.100000e-01</td>
      <td>7.290000e-01</td>
    </tr>
    <tr>
      <th>40</th>
      <td>1.0</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>41</th>
      <td>1.0</td>
      <td>1.100000e+00</td>
      <td>1.210000e+00</td>
      <td>1.331000e+00</td>
    </tr>
    <tr>
      <th>42</th>
      <td>1.0</td>
      <td>1.200000e+00</td>
      <td>1.440000e+00</td>
      <td>1.728000e+00</td>
    </tr>
    <tr>
      <th>43</th>
      <td>1.0</td>
      <td>1.300000e+00</td>
      <td>1.690000e+00</td>
      <td>2.197000e+00</td>
    </tr>
    <tr>
      <th>44</th>
      <td>1.0</td>
      <td>1.400000e+00</td>
      <td>1.960000e+00</td>
      <td>2.744000e+00</td>
    </tr>
    <tr>
      <th>45</th>
      <td>1.0</td>
      <td>1.500000e+00</td>
      <td>2.250000e+00</td>
      <td>3.375000e+00</td>
    </tr>
    <tr>
      <th>46</th>
      <td>1.0</td>
      <td>1.600000e+00</td>
      <td>2.560000e+00</td>
      <td>4.096000e+00</td>
    </tr>
    <tr>
      <th>47</th>
      <td>1.0</td>
      <td>1.700000e+00</td>
      <td>2.890000e+00</td>
      <td>4.913000e+00</td>
    </tr>
    <tr>
      <th>48</th>
      <td>1.0</td>
      <td>1.800000e+00</td>
      <td>3.240000e+00</td>
      <td>5.832000e+00</td>
    </tr>
    <tr>
      <th>49</th>
      <td>1.0</td>
      <td>1.900000e+00</td>
      <td>3.610000e+00</td>
      <td>6.859000e+00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y_true</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-3.000000e+00</td>
      <td>19.000</td>
      <td>23.824406</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-2.900000e+00</td>
      <td>15.648</td>
      <td>10.237108</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-2.800000e+00</td>
      <td>12.584</td>
      <td>16.919087</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-2.700000e+00</td>
      <td>9.796</td>
      <td>8.955196</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-2.600000e+00</td>
      <td>7.272</td>
      <td>6.323695</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-2.500000e+00</td>
      <td>5.000</td>
      <td>10.602832</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-2.400000e+00</td>
      <td>2.968</td>
      <td>0.784105</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-2.300000e+00</td>
      <td>1.164</td>
      <td>-5.234227</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-2.200000e+00</td>
      <td>-0.424</td>
      <td>-2.771499</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-2.100000e+00</td>
      <td>-1.808</td>
      <td>-7.792136</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-2.000000e+00</td>
      <td>-3.000</td>
      <td>-12.199286</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-1.900000e+00</td>
      <td>-4.012</td>
      <td>-4.739785</td>
    </tr>
    <tr>
      <th>12</th>
      <td>-1.800000e+00</td>
      <td>-4.856</td>
      <td>-2.864605</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-1.700000e+00</td>
      <td>-5.544</td>
      <td>-16.354306</td>
    </tr>
    <tr>
      <th>14</th>
      <td>-1.600000e+00</td>
      <td>-6.088</td>
      <td>-6.015613</td>
    </tr>
    <tr>
      <th>15</th>
      <td>-1.500000e+00</td>
      <td>-6.500</td>
      <td>-5.224009</td>
    </tr>
    <tr>
      <th>16</th>
      <td>-1.400000e+00</td>
      <td>-6.792</td>
      <td>-5.926045</td>
    </tr>
    <tr>
      <th>17</th>
      <td>-1.300000e+00</td>
      <td>-6.976</td>
      <td>-13.326468</td>
    </tr>
    <tr>
      <th>18</th>
      <td>-1.200000e+00</td>
      <td>-7.064</td>
      <td>-8.618807</td>
    </tr>
    <tr>
      <th>19</th>
      <td>-1.100000e+00</td>
      <td>-7.068</td>
      <td>-7.999078</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-1.000000e+00</td>
      <td>-7.000</td>
      <td>-4.835120</td>
    </tr>
    <tr>
      <th>21</th>
      <td>-9.000000e-01</td>
      <td>-6.872</td>
      <td>-13.308757</td>
    </tr>
    <tr>
      <th>22</th>
      <td>-8.000000e-01</td>
      <td>-6.696</td>
      <td>-4.778936</td>
    </tr>
    <tr>
      <th>23</th>
      <td>-7.000000e-01</td>
      <td>-6.484</td>
      <td>-1.524600</td>
    </tr>
    <tr>
      <th>24</th>
      <td>-6.000000e-01</td>
      <td>-6.248</td>
      <td>-17.686227</td>
    </tr>
    <tr>
      <th>25</th>
      <td>-5.000000e-01</td>
      <td>-6.000</td>
      <td>-4.880304</td>
    </tr>
    <tr>
      <th>26</th>
      <td>-4.000000e-01</td>
      <td>-5.752</td>
      <td>-13.385067</td>
    </tr>
    <tr>
      <th>27</th>
      <td>-3.000000e-01</td>
      <td>-5.516</td>
      <td>-6.368335</td>
    </tr>
    <tr>
      <th>28</th>
      <td>-2.000000e-01</td>
      <td>-5.304</td>
      <td>-8.704742</td>
    </tr>
    <tr>
      <th>29</th>
      <td>-1.000000e-01</td>
      <td>-5.128</td>
      <td>1.240175</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2.664535e-15</td>
      <td>-5.000</td>
      <td>-4.714457</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1.000000e-01</td>
      <td>-4.932</td>
      <td>-0.955557</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2.000000e-01</td>
      <td>-4.936</td>
      <td>-10.169895</td>
    </tr>
    <tr>
      <th>33</th>
      <td>3.000000e-01</td>
      <td>-5.024</td>
      <td>-2.721364</td>
    </tr>
    <tr>
      <th>34</th>
      <td>4.000000e-01</td>
      <td>-5.208</td>
      <td>1.903864</td>
    </tr>
    <tr>
      <th>35</th>
      <td>5.000000e-01</td>
      <td>-5.500</td>
      <td>-9.036285</td>
    </tr>
    <tr>
      <th>36</th>
      <td>6.000000e-01</td>
      <td>-5.912</td>
      <td>-2.582631</td>
    </tr>
    <tr>
      <th>37</th>
      <td>7.000000e-01</td>
      <td>-6.456</td>
      <td>-4.049151</td>
    </tr>
    <tr>
      <th>38</th>
      <td>8.000000e-01</td>
      <td>-7.144</td>
      <td>-7.467370</td>
    </tr>
    <tr>
      <th>39</th>
      <td>9.000000e-01</td>
      <td>-7.988</td>
      <td>-14.245467</td>
    </tr>
    <tr>
      <th>40</th>
      <td>1.000000e+00</td>
      <td>-9.000</td>
      <td>-7.584490</td>
    </tr>
    <tr>
      <th>41</th>
      <td>1.100000e+00</td>
      <td>-10.192</td>
      <td>-11.543440</td>
    </tr>
    <tr>
      <th>42</th>
      <td>1.200000e+00</td>
      <td>-11.576</td>
      <td>-8.565901</td>
    </tr>
    <tr>
      <th>43</th>
      <td>1.300000e+00</td>
      <td>-13.164</td>
      <td>-9.269588</td>
    </tr>
    <tr>
      <th>44</th>
      <td>1.400000e+00</td>
      <td>-14.968</td>
      <td>-7.295300</td>
    </tr>
    <tr>
      <th>45</th>
      <td>1.500000e+00</td>
      <td>-17.000</td>
      <td>-21.182783</td>
    </tr>
    <tr>
      <th>46</th>
      <td>1.600000e+00</td>
      <td>-19.272</td>
      <td>-14.946791</td>
    </tr>
    <tr>
      <th>47</th>
      <td>1.700000e+00</td>
      <td>-21.796</td>
      <td>-18.291899</td>
    </tr>
    <tr>
      <th>48</th>
      <td>1.800000e+00</td>
      <td>-24.584</td>
      <td>-24.206884</td>
    </tr>
    <tr>
      <th>49</th>
      <td>1.900000e+00</td>
      <td>-27.648</td>
      <td>-24.589037</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice that this is taking each x value and raising it to the corresponding power. We did this same thing last lecture, but by hand. Appreciate how much time this saved us!</p>
</section>
<section id="using-pipeline-to-combine-multiple-step">
<h3>Using <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> to combine multiple step<a class="headerlink" href="#using-pipeline-to-combine-multiple-step" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Import the <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> class from <code class="docutils literal notranslate"><span class="pre">sklearn.pipeline</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>from sklearn.pipeline import Pipeline
from sklearn.linear_model import LinearRegression
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">50</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">pipeline</span>

<span class="ne">ImportError</span>: cannot import name &#39;pipeline&#39; from &#39;sklearn.pipeline&#39; (/shared-libs/python3.9/py/lib/python3.9/site-packages/sklearn/pipeline.py)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Make an instance of this <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> class. Pass to the constructor a list of length-2 tuples, where each tuple provides a name for the step (as a string) and the constructor (like <code class="docutils literal notranslate"><span class="pre">PolynomialFeatures(???)</span></code>)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#instantiate
#I think what went wrong in lecture was the indentation
pipe = Pipeline(
    [
        (&quot;poly&quot;, PolynomialFeatures(degree=3)), 
        (&quot;reg&quot;, LinearRegression())
    ]
)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>  <span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">57</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
    <span class="p">(</span><span class="s2">&quot;poly&quot;</span><span class="p">,</span><span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                                                     <span class="o">^</span>
<span class="ne">SyntaxError</span>: invalid syntax
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Fit this object to the data.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pipe.fit(df[[&quot;x&quot;]],df[&quot;y&quot;])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;poly&#x27;, PolynomialFeatures(degree=3)),
                (&#x27;reg&#x27;, LinearRegression())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" ><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;poly&#x27;, PolynomialFeatures(degree=3)),
                (&#x27;reg&#x27;, LinearRegression())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" ><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">PolynomialFeatures</label><div class="sk-toggleable__content"><pre>PolynomialFeatures(degree=3)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" ><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div></div></div></div></div>
</div>
<p>First, it fits and transforms using PolynomialFeatures, and then it uses LinearRegression</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pipe[&quot;reg&quot;].coef_
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.        ,  3.33524206, -3.03442169, -2.32952623])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pipe[&quot;poly&quot;]
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-4 {color: black;background-color: white;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>PolynomialFeatures(degree=3)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox" checked><label for="sk-estimator-id-6" class="sk-toggleable__label sk-toggleable__label-arrow">PolynomialFeatures</label><div class="sk-toggleable__content"><pre>PolynomialFeatures(degree=3)</pre></div></div></div></div></div></div></div>
</div>
<ul class="simple">
<li><p>Call the predict method, and add the resulting values to a new column named “pred”.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df[&quot;pred&quot;] = pipe.predict(df[[&quot;x&quot;]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y_true</th>
      <th>y</th>
      <th>pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-3.000000e+00</td>
      <td>19.000</td>
      <td>23.824406</td>
      <td>20.317732</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-2.900000e+00</td>
      <td>15.648</td>
      <td>10.237108</td>
      <td>16.359172</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-2.800000e+00</td>
      <td>12.584</td>
      <td>16.919087</td>
      <td>12.745261</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-2.700000e+00</td>
      <td>9.796</td>
      <td>8.955196</td>
      <td>9.462022</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-2.600000e+00</td>
      <td>7.272</td>
      <td>6.323695</td>
      <td>6.495478</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-2.500000e+00</td>
      <td>5.000</td>
      <td>10.602832</td>
      <td>3.831652</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-2.400000e+00</td>
      <td>2.968</td>
      <td>0.784105</td>
      <td>1.456566</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-2.300000e+00</td>
      <td>1.164</td>
      <td>-5.234227</td>
      <td>-0.643757</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-2.200000e+00</td>
      <td>-0.424</td>
      <td>-2.771499</td>
      <td>-2.483293</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-2.100000e+00</td>
      <td>-1.808</td>
      <td>-7.792136</td>
      <td>-4.076020</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-2.000000e+00</td>
      <td>-3.000</td>
      <td>-12.199286</td>
      <td>-5.435916</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-1.900000e+00</td>
      <td>-4.012</td>
      <td>-4.739785</td>
      <td>-6.576957</td>
    </tr>
    <tr>
      <th>12</th>
      <td>-1.800000e+00</td>
      <td>-4.856</td>
      <td>-2.864605</td>
      <td>-7.513120</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-1.700000e+00</td>
      <td>-5.544</td>
      <td>-16.354306</td>
      <td>-8.258383</td>
    </tr>
    <tr>
      <th>14</th>
      <td>-1.600000e+00</td>
      <td>-6.088</td>
      <td>-6.015613</td>
      <td>-8.826722</td>
    </tr>
    <tr>
      <th>15</th>
      <td>-1.500000e+00</td>
      <td>-6.500</td>
      <td>-5.224009</td>
      <td>-9.232116</td>
    </tr>
    <tr>
      <th>16</th>
      <td>-1.400000e+00</td>
      <td>-6.792</td>
      <td>-5.926045</td>
      <td>-9.488540</td>
    </tr>
    <tr>
      <th>17</th>
      <td>-1.300000e+00</td>
      <td>-6.976</td>
      <td>-13.326468</td>
      <td>-9.609973</td>
    </tr>
    <tr>
      <th>18</th>
      <td>-1.200000e+00</td>
      <td>-7.064</td>
      <td>-8.618807</td>
      <td>-9.610391</td>
    </tr>
    <tr>
      <th>19</th>
      <td>-1.100000e+00</td>
      <td>-7.068</td>
      <td>-7.999078</td>
      <td>-9.503772</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-1.000000e+00</td>
      <td>-7.000</td>
      <td>-4.835120</td>
      <td>-9.304092</td>
    </tr>
    <tr>
      <th>21</th>
      <td>-9.000000e-01</td>
      <td>-6.872</td>
      <td>-13.308757</td>
      <td>-9.025330</td>
    </tr>
    <tr>
      <th>22</th>
      <td>-8.000000e-01</td>
      <td>-6.696</td>
      <td>-4.778936</td>
      <td>-8.681461</td>
    </tr>
    <tr>
      <th>23</th>
      <td>-7.000000e-01</td>
      <td>-6.484</td>
      <td>-1.524600</td>
      <td>-8.286463</td>
    </tr>
    <tr>
      <th>24</th>
      <td>-6.000000e-01</td>
      <td>-6.248</td>
      <td>-17.686227</td>
      <td>-7.854314</td>
    </tr>
    <tr>
      <th>25</th>
      <td>-5.000000e-01</td>
      <td>-6.000</td>
      <td>-4.880304</td>
      <td>-7.398990</td>
    </tr>
    <tr>
      <th>26</th>
      <td>-4.000000e-01</td>
      <td>-5.752</td>
      <td>-13.385067</td>
      <td>-6.934469</td>
    </tr>
    <tr>
      <th>27</th>
      <td>-3.000000e-01</td>
      <td>-5.516</td>
      <td>-6.368335</td>
      <td>-6.474728</td>
    </tr>
    <tr>
      <th>28</th>
      <td>-2.000000e-01</td>
      <td>-5.304</td>
      <td>-8.704742</td>
      <td>-6.033744</td>
    </tr>
    <tr>
      <th>29</th>
      <td>-1.000000e-01</td>
      <td>-5.128</td>
      <td>1.240175</td>
      <td>-5.625494</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2.664535e-15</td>
      <td>-5.000</td>
      <td>-4.714457</td>
      <td>-5.263955</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1.000000e-01</td>
      <td>-4.932</td>
      <td>-0.955557</td>
      <td>-4.963104</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2.000000e-01</td>
      <td>-4.936</td>
      <td>-10.169895</td>
      <td>-4.736919</td>
    </tr>
    <tr>
      <th>33</th>
      <td>3.000000e-01</td>
      <td>-5.024</td>
      <td>-2.721364</td>
      <td>-4.599377</td>
    </tr>
    <tr>
      <th>34</th>
      <td>4.000000e-01</td>
      <td>-5.208</td>
      <td>1.903864</td>
      <td>-4.564455</td>
    </tr>
    <tr>
      <th>35</th>
      <td>5.000000e-01</td>
      <td>-5.500</td>
      <td>-9.036285</td>
      <td>-4.646130</td>
    </tr>
    <tr>
      <th>36</th>
      <td>6.000000e-01</td>
      <td>-5.912</td>
      <td>-2.582631</td>
      <td>-4.858379</td>
    </tr>
    <tr>
      <th>37</th>
      <td>7.000000e-01</td>
      <td>-6.456</td>
      <td>-4.049151</td>
      <td>-5.215179</td>
    </tr>
    <tr>
      <th>38</th>
      <td>8.000000e-01</td>
      <td>-7.144</td>
      <td>-7.467370</td>
      <td>-5.730508</td>
    </tr>
    <tr>
      <th>39</th>
      <td>9.000000e-01</td>
      <td>-7.988</td>
      <td>-14.245467</td>
      <td>-6.418343</td>
    </tr>
    <tr>
      <th>40</th>
      <td>1.000000e+00</td>
      <td>-9.000</td>
      <td>-7.584490</td>
      <td>-7.292661</td>
    </tr>
    <tr>
      <th>41</th>
      <td>1.100000e+00</td>
      <td>-10.192</td>
      <td>-11.543440</td>
      <td>-8.367438</td>
    </tr>
    <tr>
      <th>42</th>
      <td>1.200000e+00</td>
      <td>-11.576</td>
      <td>-8.565901</td>
      <td>-9.656653</td>
    </tr>
    <tr>
      <th>43</th>
      <td>1.300000e+00</td>
      <td>-13.164</td>
      <td>-9.269588</td>
      <td>-11.174282</td>
    </tr>
    <tr>
      <th>44</th>
      <td>1.400000e+00</td>
      <td>-14.968</td>
      <td>-7.295300</td>
      <td>-12.934302</td>
    </tr>
    <tr>
      <th>45</th>
      <td>1.500000e+00</td>
      <td>-17.000</td>
      <td>-21.182783</td>
      <td>-14.950692</td>
    </tr>
    <tr>
      <th>46</th>
      <td>1.600000e+00</td>
      <td>-19.272</td>
      <td>-14.946791</td>
      <td>-17.237426</td>
    </tr>
    <tr>
      <th>47</th>
      <td>1.700000e+00</td>
      <td>-21.796</td>
      <td>-18.291899</td>
      <td>-19.808484</td>
    </tr>
    <tr>
      <th>48</th>
      <td>1.800000e+00</td>
      <td>-24.584</td>
      <td>-24.206884</td>
      <td>-22.677842</td>
    </tr>
    <tr>
      <th>49</th>
      <td>1.900000e+00</td>
      <td>-27.648</td>
      <td>-24.589037</td>
      <td>-25.859478</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Plot the resulting predictions using a red line. Name the chart <code class="docutils literal notranslate"><span class="pre">c2</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>c2 = alt.Chart(df).mark_line(color=&quot;red&quot;).encode(
    x=&quot;x&quot;,
    y=&quot;pred&quot;
)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Plot the true values using a dashed black line, using <code class="docutils literal notranslate"><span class="pre">strokeDash=[10,5]</span></code> as an argument to <code class="docutils literal notranslate"><span class="pre">mark_line</span></code>. Name the chart <code class="docutils literal notranslate"><span class="pre">c3</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>c3 = alt.Chart(df).mark_line(color=&quot;black&quot;,strokeDash=[10,5]).encode(
    x=&quot;x&quot;,
    y=&quot;y_true&quot;
)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Layer these plots on top of the above scatter plot <code class="docutils literal notranslate"><span class="pre">c1</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>c1+c2+c3
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-1161adefd2b34344b38d31b68233adca.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-1161adefd2b34344b38d31b68233adca.vega-embed details,
  #altair-viz-1161adefd2b34344b38d31b68233adca.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-1161adefd2b34344b38d31b68233adca"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-1161adefd2b34344b38d31b68233adca") {
      outputDiv = document.getElementById("altair-viz-1161adefd2b34344b38d31b68233adca");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "circle"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "red"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "pred", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "black", "strokeDash": [10, 5]}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y_true", "type": "quantitative"}}}], "data": {"name": "data-6cbb050be1ac1237ae924e965d0550e5"}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-6cbb050be1ac1237ae924e965d0550e5": [{"x": -3.0, "y_true": 19.0, "y": 23.824405650704584, "pred": 20.317731922698073}, {"x": -2.9, "y_true": 15.647999999999996, "y": 10.237108055098796, "pred": 16.359171949418425}, {"x": -2.8, "y_true": 12.583999999999993, "y": 16.91908679057319, "pred": 12.745261105607218}, {"x": -2.6999999999999997, "y_true": 9.795999999999992, "y": 8.955196204317206, "pred": 9.462022233913652}, {"x": -2.5999999999999996, "y_true": 7.271999999999991, "y": 6.323695104370164, "pred": 6.495478176986948}, {"x": -2.4999999999999996, "y_true": 4.999999999999989, "y": 10.602832278036008, "pred": 3.8316517774762797}, {"x": -2.3999999999999995, "y_true": 2.967999999999993, "y": 0.7841046813223418, "pred": 1.4565658780308528}, {"x": -2.2999999999999994, "y_true": 1.1639999999999908, "y": -5.234226812329393, "pred": -0.643756678700127}, {"x": -2.1999999999999993, "y_true": -0.4240000000000137, "y": -2.7714988713165125, "pred": -2.483293050067477}, {"x": -2.099999999999999, "y_true": -1.808000000000014, "y": -7.792135811821553, "pred": -4.076020393421986}, {"x": -1.9999999999999991, "y_true": -3.0000000000000107, "y": -12.199285711986715, "pred": -5.435915866114454}, {"x": -1.899999999999999, "y_true": -4.012000000000011, "y": -4.739784849269134, "pred": -6.576956625495692}, {"x": -1.799999999999999, "y_true": -4.856000000000009, "y": -2.864605133958004, "pred": -7.513119828916494}, {"x": -1.6999999999999988, "y_true": -5.544000000000008, "y": -16.3543063737946, "pred": -8.258382633727663}, {"x": -1.5999999999999988, "y_true": -6.088000000000006, "y": -6.015613468222883, "pred": -8.826722197280008}, {"x": -1.4999999999999987, "y_true": -6.5000000000000036, "y": -5.224009421444809, "pred": -9.23211567692432}, {"x": -1.3999999999999986, "y_true": -6.792000000000003, "y": -5.926044796345713, "pred": -9.488540230011402}, {"x": -1.2999999999999985, "y_true": -6.976000000000002, "y": -13.326467602050318, "pred": -9.609973013892063}, {"x": -1.1999999999999984, "y_true": -7.064000000000001, "y": -8.618806640209073, "pred": -9.610391185917099}, {"x": -1.0999999999999983, "y_true": -7.067999999999998, "y": -7.999078323585601, "pred": -9.503771903437315}, {"x": -0.9999999999999982, "y_true": -6.999999999999998, "y": -4.835119581575062, "pred": -9.304092323803507}, {"x": -0.8999999999999981, "y_true": -6.871999999999996, "y": -13.308756625035866, "pred": -9.02532960436648}, {"x": -0.799999999999998, "y_true": -6.695999999999996, "y": -4.778936156426603, "pred": -8.681460902477037}, {"x": -0.699999999999998, "y_true": -6.4839999999999955, "y": -1.524599833485449, "pred": -8.286463375485976}, {"x": -0.5999999999999979, "y_true": -6.247999999999995, "y": -17.68622693729956, "pred": -7.854314180744101}, {"x": -0.4999999999999978, "y_true": -5.999999999999995, "y": -4.880304361628128, "pred": -7.398990475602214}, {"x": -0.3999999999999977, "y_true": -5.7519999999999945, "y": -13.38506705601617, "pred": -6.9344694174111146}, {"x": -0.2999999999999976, "y_true": -5.515999999999995, "y": -6.368334641163491, "pred": -6.474728163521606}, {"x": -0.1999999999999975, "y_true": -5.303999999999996, "y": -8.704741835733941, "pred": -6.0337438712844875}, {"x": -0.09999999999999742, "y_true": -5.127999999999997, "y": 1.2401753336845394, "pred": -5.625493698050564}, {"x": 2.6645352591003757e-15, "y_true": -4.999999999999997, "y": -4.71445657964094, "pred": -5.263954801170634}, {"x": 0.10000000000000275, "y_true": -4.931999999999999, "y": -0.9555565402837516, "pred": -4.9631043379955}, {"x": 0.20000000000000284, "y_true": -4.936000000000002, "y": -10.16989462767013, "pred": -4.736919465875965}, {"x": 0.30000000000000293, "y_true": -5.024000000000004, "y": -2.7213636464572986, "pred": -4.599377342162829}, {"x": 0.400000000000003, "y_true": -5.208000000000007, "y": 1.90386367809573, "pred": -4.564455124206893}, {"x": 0.5000000000000031, "y_true": -5.50000000000001, "y": -9.036284597169002, "pred": -4.646129969358961}, {"x": 0.6000000000000032, "y_true": -5.912000000000015, "y": -2.5826311606487367, "pred": -4.858379034969833}, {"x": 0.7000000000000033, "y_true": -6.456000000000021, "y": -4.049151482825412, "pred": -5.21517947839031}, {"x": 0.8000000000000034, "y_true": -7.144000000000027, "y": -7.467369873682661, "pred": -5.730508456971194}, {"x": 0.9000000000000035, "y_true": -7.988000000000032, "y": -14.245467115049165, "pred": -6.418343128063286}, {"x": 1.0000000000000036, "y_true": -9.000000000000039, "y": -7.58449011919938, "pred": -7.29266064901739}, {"x": 1.1000000000000032, "y_true": -10.192000000000041, "y": -11.5434400342294, "pred": -8.367438177184301}, {"x": 1.2000000000000037, "y_true": -11.576000000000054, "y": -8.565901471871978, "pred": -9.656652869914833}, {"x": 1.3000000000000043, "y_true": -13.164000000000073, "y": -9.269587854684678, "pred": -11.174281884559782}, {"x": 1.400000000000004, "y_true": -14.968000000000075, "y": -7.295299533414727, "pred": -12.934302378469935}, {"x": 1.5000000000000036, "y_true": -17.000000000000078, "y": -21.18278332190194, "pred": -14.950691508996105}, {"x": 1.600000000000004, "y_true": -19.272000000000098, "y": -14.946790703056552, "pred": -17.237426433489112}, {"x": 1.7000000000000046, "y_true": -21.796000000000124, "y": -18.291898867126424, "pred": -19.808484309299743}, {"x": 1.8000000000000043, "y_true": -24.584000000000124, "y": -24.2068839018185, "pred": -22.677842293778767}, {"x": 1.900000000000004, "y_true": -27.648000000000124, "y": -24.589036941447688, "pred": -25.85947754427702}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
</section>
</section>
<section id="overfitting">
<h2>Overfitting<a class="headerlink" href="#overfitting" title="Permalink to this headline">#</a></h2>
<p>For this portion, we’ll be working with the simulated data in <code class="docutils literal notranslate"><span class="pre">sim_data.csv</span></code>. The true underlying function is of the form <span class="math notranslate nohighlight">\(f(x) = c_2x^2 + c_1x + c_0\)</span>. The true outputs are stored in the “y_true” column. We’ve hidden this true data by adding some random noise to each output and put the result in the “y” column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df = pd.read_csv(&quot;sim_data.csv&quot;)
df.head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y_true</th>
      <th>y</th>
      <th>x1</th>
      <th>x2</th>
      <th>x3</th>
      <th>x4</th>
      <th>x5</th>
      <th>x6</th>
      <th>x7</th>
      <th>x8</th>
      <th>x9</th>
      <th>x10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-3.329208</td>
      <td>-18.207589</td>
      <td>-117.484900</td>
      <td>-3.329208</td>
      <td>11.083626</td>
      <td>-36.899694</td>
      <td>122.846756</td>
      <td>-408.982395</td>
      <td>1361.587441</td>
      <td>-4533.007730</td>
      <td>1.509133e+04</td>
      <td>-5.024216e+04</td>
      <td>1.672666e+05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.465018</td>
      <td>74.160562</td>
      <td>73.954907</td>
      <td>6.465018</td>
      <td>41.796463</td>
      <td>270.214901</td>
      <td>1746.944309</td>
      <td>11294.027098</td>
      <td>73016.092970</td>
      <td>472050.384357</td>
      <td>3.051814e+06</td>
      <td>1.973004e+07</td>
      <td>1.275550e+08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-4.478046</td>
      <td>-7.670062</td>
      <td>-13.810089</td>
      <td>-4.478046</td>
      <td>20.052899</td>
      <td>-89.797810</td>
      <td>402.118751</td>
      <td>-1800.706392</td>
      <td>8063.646628</td>
      <td>-36109.383086</td>
      <td>1.616995e+05</td>
      <td>-7.240978e+05</td>
      <td>3.242544e+06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.043272</td>
      <td>-7.925152</td>
      <td>19.461182</td>
      <td>2.043272</td>
      <td>4.174960</td>
      <td>8.530580</td>
      <td>17.430295</td>
      <td>35.614834</td>
      <td>72.770792</td>
      <td>148.690523</td>
      <td>3.038152e+02</td>
      <td>6.207771e+02</td>
      <td>1.268416e+03</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.850593</td>
      <td>36.485466</td>
      <td>22.375230</td>
      <td>4.850593</td>
      <td>23.528255</td>
      <td>114.125996</td>
      <td>553.578791</td>
      <td>2685.185564</td>
      <td>13024.743051</td>
      <td>63177.731115</td>
      <td>3.064495e+05</td>
      <td>1.486462e+06</td>
      <td>7.210222e+06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This is the same type of example that we did in the previous part of lecture with the cubic polynomial. Now, we just have a degree 2 polynomial instead.</p>
<p><img alt="" src="../_images/over-under.png" /></p>
<p><a class="reference external" href="https://www.geeksforgeeks.org/underfitting-and-overfitting-in-machine-learning/">Image Source</a></p>
<ul class="simple">
<li><p>Bias: This is an error caused by overly simplistic assumptions about our data. It fails to capture underlying complexity of our data. In this situation, our model tends to be easy to understand, but somehow fails to capture key aspects/nuances of the data.</p></li>
<li><p>Variance: These are erros due to our model being too sensitive to noise and random fluctuations in the data. It might learn to model a training set well beause it memorizes the random differences, but struggles with data it has never seen before. Failure to learn underlying patterns of the data.</p></li>
</ul>
<ul class="simple">
<li><p>Make a layer chart with the true “y” values and the noisy “y” values.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>c1 = alt.Chart(df).mark_circle(color=&quot;red&quot;).encode(
    x=&quot;x&quot;,
    y=&quot;y&quot;
)
c2 = alt.Chart(df).mark_circle(color=&quot;black&quot;).encode(
    x=&quot;x&quot;,
    y=&quot;y_true&quot;
)
c1+c2
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-1e5a4a6bc1064b39a17bdba458ab818e.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-1e5a4a6bc1064b39a17bdba458ab818e.vega-embed details,
  #altair-viz-1e5a4a6bc1064b39a17bdba458ab818e.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-1e5a4a6bc1064b39a17bdba458ab818e"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-1e5a4a6bc1064b39a17bdba458ab818e") {
      outputDiv = document.getElementById("altair-viz-1e5a4a6bc1064b39a17bdba458ab818e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "circle", "color": "red"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"mark": {"type": "circle", "color": "black"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y_true", "type": "quantitative"}}}], "data": {"name": "data-e408b203f30a36c887299a985aa11d81"}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-e408b203f30a36c887299a985aa11d81": [{"x": -3.329207948258288, "y_true": -18.207589131190502, "y": -117.48489981507691, "x1": -3.329207948258288, "x2": 11.08362556274616, "x3": -36.89969431901326, "x4": 122.84675561516016, "x5": -408.9823952117346, "x6": 1361.5874408366194, "x7": -4533.007730281935, "x8": 15091.32536517088, "x9": -50242.16035547881, "x10": 167266.5995931275}, {"x": 6.465018397406531, "y_true": 74.16056232333514, "y": 73.95490734658352, "x1": 6.465018397406531, "x2": 41.79646287880492, "x3": 270.21490145799294, "x4": 1746.944309179317, "x5": 11294.027098088927, "x6": 73016.09296995284, "x7": 472050.3843574908, "x8": 3051814.419374002, "x9": 19730036.36672345, "x10": 127555048.09236704}, {"x": -4.478046317204917, "y_true": -7.670061908184866, "y": -13.810088667204978, "x1": -4.478046317204917, "x2": 20.052898819032524, "x3": -89.79780970585144, "x4": 402.118751046356, "x5": -1800.7063922021755, "x6": 8063.646627968305, "x7": -36109.38308561532, "x8": 161699.48994308122, "x9": -724097.8054335285, "x10": 3242543.510917775}, {"x": 2.043272001247484, "y_true": -7.9251519940460895, "y": 19.46118237861152, "x1": 2.043272001247484, "x2": 4.1749604710818975, "x3": 8.530579836876647, "x4": 17.43029493509638, "x5": 35.614833614368266, "x6": 72.7707923533264, "x7": 148.69052252414633, "x8": 303.8151815244466, "x9": 620.7770539628235, "x10": 1268.4163733791356}, {"x": 4.850593279708996, "y_true": 36.48546622757559, "y": 22.37523008579901, "x1": 4.850593279708996, "x2": 23.52825516515807, "x3": 114.1259963873942, "x4": 553.5787911167873, "x5": 2685.1855639805185, "x6": 13024.743051415511, "x7": 63177.73111513252, "x8": 306449.4779743237, "x9": 1486461.7784325844, "x10": 7210221.513009375}, {"x": -0.5785060804889142, "y_true": -25.20293714522805, "y": -25.44530061571687, "x1": -0.5785060804889142, "x2": 0.334669285162646, "x3": -0.193608216419469, "x4": 0.1120035304312764, "x5": -0.0647947233907185, "x6": 0.0374841414651279, "x7": -0.0216848037594831, "x8": 0.0125447908290698, "x9": -0.0072572377730784, "x10": 0.0041983561792797}, {"x": -6.557408679959602, "y_true": 22.813959025381838, "y": 76.67574767286865, "x1": -6.557408679959602, "x2": 42.99960859600953, "x3": -281.9660066423384, "x4": 1848.9663394100169, "x5": -12124.427923000376, "x6": 79504.82890182723, "x7": -521345.6551395449, "x8": 3418676.524271277, "x9": -22417659.1142306, "x10": 147001752.4600312}, {"x": -5.656363051930528, "y_true": 7.799464545001062, "y": 59.65376106978435, "x1": -5.656363051930528, "x2": 31.99444297524484, "x3": -180.97218511227317, "x4": 1023.6443812961938, "x5": -5790.104256680076, "x6": 32750.93178431085, "x7": -185251.1604610731, "x8": 1047847.8193592674, "x9": -5927007.689469734, "x10": 33525307.30322473}, {"x": 0.1085383400545652, "y_true": -22.93496583463122, "y": -66.10368783700659, "x1": 0.1085383400545652, "x2": 0.0117805712618004, "x3": 0.0012786436496503, "x4": 0.0001387818592543, "x5": 1.5063152633154338e-05, "x6": 1.6349295827911247e-06, "x7": 1.774525430222515e-07, "x8": 1.9260404458096493e-08, "x9": 2.0904923286613407e-09, "x10": 2.2689856724970447e-10}, {"x": 4.556122347821622, "y_true": 30.569128068211988, "y": 1.089803157452213, "x1": 4.556122347821622, "x2": 20.75825084831961, "x3": 94.57713059171614, "x4": 430.90497828176194, "x5": 1963.2558013371265, "x6": 8944.833630962528, "x7": 40753.75640357481, "x8": 185679.10030800573, "x9": 845976.6984367175, "x10": 3854373.341483882}, {"x": -6.299257105127305, "y_true": 18.23013399902268, "y": -7.25110091586216, "x1": -6.299257105127305, "x2": 39.68064007649684, "x3": -249.958553937872, "x4": 1574.553196880487, "x5": -9918.515412850318, "x6": 62479.27868671205, "x7": -393573.0401904999, "x8": 2479217.7698065606, "x9": -15617230.15161185, "x10": 98376947.99494933}, {"x": 6.449735233464434, "y_true": 73.76235824625147, "y": 130.94052037260485, "x1": 6.449735233464434, "x2": 41.59908458179252, "x3": 268.3030815070543, "x4": 1730.483838043128, "x5": 11161.162581167524, "x6": 71986.54354618103, "x7": 464294.1462451255, "x8": 2994574.3137284745, "x9": 19314211.46048212, "x10": 124571550.1632541}, {"x": 3.6601115365364834, "y_true": 14.380365281608256, "y": 8.061647596412477, "x1": 3.6601115365364834, "x2": 13.396416459887456, "x3": 49.03237843308132, "x4": 179.4639739667436, "x5": 656.8581615083614, "x6": 2404.174134804898, "x7": 8799.545486642026, "x8": 32207.31795193602, "x9": 117882.3759967796, "x10": 431462.64434014447}, {"x": -8.982275379207888, "y_true": 76.93083162471879, "y": 2.57497436581059, "x1": -8.982275379207888, "x2": 80.68127098792421, "x3": -724.7013939580312, "x4": 6509.46748822686, "x5": -58469.82955125433, "x6": 525192.1104047135, "x7": -4717420.162642489, "x8": 42373166.9802825, "x9": -380607454.5060562, "x10": 3418720967.7527347}, {"x": -9.026659050812274, "y_true": 78.10767304500862, "y": 15.781692216581398, "x1": -9.026659050812274, "x2": 81.48057361961114, "x3": -735.4973573288387, "x4": 6639.083877380871, "x5": -59928.74657086189, "x6": 540956.3626377055, "x7": -4883028.646898131, "x8": 44077434.73089863, "x9": -397871975.1502533, "x10": 3591454665.55459}, {"x": 5.481667038018758, "y_true": 50.15757983256919, "y": 24.44182752029455, "x1": 5.481667038018758, "x2": 30.048673515701346, "x3": 164.71682314720726, "x4": 902.9227800532112, "x5": 4949.522041293949, "x6": 27131.63182770836, "x7": 148726.5718776095, "x8": 815269.5467390196, "x9": 4469036.201459777, "x10": 24497768.43725461}, {"x": -3.942981654772611, "y_true": -13.136147423782996, "y": -35.90188825321785, "x1": -3.942981654772611, "x2": 15.547104329873356, "x3": -61.30194715752647, "x4": 241.7124530439669, "x5": -953.0677680824476, "x6": 3757.928725304168, "x7": -14817.444023817356, "x8": 58424.90995653189, "x9": -230368.3481403469, "x10": 908338.170557658}, {"x": 7.135268762431544, "y_true": 92.40510445659264, "y": 27.822957658181807, "x1": 7.135268762431544, "x2": 50.91206031213137, "x3": 363.2712335761817, "x4": 2592.0378852261024, "x5": 18494.886953492925, "x6": 131965.9891439608, "x7": 941612.8000422836, "x8": 6718660.398447406, "x9": 47939447.66642764, "x10": 342060843.4224829}, {"x": 4.196026495565919, "y_true": 23.73499382935532, "y": 19.89278808558322, "x1": 4.196026495565919, "x2": 17.606638351491206, "x3": 73.87792102070415, "x4": 309.9937140402009, "x5": 1300.741837571568, "x6": 5457.9472143414, "x7": 22901.691122776712, "x8": 96096.10274443789, "x9": 403221.79323628615, "x10": 1691929.3280090592}, {"x": -9.924587728801344, "y_true": 103.35484100926068, "y": 90.76217468813144, "x1": -9.924587728801344, "x2": 98.4974415866742, "x3": -977.546500089434, "x4": 9701.745999120298, "x5": -96285.82929081684, "x6": 955597.1598371018, "x7": -9483907.846196717, "x8": 94123875.43144672, "x9": -934140659.0941623, "x10": 9270960922.220322}, {"x": -0.6900414588494286, "y_true": -25.419702715899877, "y": 61.59169896339826, "x1": -0.6900414588494286, "x2": 0.4761572149310476, "x3": -0.328568219232701, "x4": 0.2267256933308919, "x5": -0.1564501281846968, "x6": 0.1079570746897482, "x7": -0.0744948573120306, "x8": 0.0514045400163736, "x9": -0.0354712637843822, "x10": 0.024476642609008}, {"x": 4.510287644012569, "y_true": 29.674760214396706, "y": 67.75450975334007, "x1": 4.510287644012569, "x2": 20.342694631732453, "x3": 91.75140424342372, "x4": 413.8252248799164, "x5": 1866.47079855661, "x6": 8418.320180640152, "x7": 37969.04549408294, "x8": 171251.3167469134, "x9": 772392.6979444863, "x10": 3483713.241864549}, {"x": -9.336060459657736, "y_true": 86.49759445625713, "y": 101.99230853473858, "x1": -9.336060459657736, "x2": 87.16202490638462, "x3": -813.7499343122001, "x4": 7597.218585781211, "x5": -70928.09204208883, "x6": 662188.95559311, "x7": -6182236.125134886, "x8": 57717730.24013947, "x9": -538856219.1161577, "x10": 5030794240.731025}, {"x": 4.441058173200844, "y_true": 28.337434596305293, "y": 75.652070315597, "x1": 4.441058173200844, "x2": 19.722997697754018, "x3": 87.5909801256319, "x4": 388.9966381856102, "x5": 1727.556699361856, "x6": 7672.179799368842, "x7": 34072.59680425341, "x8": 151318.38451970654, "x9": 672013.7483267909, "x10": 2984452.149510029}, {"x": -6.563453985661962, "y_true": 22.92401663601917, "y": 3.705401701436681, "x1": -6.563453985661962, "x2": 43.07892822190189, "x3": -282.7465631360876, "x4": 1855.7940567477756, "x5": -12180.418898328966, "x6": 79945.61896526953, "x7": -524719.3914338109, "x8": 3443971.581060365, "x9": -22604349.00021718, "x10": 148362604.53876945}, {"x": 0.3715928458725752, "y_true": -21.641731218646186, "y": 1.1348634243102325, "x1": 0.3715928458725752, "x2": 0.1380812431036794, "x3": 0.0513100020865191, "x4": 0.0190664296970574, "x5": 0.0070849488717589, "x6": 0.0026327163141186, "x7": 0.0009782985475384, "x8": 0.0003635287413928, "x9": 0.0001350846795706, "x10": 5.019650051543844e-05}, {"x": 6.520774235091615, "y_true": 75.6200186264345, "y": 106.2787015891801, "x1": 6.520774235091615, "x2": 42.52049662503464, "x3": 277.2665588558258, "x4": 1807.992633239582, "x5": 11789.51178006411, "x6": 76876.74465975113, "x7": 501295.895855022, "x8": 3268837.361848597, "x9": 21315350.447847176, "x10": 138992588.0122704}, {"x": -2.9659640277290773, "y_true": -20.6056500702583, "y": 42.19409663367121, "x1": -2.9659640277290773, "x2": 8.79694261378289, "x3": -26.09141534647706, "x4": 77.38619935018936, "x5": -229.52468351533287, "x6": 680.7619547823787, "x7": -2019.115469331064, "x8": 5988.623849867248, "x9": -17762.042914306676, "x10": 52681.580342813744}, {"x": 3.165616256477076, "y_true": 6.614941333118303, "y": -125.40319890292574, "x1": 3.165616256477076, "x2": 10.021126283271936, "x3": 31.723040270535343, "x4": 100.42297198528362, "x5": 317.9005926403558, "x6": 1006.3512840060072, "x7": 3185.721984375995, "x8": 10084.773302357058, "x9": 31924.522308827512, "x10": 101060.78680108945}, {"x": 5.222245052890752, "y_true": 44.373338484003376, "y": -1.9846500432445997, "x1": 5.222245052890752, "x2": 27.271843392441937, "x3": 142.42024923939124, "x4": 743.7534420218789, "x5": 3884.062733169226, "x6": 20283.527393410324, "x7": 105925.55058541113, "x8": 553169.1825193923, "x9": 2888785.0268235183, "x10": 15085943.315193998}, {"x": -6.47093182334422, "y_true": 21.253209250315912, "y": -11.812893751238208, "x1": -6.47093182334422, "x2": 41.872958662368944, "x3": -270.9570607459002, "x4": 1753.3446671404586, "x5": -11345.773803890072, "x6": 73417.72876805747, "x7": -475081.1174828775, "x8": 3074217.521789886, "x9": -19893051.993632574, "x10": 128726583.2090382}, {"x": 6.893150314043133, "y_true": 85.63830241596483, "y": 64.8076871161785, "x1": 6.893150314043133, "x2": 47.51552125199294, "x3": 327.5316302400984, "x4": 2257.7247598485933, "x5": 15562.836137373288, "x6": 107276.9688077365, "x7": 739476.2712266443, "x8": 5097321.091233388, "x9": 35136600.480814114, "x10": 242201868.63873196}, {"x": -3.493022680238049, "y_true": -16.979340333058417, "y": -54.08639152234581, "x1": -3.493022680238049, "x2": 12.201207444657404, "x3": -42.61909433047764, "x4": 148.86946310756323, "x5": -520.0044110295798, "x6": 1816.3872015501508, "x7": -6344.681691108797, "x8": 22162.117045934127, "x9": -77412.77748353817, "x10": 270404.5874902202}, {"x": -8.747074910351651, "y_true": 70.80623599597394, "y": 183.70684761381912, "x1": -8.747074910351651, "x2": 76.51131948730335, "x3": -669.2502430452905, "x4": 5853.982009688206, "x5": -51205.21916259364, "x6": 447895.8878161804, "x7": -3917778.8827665895, "x8": 34269105.36975316, "x9": -299754431.7799649, "x10": 2621974469.489247}, {"x": -1.384337371858507, "y_true": -25.81792029410888, "y": -33.87053208902993, "x1": -1.384337371858507, "x2": 1.9163899591241185, "x3": -2.6529302394699137, "x4": 3.67255047543174, "x5": -5.084048873176886, "x6": 7.038038855493894, "x7": -9.743020212252471, "x8": 13.4876269945939, "x9": -18.67142610630397, "x10": 25.84755294485116}, {"x": 4.852229846751024, "y_true": 36.519170997371695, "y": -13.988942624499913, "x1": 4.852229846751024, "x2": 23.54413448570147, "x3": 114.24155206744076, "x4": 554.3262686807972, "x5": 2689.718465731092, "x6": 13051.132218777777, "x7": 63327.09328584744, "x8": 307277.6121495753, "x9": 1490981.6009105546, "x10": 7234585.424894817}, {"x": 3.727976805823406, "y_true": 15.510983713963348, "y": 161.0233188781908, "x1": 3.727976805823406, "x2": 13.897811064757288, "x3": 51.810717301131056, "x4": 193.14915239169005, "x5": 720.055560180671, "x6": 2684.350427257721, "x7": 10007.196131518936, "x8": 37306.59506962831, "x9": 139078.12112382016, "x10": 518480.0097471}, {"x": -2.7383989368584727, "y_true": -21.879426787560792, "y": -35.23602701511189, "x1": -2.7383989368584727, "x2": 7.498828737387614, "x3": -20.534784642146004, "x4": 56.23243243267031, "x5": -153.98683319059026, "x6": 421.67738029931536, "x7": -1154.7208899089112, "x8": 3162.086457294832, "x9": -8659.054192910742, "x10": 23711.944796066677}, {"x": -1.6026752477703532, "y_true": -25.604403001171647, "y": -41.0626241665516, "x1": -1.6026752477703532, "x2": 2.568567949815763, "x3": -4.116580275385966, "x4": 6.597541312820752, "x5": -10.57371615820014, "x6": 16.946233163696796, "x7": -27.15930843440194, "x8": 43.52755137437657, "x9": -69.76052918376575, "x10": 111.80347339418272}, {"x": -8.223553165877851, "y_true": 57.849037362334165, "y": 14.428412230630222, "x1": -8.223553165877851, "x2": 67.62682667201962, "x3": -556.1328045769596, "x4": 4573.387685727384, "x5": -37609.49678175021, "x6": 309283.6963266348, "x7": -2543410.9200813016, "x8": 20915874.923962884, "x9": -172002809.44806013, "x10": 1414474248.1764796}, {"x": -0.3640013134943825, "y_true": -24.667160559743387, "y": 21.818198775552545, "x1": -0.3640013134943825, "x2": 0.1324969562256357, "x3": -0.048229066100139, "x4": 0.017555443409058, "x5": -0.0063902044598734, "x6": 0.0023260428168915, "x7": -0.0008466826405927, "x8": 0.0003081935932886, "x9": -0.0001121828727676, "x10": 4.083471303898616e-05}, {"x": 6.656568171049994, "y_true": 79.21875918822593, "y": 23.279299839342315, "x1": 6.656568171049994, "x2": 44.30989981583586, "x3": 294.95186877650696, "x4": 1963.3672216894104, "x5": 13069.287755980587, "x6": 86996.60489475378, "x7": 579098.8311318301, "x8": 3854810.847204396, "x9": 25659811.19091904, "x10": 170806282.4486241}, {"x": -9.804879808964852, "y_true": 99.83062849926336, "y": 131.47624036529035, "x1": -9.804879808964852, "x2": 96.13566806824664, "x3": -942.5986707636984, "x4": 9242.066674928095, "x5": -90617.3529341094, "x6": 888492.2541254913, "x7": -8711559.762896698, "x8": 85415796.42381647, "x9": -837491617.7225302, "x10": 8211504652.784947}, {"x": 1.2361742342612168, "y_true": -15.733870185861791, "y": 3.383360389096301, "x1": 1.2361742342612168, "x2": 1.5281267374513057, "x3": 1.8890308995229592, "x4": 2.335171325713572, "x5": 2.886678625432725, "x6": 3.56843773935252, "x7": 4.4112107899529285, "x8": 5.453025120434879, "x9": 6.740889152660766, "x10": 8.332913486530165}, {"x": -2.76625939296056, "y_true": -21.732938761596003, "y": 129.3356782636361, "x1": -2.76625939296056, "x2": 7.652191029142525, "x3": -21.167945311094044, "x4": 58.55602754648934, "x5": -161.98116121493342, "x6": 448.08190869346834, "x7": -1239.5107887390027, "x8": 3428.8083620252187, "x9": -9484.973338113972, "x10": 26237.896588538253}, {"x": -4.457650184804254, "y_true": -7.89626896855226, "y": -26.760376539006497, "x1": -4.457650184804254, "x2": 19.8706451700854, "x3": -88.57638511461093, "x4": 394.8425394754382, "x5": -1760.0699190612677, "x6": 7845.775999971868, "x7": -34973.72483620738, "x8": 155900.63097941293, "x9": -694950.4764964798, "x10": 3097846.1199843376}, {"x": 4.825670488119888, "y_true": 35.97331162314065, "y": 49.77584336934803, "x1": 4.825670488119888, "x2": 23.28709565991124, "x3": 112.3758502800584, "x4": 542.2888242738569, "x5": 2616.907175335584, "x6": 12628.331726166103, "x7": 60940.16772514785, "x8": 294077.16893232206, "x9": 1419119.5153465534, "x10": 6848203.1643228615}, {"x": -3.012486777485868, "y_true": -20.32356559399584, "y": -12.16411918567957, "x1": -3.012486777485868, "x2": 9.075076584527189, "x3": -27.33854821555976, "x4": 82.35701501503365, "x5": -248.09941876599396, "x6": 747.3962185344858, "x7": -2251.5212258780766, "x8": 6782.677922186477, "x9": -20432.72755653208, "x10": 61553.32159202402}, {"x": 3.7783291669200896, "y_true": 16.35996078349077, "y": -23.18155368558764, "x1": 3.7783291669200896, "x2": 14.27577129359906, "x3": 53.93856305888586, "x4": 203.79764602714693, "x5": 770.0145901340253, "x6": 2909.3685848574064, "x7": 10992.552181487765, "x8": 41533.48052620627, "x9": 156927.1608758727, "x10": 592922.4690192711}, {"x": 6.068926586911488, "y_true": 64.096777865783, "y": 182.7524628775764, "x1": 6.068926586911488, "x2": 36.83186991732112, "x3": 223.5299145868956, "x4": 1356.5866416064644, "x5": 8233.024736694437, "x6": 49965.622715224825, "x7": 303237.69612801645, "x8": 1840327.3161851056, "x9": 11168811.377815252, "x10": 67782696.31502251}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
</section>
<section id="dividing-into-a-training-set-and-a-test-set">
<h2>Dividing into a training set and a test set<a class="headerlink" href="#dividing-into-a-training-set-and-a-test-set" title="Permalink to this headline">#</a></h2>
<p>What is training data? Training data is data that we show to our model for fitting. The reason we use it is to save some data for testing how well our model works; the testing data is something that our model was not fit on – it is brand new!</p>
<p>Key Idea: Fit to a training set, predict or evaluate on a test set.</p>
<p>We partition our data so that some of it is saved for training, and the rest is used for testing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>max_deg = 10
cols = [f&quot;x{i}&quot; for i in range(1, max_deg+1)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cols
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;, &#39;x4&#39;, &#39;x5&#39;, &#39;x6&#39;, &#39;x7&#39;, &#39;x8&#39;, &#39;x9&#39;, &#39;x10&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>from sklearn.model_selection import train_test_split
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>X_train, X_test, y_train, y_test = train_test_split(df[cols],df[&quot;y&quot;],train_size=0.24, random_state=6)
</pre></div>
</div>
</div>
</div>
<p>This save 24% of the rows of <code class="docutils literal notranslate"><span class="pre">df[cols]</span></code> for training. The remaining rows will be used to testing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df[cols]
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1</th>
      <th>x2</th>
      <th>x3</th>
      <th>x4</th>
      <th>x5</th>
      <th>x6</th>
      <th>x7</th>
      <th>x8</th>
      <th>x9</th>
      <th>x10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-3.329208</td>
      <td>11.083626</td>
      <td>-36.899694</td>
      <td>122.846756</td>
      <td>-408.982395</td>
      <td>1361.587441</td>
      <td>-4.533008e+03</td>
      <td>1.509133e+04</td>
      <td>-5.024216e+04</td>
      <td>1.672666e+05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.465018</td>
      <td>41.796463</td>
      <td>270.214901</td>
      <td>1746.944309</td>
      <td>11294.027098</td>
      <td>73016.092970</td>
      <td>4.720504e+05</td>
      <td>3.051814e+06</td>
      <td>1.973004e+07</td>
      <td>1.275550e+08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-4.478046</td>
      <td>20.052899</td>
      <td>-89.797810</td>
      <td>402.118751</td>
      <td>-1800.706392</td>
      <td>8063.646628</td>
      <td>-3.610938e+04</td>
      <td>1.616995e+05</td>
      <td>-7.240978e+05</td>
      <td>3.242544e+06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.043272</td>
      <td>4.174960</td>
      <td>8.530580</td>
      <td>17.430295</td>
      <td>35.614834</td>
      <td>72.770792</td>
      <td>1.486905e+02</td>
      <td>3.038152e+02</td>
      <td>6.207771e+02</td>
      <td>1.268416e+03</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.850593</td>
      <td>23.528255</td>
      <td>114.125996</td>
      <td>553.578791</td>
      <td>2685.185564</td>
      <td>13024.743051</td>
      <td>6.317773e+04</td>
      <td>3.064495e+05</td>
      <td>1.486462e+06</td>
      <td>7.210222e+06</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.578506</td>
      <td>0.334669</td>
      <td>-0.193608</td>
      <td>0.112004</td>
      <td>-0.064795</td>
      <td>0.037484</td>
      <td>-2.168480e-02</td>
      <td>1.254479e-02</td>
      <td>-7.257238e-03</td>
      <td>4.198356e-03</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-6.557409</td>
      <td>42.999609</td>
      <td>-281.966007</td>
      <td>1848.966339</td>
      <td>-12124.427923</td>
      <td>79504.828902</td>
      <td>-5.213457e+05</td>
      <td>3.418677e+06</td>
      <td>-2.241766e+07</td>
      <td>1.470018e+08</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-5.656363</td>
      <td>31.994443</td>
      <td>-180.972185</td>
      <td>1023.644381</td>
      <td>-5790.104257</td>
      <td>32750.931784</td>
      <td>-1.852512e+05</td>
      <td>1.047848e+06</td>
      <td>-5.927008e+06</td>
      <td>3.352531e+07</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.108538</td>
      <td>0.011781</td>
      <td>0.001279</td>
      <td>0.000139</td>
      <td>0.000015</td>
      <td>0.000002</td>
      <td>1.774525e-07</td>
      <td>1.926040e-08</td>
      <td>2.090492e-09</td>
      <td>2.268986e-10</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4.556122</td>
      <td>20.758251</td>
      <td>94.577131</td>
      <td>430.904978</td>
      <td>1963.255801</td>
      <td>8944.833631</td>
      <td>4.075376e+04</td>
      <td>1.856791e+05</td>
      <td>8.459767e+05</td>
      <td>3.854373e+06</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-6.299257</td>
      <td>39.680640</td>
      <td>-249.958554</td>
      <td>1574.553197</td>
      <td>-9918.515413</td>
      <td>62479.278687</td>
      <td>-3.935730e+05</td>
      <td>2.479218e+06</td>
      <td>-1.561723e+07</td>
      <td>9.837695e+07</td>
    </tr>
    <tr>
      <th>11</th>
      <td>6.449735</td>
      <td>41.599085</td>
      <td>268.303082</td>
      <td>1730.483838</td>
      <td>11161.162581</td>
      <td>71986.543546</td>
      <td>4.642941e+05</td>
      <td>2.994574e+06</td>
      <td>1.931421e+07</td>
      <td>1.245716e+08</td>
    </tr>
    <tr>
      <th>12</th>
      <td>3.660112</td>
      <td>13.396416</td>
      <td>49.032378</td>
      <td>179.463974</td>
      <td>656.858162</td>
      <td>2404.174135</td>
      <td>8.799545e+03</td>
      <td>3.220732e+04</td>
      <td>1.178824e+05</td>
      <td>4.314626e+05</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-8.982275</td>
      <td>80.681271</td>
      <td>-724.701394</td>
      <td>6509.467488</td>
      <td>-58469.829551</td>
      <td>525192.110405</td>
      <td>-4.717420e+06</td>
      <td>4.237317e+07</td>
      <td>-3.806075e+08</td>
      <td>3.418721e+09</td>
    </tr>
    <tr>
      <th>14</th>
      <td>-9.026659</td>
      <td>81.480574</td>
      <td>-735.497357</td>
      <td>6639.083877</td>
      <td>-59928.746571</td>
      <td>540956.362638</td>
      <td>-4.883029e+06</td>
      <td>4.407743e+07</td>
      <td>-3.978720e+08</td>
      <td>3.591455e+09</td>
    </tr>
    <tr>
      <th>15</th>
      <td>5.481667</td>
      <td>30.048674</td>
      <td>164.716823</td>
      <td>902.922780</td>
      <td>4949.522041</td>
      <td>27131.631828</td>
      <td>1.487266e+05</td>
      <td>8.152695e+05</td>
      <td>4.469036e+06</td>
      <td>2.449777e+07</td>
    </tr>
    <tr>
      <th>16</th>
      <td>-3.942982</td>
      <td>15.547104</td>
      <td>-61.301947</td>
      <td>241.712453</td>
      <td>-953.067768</td>
      <td>3757.928725</td>
      <td>-1.481744e+04</td>
      <td>5.842491e+04</td>
      <td>-2.303683e+05</td>
      <td>9.083382e+05</td>
    </tr>
    <tr>
      <th>17</th>
      <td>7.135269</td>
      <td>50.912060</td>
      <td>363.271234</td>
      <td>2592.037885</td>
      <td>18494.886953</td>
      <td>131965.989144</td>
      <td>9.416128e+05</td>
      <td>6.718660e+06</td>
      <td>4.793945e+07</td>
      <td>3.420608e+08</td>
    </tr>
    <tr>
      <th>18</th>
      <td>4.196026</td>
      <td>17.606638</td>
      <td>73.877921</td>
      <td>309.993714</td>
      <td>1300.741838</td>
      <td>5457.947214</td>
      <td>2.290169e+04</td>
      <td>9.609610e+04</td>
      <td>4.032218e+05</td>
      <td>1.691929e+06</td>
    </tr>
    <tr>
      <th>19</th>
      <td>-9.924588</td>
      <td>98.497442</td>
      <td>-977.546500</td>
      <td>9701.745999</td>
      <td>-96285.829291</td>
      <td>955597.159837</td>
      <td>-9.483908e+06</td>
      <td>9.412388e+07</td>
      <td>-9.341407e+08</td>
      <td>9.270961e+09</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-0.690041</td>
      <td>0.476157</td>
      <td>-0.328568</td>
      <td>0.226726</td>
      <td>-0.156450</td>
      <td>0.107957</td>
      <td>-7.449486e-02</td>
      <td>5.140454e-02</td>
      <td>-3.547126e-02</td>
      <td>2.447664e-02</td>
    </tr>
    <tr>
      <th>21</th>
      <td>4.510288</td>
      <td>20.342695</td>
      <td>91.751404</td>
      <td>413.825225</td>
      <td>1866.470799</td>
      <td>8418.320181</td>
      <td>3.796905e+04</td>
      <td>1.712513e+05</td>
      <td>7.723927e+05</td>
      <td>3.483713e+06</td>
    </tr>
    <tr>
      <th>22</th>
      <td>-9.336060</td>
      <td>87.162025</td>
      <td>-813.749934</td>
      <td>7597.218586</td>
      <td>-70928.092042</td>
      <td>662188.955593</td>
      <td>-6.182236e+06</td>
      <td>5.771773e+07</td>
      <td>-5.388562e+08</td>
      <td>5.030794e+09</td>
    </tr>
    <tr>
      <th>23</th>
      <td>4.441058</td>
      <td>19.722998</td>
      <td>87.590980</td>
      <td>388.996638</td>
      <td>1727.556699</td>
      <td>7672.179799</td>
      <td>3.407260e+04</td>
      <td>1.513184e+05</td>
      <td>6.720137e+05</td>
      <td>2.984452e+06</td>
    </tr>
    <tr>
      <th>24</th>
      <td>-6.563454</td>
      <td>43.078928</td>
      <td>-282.746563</td>
      <td>1855.794057</td>
      <td>-12180.418898</td>
      <td>79945.618965</td>
      <td>-5.247194e+05</td>
      <td>3.443972e+06</td>
      <td>-2.260435e+07</td>
      <td>1.483626e+08</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0.371593</td>
      <td>0.138081</td>
      <td>0.051310</td>
      <td>0.019066</td>
      <td>0.007085</td>
      <td>0.002633</td>
      <td>9.782985e-04</td>
      <td>3.635287e-04</td>
      <td>1.350847e-04</td>
      <td>5.019650e-05</td>
    </tr>
    <tr>
      <th>26</th>
      <td>6.520774</td>
      <td>42.520497</td>
      <td>277.266559</td>
      <td>1807.992633</td>
      <td>11789.511780</td>
      <td>76876.744660</td>
      <td>5.012959e+05</td>
      <td>3.268837e+06</td>
      <td>2.131535e+07</td>
      <td>1.389926e+08</td>
    </tr>
    <tr>
      <th>27</th>
      <td>-2.965964</td>
      <td>8.796943</td>
      <td>-26.091415</td>
      <td>77.386199</td>
      <td>-229.524684</td>
      <td>680.761955</td>
      <td>-2.019115e+03</td>
      <td>5.988624e+03</td>
      <td>-1.776204e+04</td>
      <td>5.268158e+04</td>
    </tr>
    <tr>
      <th>28</th>
      <td>3.165616</td>
      <td>10.021126</td>
      <td>31.723040</td>
      <td>100.422972</td>
      <td>317.900593</td>
      <td>1006.351284</td>
      <td>3.185722e+03</td>
      <td>1.008477e+04</td>
      <td>3.192452e+04</td>
      <td>1.010608e+05</td>
    </tr>
    <tr>
      <th>29</th>
      <td>5.222245</td>
      <td>27.271843</td>
      <td>142.420249</td>
      <td>743.753442</td>
      <td>3884.062733</td>
      <td>20283.527393</td>
      <td>1.059256e+05</td>
      <td>5.531692e+05</td>
      <td>2.888785e+06</td>
      <td>1.508594e+07</td>
    </tr>
    <tr>
      <th>30</th>
      <td>-6.470932</td>
      <td>41.872959</td>
      <td>-270.957061</td>
      <td>1753.344667</td>
      <td>-11345.773804</td>
      <td>73417.728768</td>
      <td>-4.750811e+05</td>
      <td>3.074218e+06</td>
      <td>-1.989305e+07</td>
      <td>1.287266e+08</td>
    </tr>
    <tr>
      <th>31</th>
      <td>6.893150</td>
      <td>47.515521</td>
      <td>327.531630</td>
      <td>2257.724760</td>
      <td>15562.836137</td>
      <td>107276.968808</td>
      <td>7.394763e+05</td>
      <td>5.097321e+06</td>
      <td>3.513660e+07</td>
      <td>2.422019e+08</td>
    </tr>
    <tr>
      <th>32</th>
      <td>-3.493023</td>
      <td>12.201207</td>
      <td>-42.619094</td>
      <td>148.869463</td>
      <td>-520.004411</td>
      <td>1816.387202</td>
      <td>-6.344682e+03</td>
      <td>2.216212e+04</td>
      <td>-7.741278e+04</td>
      <td>2.704046e+05</td>
    </tr>
    <tr>
      <th>33</th>
      <td>-8.747075</td>
      <td>76.511319</td>
      <td>-669.250243</td>
      <td>5853.982010</td>
      <td>-51205.219163</td>
      <td>447895.887816</td>
      <td>-3.917779e+06</td>
      <td>3.426911e+07</td>
      <td>-2.997544e+08</td>
      <td>2.621974e+09</td>
    </tr>
    <tr>
      <th>34</th>
      <td>-1.384337</td>
      <td>1.916390</td>
      <td>-2.652930</td>
      <td>3.672550</td>
      <td>-5.084049</td>
      <td>7.038039</td>
      <td>-9.743020e+00</td>
      <td>1.348763e+01</td>
      <td>-1.867143e+01</td>
      <td>2.584755e+01</td>
    </tr>
    <tr>
      <th>35</th>
      <td>4.852230</td>
      <td>23.544134</td>
      <td>114.241552</td>
      <td>554.326269</td>
      <td>2689.718466</td>
      <td>13051.132219</td>
      <td>6.332709e+04</td>
      <td>3.072776e+05</td>
      <td>1.490982e+06</td>
      <td>7.234585e+06</td>
    </tr>
    <tr>
      <th>36</th>
      <td>3.727977</td>
      <td>13.897811</td>
      <td>51.810717</td>
      <td>193.149152</td>
      <td>720.055560</td>
      <td>2684.350427</td>
      <td>1.000720e+04</td>
      <td>3.730660e+04</td>
      <td>1.390781e+05</td>
      <td>5.184800e+05</td>
    </tr>
    <tr>
      <th>37</th>
      <td>-2.738399</td>
      <td>7.498829</td>
      <td>-20.534785</td>
      <td>56.232432</td>
      <td>-153.986833</td>
      <td>421.677380</td>
      <td>-1.154721e+03</td>
      <td>3.162086e+03</td>
      <td>-8.659054e+03</td>
      <td>2.371194e+04</td>
    </tr>
    <tr>
      <th>38</th>
      <td>-1.602675</td>
      <td>2.568568</td>
      <td>-4.116580</td>
      <td>6.597541</td>
      <td>-10.573716</td>
      <td>16.946233</td>
      <td>-2.715931e+01</td>
      <td>4.352755e+01</td>
      <td>-6.976053e+01</td>
      <td>1.118035e+02</td>
    </tr>
    <tr>
      <th>39</th>
      <td>-8.223553</td>
      <td>67.626827</td>
      <td>-556.132805</td>
      <td>4573.387686</td>
      <td>-37609.496782</td>
      <td>309283.696327</td>
      <td>-2.543411e+06</td>
      <td>2.091587e+07</td>
      <td>-1.720028e+08</td>
      <td>1.414474e+09</td>
    </tr>
    <tr>
      <th>40</th>
      <td>-0.364001</td>
      <td>0.132497</td>
      <td>-0.048229</td>
      <td>0.017555</td>
      <td>-0.006390</td>
      <td>0.002326</td>
      <td>-8.466826e-04</td>
      <td>3.081936e-04</td>
      <td>-1.121829e-04</td>
      <td>4.083471e-05</td>
    </tr>
    <tr>
      <th>41</th>
      <td>6.656568</td>
      <td>44.309900</td>
      <td>294.951869</td>
      <td>1963.367222</td>
      <td>13069.287756</td>
      <td>86996.604895</td>
      <td>5.790988e+05</td>
      <td>3.854811e+06</td>
      <td>2.565981e+07</td>
      <td>1.708063e+08</td>
    </tr>
    <tr>
      <th>42</th>
      <td>-9.804880</td>
      <td>96.135668</td>
      <td>-942.598671</td>
      <td>9242.066675</td>
      <td>-90617.352934</td>
      <td>888492.254125</td>
      <td>-8.711560e+06</td>
      <td>8.541580e+07</td>
      <td>-8.374916e+08</td>
      <td>8.211505e+09</td>
    </tr>
    <tr>
      <th>43</th>
      <td>1.236174</td>
      <td>1.528127</td>
      <td>1.889031</td>
      <td>2.335171</td>
      <td>2.886679</td>
      <td>3.568438</td>
      <td>4.411211e+00</td>
      <td>5.453025e+00</td>
      <td>6.740889e+00</td>
      <td>8.332913e+00</td>
    </tr>
    <tr>
      <th>44</th>
      <td>-2.766259</td>
      <td>7.652191</td>
      <td>-21.167945</td>
      <td>58.556028</td>
      <td>-161.981161</td>
      <td>448.081909</td>
      <td>-1.239511e+03</td>
      <td>3.428808e+03</td>
      <td>-9.484973e+03</td>
      <td>2.623790e+04</td>
    </tr>
    <tr>
      <th>45</th>
      <td>-4.457650</td>
      <td>19.870645</td>
      <td>-88.576385</td>
      <td>394.842539</td>
      <td>-1760.069919</td>
      <td>7845.776000</td>
      <td>-3.497372e+04</td>
      <td>1.559006e+05</td>
      <td>-6.949505e+05</td>
      <td>3.097846e+06</td>
    </tr>
    <tr>
      <th>46</th>
      <td>4.825670</td>
      <td>23.287096</td>
      <td>112.375850</td>
      <td>542.288824</td>
      <td>2616.907175</td>
      <td>12628.331726</td>
      <td>6.094017e+04</td>
      <td>2.940772e+05</td>
      <td>1.419120e+06</td>
      <td>6.848203e+06</td>
    </tr>
    <tr>
      <th>47</th>
      <td>-3.012487</td>
      <td>9.075077</td>
      <td>-27.338548</td>
      <td>82.357015</td>
      <td>-248.099419</td>
      <td>747.396219</td>
      <td>-2.251521e+03</td>
      <td>6.782678e+03</td>
      <td>-2.043273e+04</td>
      <td>6.155332e+04</td>
    </tr>
    <tr>
      <th>48</th>
      <td>3.778329</td>
      <td>14.275771</td>
      <td>53.938563</td>
      <td>203.797646</td>
      <td>770.014590</td>
      <td>2909.368585</td>
      <td>1.099255e+04</td>
      <td>4.153348e+04</td>
      <td>1.569272e+05</td>
      <td>5.929225e+05</td>
    </tr>
    <tr>
      <th>49</th>
      <td>6.068927</td>
      <td>36.831870</td>
      <td>223.529915</td>
      <td>1356.586642</td>
      <td>8233.024737</td>
      <td>49965.622715</td>
      <td>3.032377e+05</td>
      <td>1.840327e+06</td>
      <td>1.116881e+07</td>
      <td>6.778270e+07</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>len(df[cols])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>50
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>len(X_train)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>X_train
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1</th>
      <th>x2</th>
      <th>x3</th>
      <th>x4</th>
      <th>x5</th>
      <th>x6</th>
      <th>x7</th>
      <th>x8</th>
      <th>x9</th>
      <th>x10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>-8.982275</td>
      <td>80.681271</td>
      <td>-724.701394</td>
      <td>6509.467488</td>
      <td>-58469.829551</td>
      <td>525192.110405</td>
      <td>-4.717420e+06</td>
      <td>4.237317e+07</td>
      <td>-3.806075e+08</td>
      <td>3.418721e+09</td>
    </tr>
    <tr>
      <th>11</th>
      <td>6.449735</td>
      <td>41.599085</td>
      <td>268.303082</td>
      <td>1730.483838</td>
      <td>11161.162581</td>
      <td>71986.543546</td>
      <td>4.642941e+05</td>
      <td>2.994574e+06</td>
      <td>1.931421e+07</td>
      <td>1.245716e+08</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.465018</td>
      <td>41.796463</td>
      <td>270.214901</td>
      <td>1746.944309</td>
      <td>11294.027098</td>
      <td>73016.092970</td>
      <td>4.720504e+05</td>
      <td>3.051814e+06</td>
      <td>1.973004e+07</td>
      <td>1.275550e+08</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0.371593</td>
      <td>0.138081</td>
      <td>0.051310</td>
      <td>0.019066</td>
      <td>0.007085</td>
      <td>0.002633</td>
      <td>9.782985e-04</td>
      <td>3.635287e-04</td>
      <td>1.350847e-04</td>
      <td>5.019650e-05</td>
    </tr>
    <tr>
      <th>16</th>
      <td>-3.942982</td>
      <td>15.547104</td>
      <td>-61.301947</td>
      <td>241.712453</td>
      <td>-953.067768</td>
      <td>3757.928725</td>
      <td>-1.481744e+04</td>
      <td>5.842491e+04</td>
      <td>-2.303683e+05</td>
      <td>9.083382e+05</td>
    </tr>
    <tr>
      <th>45</th>
      <td>-4.457650</td>
      <td>19.870645</td>
      <td>-88.576385</td>
      <td>394.842539</td>
      <td>-1760.069919</td>
      <td>7845.776000</td>
      <td>-3.497372e+04</td>
      <td>1.559006e+05</td>
      <td>-6.949505e+05</td>
      <td>3.097846e+06</td>
    </tr>
    <tr>
      <th>15</th>
      <td>5.481667</td>
      <td>30.048674</td>
      <td>164.716823</td>
      <td>902.922780</td>
      <td>4949.522041</td>
      <td>27131.631828</td>
      <td>1.487266e+05</td>
      <td>8.152695e+05</td>
      <td>4.469036e+06</td>
      <td>2.449777e+07</td>
    </tr>
    <tr>
      <th>42</th>
      <td>-9.804880</td>
      <td>96.135668</td>
      <td>-942.598671</td>
      <td>9242.066675</td>
      <td>-90617.352934</td>
      <td>888492.254125</td>
      <td>-8.711560e+06</td>
      <td>8.541580e+07</td>
      <td>-8.374916e+08</td>
      <td>8.211505e+09</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-0.690041</td>
      <td>0.476157</td>
      <td>-0.328568</td>
      <td>0.226726</td>
      <td>-0.156450</td>
      <td>0.107957</td>
      <td>-7.449486e-02</td>
      <td>5.140454e-02</td>
      <td>-3.547126e-02</td>
      <td>2.447664e-02</td>
    </tr>
    <tr>
      <th>35</th>
      <td>4.852230</td>
      <td>23.544134</td>
      <td>114.241552</td>
      <td>554.326269</td>
      <td>2689.718466</td>
      <td>13051.132219</td>
      <td>6.332709e+04</td>
      <td>3.072776e+05</td>
      <td>1.490982e+06</td>
      <td>7.234585e+06</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4.556122</td>
      <td>20.758251</td>
      <td>94.577131</td>
      <td>430.904978</td>
      <td>1963.255801</td>
      <td>8944.833631</td>
      <td>4.075376e+04</td>
      <td>1.856791e+05</td>
      <td>8.459767e+05</td>
      <td>3.854373e+06</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-6.299257</td>
      <td>39.680640</td>
      <td>-249.958554</td>
      <td>1574.553197</td>
      <td>-9918.515413</td>
      <td>62479.278687</td>
      <td>-3.935730e+05</td>
      <td>2.479218e+06</td>
      <td>-1.561723e+07</td>
      <td>9.837695e+07</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>y_train
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13      2.574974
11    130.940520
1      73.954907
25      1.134863
16    -35.901888
45    -26.760377
15     24.441828
42    131.476240
20     61.591699
35    -13.988943
9       1.089803
10     -7.251101
Name: y, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>X_test
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1</th>
      <th>x2</th>
      <th>x3</th>
      <th>x4</th>
      <th>x5</th>
      <th>x6</th>
      <th>x7</th>
      <th>x8</th>
      <th>x9</th>
      <th>x10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>49</th>
      <td>6.068927</td>
      <td>36.831870</td>
      <td>223.529915</td>
      <td>1356.586642</td>
      <td>8233.024737</td>
      <td>49965.622715</td>
      <td>3.032377e+05</td>
      <td>1.840327e+06</td>
      <td>1.116881e+07</td>
      <td>6.778270e+07</td>
    </tr>
    <tr>
      <th>40</th>
      <td>-0.364001</td>
      <td>0.132497</td>
      <td>-0.048229</td>
      <td>0.017555</td>
      <td>-0.006390</td>
      <td>0.002326</td>
      <td>-8.466826e-04</td>
      <td>3.081936e-04</td>
      <td>-1.121829e-04</td>
      <td>4.083471e-05</td>
    </tr>
    <tr>
      <th>38</th>
      <td>-1.602675</td>
      <td>2.568568</td>
      <td>-4.116580</td>
      <td>6.597541</td>
      <td>-10.573716</td>
      <td>16.946233</td>
      <td>-2.715931e+01</td>
      <td>4.352755e+01</td>
      <td>-6.976053e+01</td>
      <td>1.118035e+02</td>
    </tr>
    <tr>
      <th>23</th>
      <td>4.441058</td>
      <td>19.722998</td>
      <td>87.590980</td>
      <td>388.996638</td>
      <td>1727.556699</td>
      <td>7672.179799</td>
      <td>3.407260e+04</td>
      <td>1.513184e+05</td>
      <td>6.720137e+05</td>
      <td>2.984452e+06</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-5.656363</td>
      <td>31.994443</td>
      <td>-180.972185</td>
      <td>1023.644381</td>
      <td>-5790.104257</td>
      <td>32750.931784</td>
      <td>-1.852512e+05</td>
      <td>1.047848e+06</td>
      <td>-5.927008e+06</td>
      <td>3.352531e+07</td>
    </tr>
    <tr>
      <th>0</th>
      <td>-3.329208</td>
      <td>11.083626</td>
      <td>-36.899694</td>
      <td>122.846756</td>
      <td>-408.982395</td>
      <td>1361.587441</td>
      <td>-4.533008e+03</td>
      <td>1.509133e+04</td>
      <td>-5.024216e+04</td>
      <td>1.672666e+05</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-6.557409</td>
      <td>42.999609</td>
      <td>-281.966007</td>
      <td>1848.966339</td>
      <td>-12124.427923</td>
      <td>79504.828902</td>
      <td>-5.213457e+05</td>
      <td>3.418677e+06</td>
      <td>-2.241766e+07</td>
      <td>1.470018e+08</td>
    </tr>
    <tr>
      <th>34</th>
      <td>-1.384337</td>
      <td>1.916390</td>
      <td>-2.652930</td>
      <td>3.672550</td>
      <td>-5.084049</td>
      <td>7.038039</td>
      <td>-9.743020e+00</td>
      <td>1.348763e+01</td>
      <td>-1.867143e+01</td>
      <td>2.584755e+01</td>
    </tr>
    <tr>
      <th>14</th>
      <td>-9.026659</td>
      <td>81.480574</td>
      <td>-735.497357</td>
      <td>6639.083877</td>
      <td>-59928.746571</td>
      <td>540956.362638</td>
      <td>-4.883029e+06</td>
      <td>4.407743e+07</td>
      <td>-3.978720e+08</td>
      <td>3.591455e+09</td>
    </tr>
    <tr>
      <th>31</th>
      <td>6.893150</td>
      <td>47.515521</td>
      <td>327.531630</td>
      <td>2257.724760</td>
      <td>15562.836137</td>
      <td>107276.968808</td>
      <td>7.394763e+05</td>
      <td>5.097321e+06</td>
      <td>3.513660e+07</td>
      <td>2.422019e+08</td>
    </tr>
    <tr>
      <th>48</th>
      <td>3.778329</td>
      <td>14.275771</td>
      <td>53.938563</td>
      <td>203.797646</td>
      <td>770.014590</td>
      <td>2909.368585</td>
      <td>1.099255e+04</td>
      <td>4.153348e+04</td>
      <td>1.569272e+05</td>
      <td>5.929225e+05</td>
    </tr>
    <tr>
      <th>24</th>
      <td>-6.563454</td>
      <td>43.078928</td>
      <td>-282.746563</td>
      <td>1855.794057</td>
      <td>-12180.418898</td>
      <td>79945.618965</td>
      <td>-5.247194e+05</td>
      <td>3.443972e+06</td>
      <td>-2.260435e+07</td>
      <td>1.483626e+08</td>
    </tr>
    <tr>
      <th>19</th>
      <td>-9.924588</td>
      <td>98.497442</td>
      <td>-977.546500</td>
      <td>9701.745999</td>
      <td>-96285.829291</td>
      <td>955597.159837</td>
      <td>-9.483908e+06</td>
      <td>9.412388e+07</td>
      <td>-9.341407e+08</td>
      <td>9.270961e+09</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.043272</td>
      <td>4.174960</td>
      <td>8.530580</td>
      <td>17.430295</td>
      <td>35.614834</td>
      <td>72.770792</td>
      <td>1.486905e+02</td>
      <td>3.038152e+02</td>
      <td>6.207771e+02</td>
      <td>1.268416e+03</td>
    </tr>
    <tr>
      <th>41</th>
      <td>6.656568</td>
      <td>44.309900</td>
      <td>294.951869</td>
      <td>1963.367222</td>
      <td>13069.287756</td>
      <td>86996.604895</td>
      <td>5.790988e+05</td>
      <td>3.854811e+06</td>
      <td>2.565981e+07</td>
      <td>1.708063e+08</td>
    </tr>
    <tr>
      <th>28</th>
      <td>3.165616</td>
      <td>10.021126</td>
      <td>31.723040</td>
      <td>100.422972</td>
      <td>317.900593</td>
      <td>1006.351284</td>
      <td>3.185722e+03</td>
      <td>1.008477e+04</td>
      <td>3.192452e+04</td>
      <td>1.010608e+05</td>
    </tr>
    <tr>
      <th>43</th>
      <td>1.236174</td>
      <td>1.528127</td>
      <td>1.889031</td>
      <td>2.335171</td>
      <td>2.886679</td>
      <td>3.568438</td>
      <td>4.411211e+00</td>
      <td>5.453025e+00</td>
      <td>6.740889e+00</td>
      <td>8.332913e+00</td>
    </tr>
    <tr>
      <th>30</th>
      <td>-6.470932</td>
      <td>41.872959</td>
      <td>-270.957061</td>
      <td>1753.344667</td>
      <td>-11345.773804</td>
      <td>73417.728768</td>
      <td>-4.750811e+05</td>
      <td>3.074218e+06</td>
      <td>-1.989305e+07</td>
      <td>1.287266e+08</td>
    </tr>
    <tr>
      <th>47</th>
      <td>-3.012487</td>
      <td>9.075077</td>
      <td>-27.338548</td>
      <td>82.357015</td>
      <td>-248.099419</td>
      <td>747.396219</td>
      <td>-2.251521e+03</td>
      <td>6.782678e+03</td>
      <td>-2.043273e+04</td>
      <td>6.155332e+04</td>
    </tr>
    <tr>
      <th>17</th>
      <td>7.135269</td>
      <td>50.912060</td>
      <td>363.271234</td>
      <td>2592.037885</td>
      <td>18494.886953</td>
      <td>131965.989144</td>
      <td>9.416128e+05</td>
      <td>6.718660e+06</td>
      <td>4.793945e+07</td>
      <td>3.420608e+08</td>
    </tr>
    <tr>
      <th>21</th>
      <td>4.510288</td>
      <td>20.342695</td>
      <td>91.751404</td>
      <td>413.825225</td>
      <td>1866.470799</td>
      <td>8418.320181</td>
      <td>3.796905e+04</td>
      <td>1.712513e+05</td>
      <td>7.723927e+05</td>
      <td>3.483713e+06</td>
    </tr>
    <tr>
      <th>29</th>
      <td>5.222245</td>
      <td>27.271843</td>
      <td>142.420249</td>
      <td>743.753442</td>
      <td>3884.062733</td>
      <td>20283.527393</td>
      <td>1.059256e+05</td>
      <td>5.531692e+05</td>
      <td>2.888785e+06</td>
      <td>1.508594e+07</td>
    </tr>
    <tr>
      <th>39</th>
      <td>-8.223553</td>
      <td>67.626827</td>
      <td>-556.132805</td>
      <td>4573.387686</td>
      <td>-37609.496782</td>
      <td>309283.696327</td>
      <td>-2.543411e+06</td>
      <td>2.091587e+07</td>
      <td>-1.720028e+08</td>
      <td>1.414474e+09</td>
    </tr>
    <tr>
      <th>18</th>
      <td>4.196026</td>
      <td>17.606638</td>
      <td>73.877921</td>
      <td>309.993714</td>
      <td>1300.741838</td>
      <td>5457.947214</td>
      <td>2.290169e+04</td>
      <td>9.609610e+04</td>
      <td>4.032218e+05</td>
      <td>1.691929e+06</td>
    </tr>
    <tr>
      <th>22</th>
      <td>-9.336060</td>
      <td>87.162025</td>
      <td>-813.749934</td>
      <td>7597.218586</td>
      <td>-70928.092042</td>
      <td>662188.955593</td>
      <td>-6.182236e+06</td>
      <td>5.771773e+07</td>
      <td>-5.388562e+08</td>
      <td>5.030794e+09</td>
    </tr>
    <tr>
      <th>44</th>
      <td>-2.766259</td>
      <td>7.652191</td>
      <td>-21.167945</td>
      <td>58.556028</td>
      <td>-161.981161</td>
      <td>448.081909</td>
      <td>-1.239511e+03</td>
      <td>3.428808e+03</td>
      <td>-9.484973e+03</td>
      <td>2.623790e+04</td>
    </tr>
    <tr>
      <th>37</th>
      <td>-2.738399</td>
      <td>7.498829</td>
      <td>-20.534785</td>
      <td>56.232432</td>
      <td>-153.986833</td>
      <td>421.677380</td>
      <td>-1.154721e+03</td>
      <td>3.162086e+03</td>
      <td>-8.659054e+03</td>
      <td>2.371194e+04</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.578506</td>
      <td>0.334669</td>
      <td>-0.193608</td>
      <td>0.112004</td>
      <td>-0.064795</td>
      <td>0.037484</td>
      <td>-2.168480e-02</td>
      <td>1.254479e-02</td>
      <td>-7.257238e-03</td>
      <td>4.198356e-03</td>
    </tr>
    <tr>
      <th>32</th>
      <td>-3.493023</td>
      <td>12.201207</td>
      <td>-42.619094</td>
      <td>148.869463</td>
      <td>-520.004411</td>
      <td>1816.387202</td>
      <td>-6.344682e+03</td>
      <td>2.216212e+04</td>
      <td>-7.741278e+04</td>
      <td>2.704046e+05</td>
    </tr>
    <tr>
      <th>27</th>
      <td>-2.965964</td>
      <td>8.796943</td>
      <td>-26.091415</td>
      <td>77.386199</td>
      <td>-229.524684</td>
      <td>680.761955</td>
      <td>-2.019115e+03</td>
      <td>5.988624e+03</td>
      <td>-1.776204e+04</td>
      <td>5.268158e+04</td>
    </tr>
    <tr>
      <th>46</th>
      <td>4.825670</td>
      <td>23.287096</td>
      <td>112.375850</td>
      <td>542.288824</td>
      <td>2616.907175</td>
      <td>12628.331726</td>
      <td>6.094017e+04</td>
      <td>2.940772e+05</td>
      <td>1.419120e+06</td>
      <td>6.848203e+06</td>
    </tr>
    <tr>
      <th>12</th>
      <td>3.660112</td>
      <td>13.396416</td>
      <td>49.032378</td>
      <td>179.463974</td>
      <td>656.858162</td>
      <td>2404.174135</td>
      <td>8.799545e+03</td>
      <td>3.220732e+04</td>
      <td>1.178824e+05</td>
      <td>4.314626e+05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-4.478046</td>
      <td>20.052899</td>
      <td>-89.797810</td>
      <td>402.118751</td>
      <td>-1800.706392</td>
      <td>8063.646628</td>
      <td>-3.610938e+04</td>
      <td>1.616995e+05</td>
      <td>-7.240978e+05</td>
      <td>3.242544e+06</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.108538</td>
      <td>0.011781</td>
      <td>0.001279</td>
      <td>0.000139</td>
      <td>0.000015</td>
      <td>0.000002</td>
      <td>1.774525e-07</td>
      <td>1.926040e-08</td>
      <td>2.090492e-09</td>
      <td>2.268986e-10</td>
    </tr>
    <tr>
      <th>36</th>
      <td>3.727977</td>
      <td>13.897811</td>
      <td>51.810717</td>
      <td>193.149152</td>
      <td>720.055560</td>
      <td>2684.350427</td>
      <td>1.000720e+04</td>
      <td>3.730660e+04</td>
      <td>1.390781e+05</td>
      <td>5.184800e+05</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.850593</td>
      <td>23.528255</td>
      <td>114.125996</td>
      <td>553.578791</td>
      <td>2685.185564</td>
      <td>13024.743051</td>
      <td>6.317773e+04</td>
      <td>3.064495e+05</td>
      <td>1.486462e+06</td>
      <td>7.210222e+06</td>
    </tr>
    <tr>
      <th>33</th>
      <td>-8.747075</td>
      <td>76.511319</td>
      <td>-669.250243</td>
      <td>5853.982010</td>
      <td>-51205.219163</td>
      <td>447895.887816</td>
      <td>-3.917779e+06</td>
      <td>3.426911e+07</td>
      <td>-2.997544e+08</td>
      <td>2.621974e+09</td>
    </tr>
    <tr>
      <th>26</th>
      <td>6.520774</td>
      <td>42.520497</td>
      <td>277.266559</td>
      <td>1807.992633</td>
      <td>11789.511780</td>
      <td>76876.744660</td>
      <td>5.012959e+05</td>
      <td>3.268837e+06</td>
      <td>2.131535e+07</td>
      <td>1.389926e+08</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>50*0.24
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.0
</pre></div>
</div>
</div>
</div>
<section id="performing-polynomial-regression-for-each-degree">
<h3>Performing Polynomial Regression for Each Degree<a class="headerlink" href="#performing-polynomial-regression-for-each-degree" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#not doing anything yet, just showing how degree changes
for i in range(1,max_deg+1):
    sub_cols = cols[:i]
    reg = LinearRegression()
    print(sub_cols)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;x1&#39;]
[&#39;x1&#39;, &#39;x2&#39;]
[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;]
[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;, &#39;x4&#39;]
[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;, &#39;x4&#39;, &#39;x5&#39;]
[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;, &#39;x4&#39;, &#39;x5&#39;, &#39;x6&#39;]
[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;, &#39;x4&#39;, &#39;x5&#39;, &#39;x6&#39;, &#39;x7&#39;]
[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;, &#39;x4&#39;, &#39;x5&#39;, &#39;x6&#39;, &#39;x7&#39;, &#39;x8&#39;]
[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;, &#39;x4&#39;, &#39;x5&#39;, &#39;x6&#39;, &#39;x7&#39;, &#39;x8&#39;, &#39;x9&#39;]
[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;, &#39;x4&#39;, &#39;x5&#39;, &#39;x6&#39;, &#39;x7&#39;, &#39;x8&#39;, &#39;x9&#39;, &#39;x10&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="evaluating-the-performance-part-1">
<h3>Evaluating the Performance, Part 1<a class="headerlink" href="#evaluating-the-performance-part-1" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mse_training_dict = {}
for i in range(1,max_deg+1):
    sub_cols = cols[:i]
    reg = LinearRegression()
    reg.fit(X_train[sub_cols],y_train)
    mse_training_dict[i] = mean_squared_error(reg.predict(X_train[sub_cols]),y_train)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mse_training_dict
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1: 3006.2441403930584,
 2: 1845.1659476797647,
 3: 1820.05419658703,
 4: 590.386208100543,
 5: 589.0984843939517,
 6: 523.8762601493493,
 7: 373.27949678005854,
 8: 206.85098887525973,
 9: 204.9933133278071,
 10: 101.4717525424262}
</pre></div>
</div>
</div>
</div>
<p>Looking at the MSE for each degree, we’d think that degree 10 is the best fit. There is a big issue, however! That is, we are predicting on the training set. This means there’s a huge risk of overfitting.</p>
</section>
<section id="evaluating-the-performance-part-2">
<h3>Evaluating the Performance, Part 2<a class="headerlink" href="#evaluating-the-performance-part-2" title="Permalink to this headline">#</a></h3>
<p>To get a meaningful MSE, we should always evaluate on a test set (not use during training).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mse_test_dict = {}
for i in range(1,max_deg+1):
    sub_cols = cols[:i]
    reg = LinearRegression()
    reg.fit(X_train[sub_cols],y_train)
    df[f&quot;Pred{i}&quot;] = reg.predict(df[sub_cols])
    mse_test_dict[i] = mean_squared_error(reg.predict(X_test[sub_cols]),y_test)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mse_test_dict
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1: 4960.848889431734,
 2: 3724.5263419375206,
 3: 3742.5488620098768,
 4: 6252.874102524008,
 5: 6253.4123849934285,
 6: 7016.575636379848,
 7: 5609.641936194314,
 8: 9481.527367001438,
 9: 12142.080032238073,
 10: 103395.23803044269}
</pre></div>
</div>
</div>
</div>
<p>Notice now that degree 2 is where we have the smallest MSE (unlike the previous example, where we got 10). This is encouraging, because we know that the true underlying data has degree 2. There is some randomness here, though, if you play around with the random states, we sometimes get degree 3 or 4 as the minimum for MSE.</p>
</section>
<section id="plotting-the-polynomial-fits">
<h3>Plotting the polynomial fits<a class="headerlink" href="#plotting-the-polynomial-fits" title="Permalink to this headline">#</a></h3>
<p>Before plotting, we add a column which tells us whether a point was in the training set, or the testing set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df[&quot;In_train&quot;] = &quot;test&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>X_train.index
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Int64Index([13, 11, 1, 25, 16, 45, 15, 42, 20, 35, 9, 10], dtype=&#39;int64&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df.loc[X_train.index,&quot;In_train&quot;] = &quot;train&quot;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13    False
11    False
1     False
25    False
16    False
45    False
15    False
42    False
20    False
35    False
9     False
10    False
Name: In_train, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>c = alt.Chart(df).mark_circle().encode(
    x=&quot;x&quot;, 
    y=&quot;y&quot;,
    color=&quot;In_train&quot;
)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>c_true = alt.Chart(df).mark_line(color=&quot;black&quot;).encode(
    x=&quot;x&quot;,
    y=&quot;y_true&quot;,
)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>chart_list = []
for i in range(1,max_deg+1):
    c_temp = alt.Chart(df).mark_line(color=&quot;red&quot;, clip=True).encode(
        x=&quot;x&quot;,
        y=alt.Y(f&quot;Pred{i}&quot;).scale(domain=(-100,300)),
    )
    chart_list.append(c_temp)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>all_charts = [c+c_true+d for d in chart_list]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>alt.vconcat(*all_charts)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-3befc580c00d4b11b3339b1361aa718a.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-3befc580c00d4b11b3339b1361aa718a.vega-embed details,
  #altair-viz-3befc580c00d4b11b3339b1361aa718a.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-3befc580c00d4b11b3339b1361aa718a"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-3befc580c00d4b11b3339b1361aa718a") {
      outputDiv = document.getElementById("altair-viz-3befc580c00d4b11b3339b1361aa718a");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "vconcat": [{"layer": [{"mark": {"type": "circle"}, "encoding": {"color": {"field": "In_train", "type": "nominal"}, "x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "black"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y_true", "type": "quantitative"}}}, {"mark": {"type": "line", "clip": true, "color": "red"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "Pred1", "scale": {"domain": [-100, 300]}, "type": "quantitative"}}}]}, {"layer": [{"mark": {"type": "circle"}, "encoding": {"color": {"field": "In_train", "type": "nominal"}, "x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "black"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y_true", "type": "quantitative"}}}, {"mark": {"type": "line", "clip": true, "color": "red"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "Pred2", "scale": {"domain": [-100, 300]}, "type": "quantitative"}}}]}, {"layer": [{"mark": {"type": "circle"}, "encoding": {"color": {"field": "In_train", "type": "nominal"}, "x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "black"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y_true", "type": "quantitative"}}}, {"mark": {"type": "line", "clip": true, "color": "red"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "Pred3", "scale": {"domain": [-100, 300]}, "type": "quantitative"}}}]}, {"layer": [{"mark": {"type": "circle"}, "encoding": {"color": {"field": "In_train", "type": "nominal"}, "x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "black"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y_true", "type": "quantitative"}}}, {"mark": {"type": "line", "clip": true, "color": "red"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "Pred4", "scale": {"domain": [-100, 300]}, "type": "quantitative"}}}]}, {"layer": [{"mark": {"type": "circle"}, "encoding": {"color": {"field": "In_train", "type": "nominal"}, "x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "black"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y_true", "type": "quantitative"}}}, {"mark": {"type": "line", "clip": true, "color": "red"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "Pred5", "scale": {"domain": [-100, 300]}, "type": "quantitative"}}}]}, {"layer": [{"mark": {"type": "circle"}, "encoding": {"color": {"field": "In_train", "type": "nominal"}, "x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "black"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y_true", "type": "quantitative"}}}, {"mark": {"type": "line", "clip": true, "color": "red"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "Pred6", "scale": {"domain": [-100, 300]}, "type": "quantitative"}}}]}, {"layer": [{"mark": {"type": "circle"}, "encoding": {"color": {"field": "In_train", "type": "nominal"}, "x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "black"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y_true", "type": "quantitative"}}}, {"mark": {"type": "line", "clip": true, "color": "red"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "Pred7", "scale": {"domain": [-100, 300]}, "type": "quantitative"}}}]}, {"layer": [{"mark": {"type": "circle"}, "encoding": {"color": {"field": "In_train", "type": "nominal"}, "x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "black"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y_true", "type": "quantitative"}}}, {"mark": {"type": "line", "clip": true, "color": "red"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "Pred8", "scale": {"domain": [-100, 300]}, "type": "quantitative"}}}]}, {"layer": [{"mark": {"type": "circle"}, "encoding": {"color": {"field": "In_train", "type": "nominal"}, "x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "black"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y_true", "type": "quantitative"}}}, {"mark": {"type": "line", "clip": true, "color": "red"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "Pred9", "scale": {"domain": [-100, 300]}, "type": "quantitative"}}}]}, {"layer": [{"mark": {"type": "circle"}, "encoding": {"color": {"field": "In_train", "type": "nominal"}, "x": {"field": "x", "type": "quantitative"}, "y": {"field": "y", "type": "quantitative"}}}, {"mark": {"type": "line", "color": "black"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "y_true", "type": "quantitative"}}}, {"mark": {"type": "line", "clip": true, "color": "red"}, "encoding": {"x": {"field": "x", "type": "quantitative"}, "y": {"field": "Pred10", "scale": {"domain": [-100, 300]}, "type": "quantitative"}}}]}], "data": {"name": "data-db1b15399884e4d8ba80ec73ef18705a"}, "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-db1b15399884e4d8ba80ec73ef18705a": [{"x": -3.329207948258288, "y_true": -18.207589131190502, "y": -117.48489981507691, "x1": -3.329207948258288, "x2": 11.08362556274616, "x3": -36.89969431901326, "x4": 122.84675561516016, "x5": -408.9823952117346, "x6": 1361.5874408366194, "x7": -4533.007730281935, "x8": 15091.32536517088, "x9": -50242.16035547881, "x10": 167266.5995931275, "pred1": 25.013013608891583, "pred2": -16.647390185071405, "pred3": -19.95403706165834, "pred4": 6.71556679660884, "pred5": 5.215953724498782, "pred6": -7.995403749024085, "pred7": -18.57618468463712, "pred8": 3.146424427458328, "pred9": -5.566198922377755, "pred10": -15.676048934258432, "In_train": "test", "Pred1": 25.013013608891583, "Pred2": -16.647390185071405, "Pred3": -19.95403706165834, "Pred4": 6.71556679660884, "Pred5": 5.215953724498782, "Pred6": -7.995403749024085, "Pred7": -18.57618468463712, "Pred8": 3.146424427458328, "Pred9": -5.566198922377755, "Pred10": -15.676048934258432}, {"x": 6.465018397406531, "y_true": 74.16056232333514, "y": 73.95490734658352, "x1": 6.465018397406531, "x2": 41.79646287880492, "x3": 270.21490145799294, "x4": 1746.944309179317, "x5": 11294.027098088927, "x6": 73016.09296995284, "x7": 472050.3843574908, "x8": 3051814.419374002, "x9": 19730036.36672345, "x10": 127555048.09236704, "pred1": 37.460378801024675, "pred2": 70.91691572638607, "pred3": 65.45511622713667, "pred4": 101.80867888875699, "pred5": 102.35061177185855, "pred6": 105.13506607294627, "pred7": 100.3925894695821, "pred8": 103.47457086006828, "pred9": 103.85438995812056, "pred10": 97.07822038078119, "In_train": "train", "Pred1": 37.460378801024675, "Pred2": 70.91691572638607, "Pred3": 65.45511622713667, "Pred4": 101.80867888875699, "Pred5": 102.35061177185855, "Pred6": 105.13506607294627, "Pred7": 100.3925894695821, "Pred8": 103.47457086006828, "Pred9": 103.85438995812056, "Pred10": 97.07822038078119}, {"x": -4.478046317204917, "y_true": -7.670061908184866, "y": -13.810088667204978, "x1": -4.478046317204917, "x2": 20.052898819032524, "x3": -89.79780970585144, "x4": 402.118751046356, "x5": -1800.7063922021755, "x6": 8063.646627968305, "x7": -36109.38308561532, "x8": 161699.48994308122, "x9": -724097.8054335285, "x10": 3242543.510917775, "pred1": 23.552968657884016, "pred2": -9.287827270461985, "pred3": -14.954227616478397, "pred4": -16.790956763156842, "pred5": -18.030385622679958, "pred6": -17.560872982927542, "pred7": -25.152785279043982, "pred8": -38.972802643593, "pred9": -35.76877017503003, "pred10": -25.492482043821852, "In_train": "test", "Pred1": 23.552968657884016, "Pred2": -9.287827270461985, "Pred3": -14.954227616478397, "Pred4": -16.790956763156842, "Pred5": -18.030385622679958, "Pred6": -17.560872982927542, "Pred7": -25.152785279043982, "Pred8": -38.972802643593, "Pred9": -35.76877017503003, "Pred10": -25.492482043821852}, {"x": 2.043272001247484, "y_true": -7.9251519940460895, "y": 19.46118237861152, "x1": 2.043272001247484, "x2": 4.1749604710818975, "x3": 8.530579836876647, "x4": 17.43029493509638, "x5": 35.614833614368266, "x6": 72.7707923533264, "x7": 148.69052252414633, "x8": 303.8151815244466, "x9": 620.7770539628235, "x10": 1268.4163733791356, "pred1": 31.840834159364253, "pred2": -1.9301870082762012, "pred3": 6.789503045665988, "pred4": -5.399120115774707, "pred5": -3.5673985031830178, "pred6": 30.239546175103424, "pred7": -11.206588986203911, "pred8": -73.99143931904912, "pred9": -94.22291808138984, "pred10": 94.58511716043202, "In_train": "test", "Pred1": 31.840834159364253, "Pred2": -1.9301870082762012, "Pred3": 6.789503045665988, "Pred4": -5.399120115774707, "Pred5": -3.5673985031830178, "Pred6": 30.239546175103424, "Pred7": -11.206588986203911, "Pred8": -73.99143931904912, "Pred9": -94.22291808138984, "Pred10": 94.58511716043202}, {"x": 4.850593279708996, "y_true": 36.48546622757559, "y": 22.37523008579901, "x1": 4.850593279708996, "x2": 23.52825516515807, "x3": 114.1259963873942, "x4": 553.5787911167873, "x5": 2685.1855639805185, "x6": 13024.743051415511, "x7": 63177.73111513252, "x8": 306449.4779743237, "x9": 1486461.7784325844, "x10": 7210221.513009375, "pred1": 35.40862521619677, "pred2": 37.96374344991133, "pred3": 42.17919935702657, "pred4": -1.4651575677246278, "pred5": -2.10051271346763, "pred6": -2.4866111191063354, "pred7": -5.545758034141187, "pred8": 0.4752249204718595, "pred9": 2.0014006688860384, "pred10": -21.612848818708258, "In_train": "test", "Pred1": 35.40862521619677, "Pred2": 37.96374344991133, "Pred3": 42.17919935702657, "Pred4": -1.4651575677246278, "Pred5": -2.10051271346763, "Pred6": -2.4866111191063354, "Pred7": -5.545758034141187, "Pred8": 0.4752249204718595, "Pred9": 2.0014006688860384, "Pred10": -21.612848818708258}, {"x": -0.5785060804889142, "y_true": -25.20293714522805, "y": -25.44530061571687, "x1": -0.5785060804889142, "x2": 0.334669285162646, "x3": -0.193608216419469, "x4": 0.1120035304312764, "x5": -0.0647947233907185, "x6": 0.0374841414651279, "x7": -0.0216848037594831, "x8": 0.0125447908290698, "x9": -0.0072572377730784, "x10": 0.0041983561792797, "pred1": 28.50884773344835, "pred2": -19.22589237143702, "pred3": -15.077488077597117, "pred4": 27.427483218509664, "pred5": 28.131061694105625, "pred6": 21.01276543643874, "pred7": 30.84927789922483, "pred8": 52.45224655489511, "pred9": 53.726375242081645, "pred10": 55.03118453656567, "In_train": "test", "Pred1": 28.50884773344835, "Pred2": -19.22589237143702, "Pred3": -15.077488077597117, "Pred4": 27.427483218509664, "Pred5": 28.131061694105625, "Pred6": 21.01276543643874, "Pred7": 30.84927789922483, "Pred8": 52.45224655489511, "Pred9": 53.726375242081645, "Pred10": 55.03118453656567}, {"x": -6.557408679959602, "y_true": 22.813959025381838, "y": 76.67574767286865, "x1": -6.557408679959602, "x2": 42.99960859600953, "x3": -281.9660066423384, "x4": 1848.9663394100169, "x5": -12124.427923000376, "x6": 79504.82890182723, "x7": -521345.6551395449, "x8": 3418676.524271277, "x9": -22417659.1142306, "x10": 147001752.4600312, "pred1": 20.91033188571665, "pred2": 13.446467384077327, "pred3": 6.781499152348349, "pred4": -48.19501672273919, "pred5": -46.81410639650125, "pred6": -35.67954478110873, "pred7": -14.962538724404872, "pred8": 5.088488859399135, "pred9": -0.4716662481719318, "pred10": -45.929377906572896, "In_train": "test", "Pred1": 20.91033188571665, "Pred2": 13.446467384077327, "Pred3": 6.781499152348349, "Pred4": -48.19501672273919, "Pred5": -46.81410639650125, "Pred6": -35.67954478110873, "Pred7": -14.962538724404872, "Pred8": 5.088488859399135, "Pred9": -0.4716662481719318, "Pred10": -45.929377906572896}, {"x": -5.656363051930528, "y_true": 7.799464545001062, "y": 59.65376106978435, "x1": -5.656363051930528, "x2": 31.99444297524484, "x3": -180.97218511227317, "x4": 1023.6443812961938, "x5": -5790.104256680076, "x6": 32750.93178431085, "x7": -185251.1604610731, "x8": 1047847.8193592674, "x9": -5927007.689469734, "x10": 33525307.30322473, "pred1": 22.055460004163404, "pred2": 2.106118254495655, "pred3": -4.775675549486088, "pred4": -39.526438019300485, "pred5": -39.51584944731005, "pred6": -28.105798988977178, "pred7": -18.877712411970897, "pred8": -29.950175660468588, "pred9": -22.46138209220084, "pred10": 28.396943734153623, "In_train": "test", "Pred1": 22.055460004163404, "Pred2": 2.106118254495655, "Pred3": -4.775675549486088, "Pred4": -39.526438019300485, "Pred5": -39.51584944731005, "Pred6": -28.105798988977178, "Pred7": -18.877712411970897, "Pred8": -29.950175660468588, "Pred9": -22.46138209220084, "Pred10": 28.396943734153623}, {"x": 0.1085383400545652, "y_true": -22.93496583463122, "y": -66.10368783700659, "x1": 0.1085383400545652, "x2": 0.0117805712618004, "x3": 0.0012786436496503, "x4": 0.0001387818592543, "x5": 1.5063152633154338e-05, "x6": 1.6349295827911247e-06, "x7": 1.774525430222515e-07, "x8": 1.9260404458096493e-08, "x9": 2.0904923286613407e-09, "x10": 2.2689856724970447e-10, "pred1": 29.382004275262133, "pred2": -16.557633210765776, "pred3": -10.728149810404252, "pred4": 22.204741622477584, "pred5": 23.531355635417842, "pred6": 27.909520247199954, "pred7": 32.003744977992646, "pred8": 20.57539743071289, "pred9": 21.617692184847193, "pred10": 11.862560894893498, "In_train": "test", "Pred1": 29.382004275262133, "Pred2": -16.557633210765776, "Pred3": -10.728149810404252, "Pred4": 22.204741622477584, "Pred5": 23.531355635417842, "Pred6": 27.909520247199954, "Pred7": 32.003744977992646, "Pred8": 20.57539743071289, "Pred9": 21.617692184847193, "Pred10": 11.862560894893498}, {"x": 4.556122347821622, "y_true": 30.569128068211988, "y": 1.089803157452213, "x1": 4.556122347821622, "x2": 20.75825084831961, "x3": 94.57713059171614, "x4": 430.90497828176194, "x5": 1963.2558013371265, "x6": 8944.833630962528, "x7": 40753.75640357481, "x8": 185679.10030800573, "x9": 845976.6984367175, "x10": 3854373.341483882, "pred1": 35.03438562867771, "pred2": 32.74139511802628, "pred3": 38.088509702796124, "pred4": -9.376876527599308, "pred5": -9.78182256242075, "pred6": -3.264268973661075, "pred7": -21.065226139140634, "pred8": -11.073081924192493, "pred9": -11.993277945849531, "pred10": 5.927629715588168, "In_train": "train", "Pred1": 35.03438562867771, "Pred2": 32.74139511802628, "Pred3": 38.088509702796124, "Pred4": -9.376876527599308, "Pred5": -9.78182256242075, "Pred6": -3.264268973661075, "Pred7": -21.065226139140634, "Pred8": -11.073081924192493, "Pred9": -11.993277945849531, "Pred10": 5.927629715588168}, {"x": -6.299257105127305, "y_true": 18.23013399902268, "y": -7.25110091586216, "x1": -6.299257105127305, "x2": 39.68064007649684, "x3": -249.958553937872, "x4": 1574.553196880487, "x5": -9918.515412850318, "x6": 62479.27868671205, "x7": -393573.0401904999, "x8": 2479217.7698065606, "x9": -15617230.15161185, "x10": 98376947.99494933, "pred1": 21.238413636480374, "pred2": 9.964685036076986, "pred3": 3.119924132309034, "pred4": -46.95250898119371, "pred5": -45.97523713057898, "pred6": -33.794618092293476, "pred7": -15.455145659661063, "pred8": -5.525480689492284, "pred9": -6.030240657393495, "pred10": -7.299106778014007, "In_train": "train", "Pred1": 21.238413636480374, "Pred2": 9.964685036076986, "Pred3": 3.119924132309034, "Pred4": -46.95250898119371, "Pred5": -45.97523713057898, "Pred6": -33.794618092293476, "Pred7": -15.455145659661063, "Pred8": -5.525480689492284, "Pred9": -6.030240657393495, "Pred10": -7.299106778014007}, {"x": 6.449735233464434, "y_true": 73.76235824625147, "y": 130.94052037260485, "x1": 6.449735233464434, "x2": 41.59908458179252, "x3": 268.3030815070543, "x4": 1730.483838043128, "x5": 11161.162581167524, "x6": 71986.54354618103, "x7": 464294.1462451255, "x8": 2994574.3137284745, "x9": 19314211.46048212, "x10": 124571550.1632541, "pred1": 37.440955610650605, "pred2": 70.57068581983773, "pred3": 65.23051085700905, "pred4": 100.24042326137192, "pred5": 100.7396019423023, "pred6": 102.78367158202147, "pred7": 99.94950803886925, "pred8": 100.77027831010649, "pred9": 100.47335225793846, "pred10": 106.78018925200921, "In_train": "train", "Pred1": 37.440955610650605, "Pred2": 70.57068581983773, "Pred3": 65.23051085700905, "Pred4": 100.24042326137192, "Pred5": 100.7396019423023, "Pred6": 102.78367158202147, "Pred7": 99.94950803886925, "Pred8": 100.77027831010649, "Pred9": 100.47335225793846, "Pred10": 106.78018925200921}, {"x": 3.6601115365364834, "y_true": 14.380365281608256, "y": 8.061647596412477, "x1": 3.6601115365364834, "x2": 13.396416459887456, "x3": 49.03237843308132, "x4": 179.4639739667436, "x5": 656.8581615083614, "x6": 2404.174134804898, "x7": 8799.545486642026, "x8": 32207.31795193602, "x9": 117882.3759967796, "x10": 431462.64434014447, "pred1": 33.89565619864956, "pred2": 18.346840573220668, "pred3": 26.095006133691285, "pred4": -19.444430742257268, "pred5": -18.907574851079765, "pred6": 6.966762488407024, "pred7": -43.07331106235309, "pred8": -50.79009792088823, "pred9": -65.64183130838676, "pred10": 139.87315647513793, "In_train": "test", "Pred1": 33.89565619864956, "Pred2": 18.346840573220668, "Pred3": 26.095006133691285, "Pred4": -19.444430742257268, "Pred5": -18.907574851079765, "Pred6": 6.966762488407024, "Pred7": -43.07331106235309, "Pred8": -50.79009792088823, "Pred9": -65.64183130838676, "Pred10": 139.87315647513793}, {"x": -8.982275379207888, "y_true": 76.93083162471879, "y": 2.57497436581059, "x1": -8.982275379207888, "x2": 80.68127098792421, "x3": -724.7013939580312, "x4": 6509.46748822686, "x5": -58469.82955125433, "x6": 525192.1104047135, "x7": -4717420.162642489, "x8": 42373166.9802825, "x9": -380607454.5060562, "x10": 3418720967.7527347, "pred1": 17.828597782119417, "pred2": 55.27543265942491, "pred3": 56.067507197682694, "pred4": 31.06179354313505, "pred5": 33.0496003493116, "pred6": 19.31536759279799, "pred7": 6.73610193027239, "pred8": 2.2555466731467, "pred9": 2.3653993391163617, "pred10": 2.5817283175419874, "In_train": "train", "Pred1": 17.828597782119417, "Pred2": 55.27543265942491, "Pred3": 56.067507197682694, "Pred4": 31.06179354313505, "Pred5": 33.0496003493116, "Pred6": 19.31536759279799, "Pred7": 6.73610193027239, "Pred8": 2.2555466731467, "Pred9": 2.3653993391163617, "Pred10": 2.5817283175419874}, {"x": -9.026659050812274, "y_true": 78.10767304500862, "y": 15.781692216581398, "x1": -9.026659050812274, "x2": 81.48057361961114, "x3": -735.4973573288387, "x4": 6639.083877380871, "x5": -59928.74657086189, "x6": 540956.3626377055, "x7": -4883028.646898131, "x8": 44077434.73089863, "x9": -397871975.1502533, "x10": 3591454665.55459, "pred1": 17.77219110439627, "pred2": 56.19474581942585, "pred3": 57.236437717497274, "pred4": 34.71820015014672, "pred5": 36.59188401196238, "pred6": 23.093851200812104, "pred7": 10.043561066216036, "pred8": 3.204795325548112, "pred9": 4.95108511789304, "pred10": 28.897080258117043, "In_train": "test", "Pred1": 17.77219110439627, "Pred2": 56.19474581942585, "Pred3": 57.236437717497274, "Pred4": 34.71820015014672, "Pred5": 36.59188401196238, "Pred6": 23.093851200812104, "Pred7": 10.043561066216036, "Pred8": 3.204795325548112, "Pred9": 4.95108511789304, "Pred10": 28.897080258117043}, {"x": 5.481667038018758, "y_true": 50.15757983256919, "y": 24.44182752029455, "x1": 5.481667038018758, "x2": 30.048673515701346, "x3": 164.71682314720726, "x4": 902.9227800532112, "x5": 4949.522041293949, "x6": 27131.63182770836, "x7": 148726.5718776095, "x8": 815269.5467390196, "x9": 4469036.201459777, "x10": 24497768.43725461, "pred1": 36.2106493123961, "pred2": 49.974756081147575, "pred3": 51.137415373432724, "pred4": 25.458016248185167, "pred5": 24.652586969373775, "pred6": 13.1438950506897, "pred7": 38.28820955062168, "pred8": 22.0577671922275, "pred9": 21.387850514565965, "pred10": 28.427868736787318, "In_train": "train", "Pred1": 36.2106493123961, "Pred2": 49.974756081147575, "Pred3": 51.137415373432724, "Pred4": 25.458016248185167, "Pred5": 24.652586969373775, "Pred6": 13.1438950506897, "Pred7": 38.28820955062168, "Pred8": 22.0577671922275, "Pred9": 21.387850514565965, "Pred10": 28.427868736787318}, {"x": -3.942981654772611, "y_true": -13.136147423782996, "y": -35.90188825321785, "x1": -3.942981654772611, "x2": 15.547104329873356, "x3": -61.30194715752647, "x4": 241.7124530439669, "x5": -953.0677680824476, "x6": 3757.928725304168, "x7": -14817.444023817356, "x8": 58424.90995653189, "x9": -230368.3481403469, "x10": 908338.170557658, "pred1": 24.23297594173123, "pred2": -13.176058455348482, "pred3": -17.857678091404104, "pred4": -5.415354074250782, "pred5": -6.899087920349253, "pred6": -13.123718397760612, "pred7": -24.174920703909088, "pred8": -23.9240442494943, "pred9": -26.799031643304037, "pred10": -36.34588948046286, "In_train": "train", "Pred1": 24.23297594173123, "Pred2": -13.176058455348482, "Pred3": -17.857678091404104, "Pred4": -5.415354074250782, "Pred5": -6.899087920349253, "Pred6": -13.123718397760612, "Pred7": -24.174920703909088, "Pred8": -23.9240442494943, "Pred9": -26.799031643304037, "Pred10": -36.34588948046286}, {"x": 7.135268762431544, "y_true": 92.40510445659264, "y": 27.822957658181807, "x1": 7.135268762431544, "x2": 50.91206031213137, "x3": 363.2712335761817, "x4": 2592.0378852261024, "x5": 18494.886953492925, "x6": 131965.9891439608, "x7": 941612.8000422836, "x8": 6718660.398447406, "x9": 47939447.66642764, "x10": 342060843.4224829, "pred1": 38.3121919784197, "pred2": 86.74536247931758, "pred3": 75.32934533924606, "pred4": 184.55233357045057, "pred5": 187.90921059764227, "pred6": 248.90497752483995, "pred7": 78.8593702893547, "pred8": 332.3706467576428, "pred9": 432.93091221352154, "pred10": -1692.5165592970807, "In_train": "test", "Pred1": 38.3121919784197, "Pred2": 86.74536247931758, "Pred3": 75.32934533924606, "Pred4": 184.55233357045057, "Pred5": 187.90921059764227, "Pred6": 248.90497752483995, "Pred7": 78.8593702893547, "Pred8": 332.3706467576428, "Pred9": 432.93091221352154, "Pred10": -1692.5165592970807}, {"x": 4.196026495565919, "y_true": 23.73499382935532, "y": 19.89278808558322, "x1": 4.196026495565919, "x2": 17.606638351491206, "x3": 73.87792102070415, "x4": 309.9937140402009, "x5": 1300.741837571568, "x6": 5457.9472143414, "x7": 22901.691122776712, "x8": 96096.10274443789, "x9": 403221.79323628615, "x10": 1691929.3280090592, "pred1": 34.576744114278455, "pred2": 26.68576353690198, "pred3": 33.17966291611783, "pred4": -15.69846246914102, "pred5": -15.748968780426281, "pred6": -0.7493966371072389, "pred7": -34.50817857468966, "pred8": -26.83175583069466, "pred9": -32.83706449655948, "pred10": 61.016231317158926, "In_train": "test", "Pred1": 34.576744114278455, "Pred2": 26.68576353690198, "Pred3": 33.17966291611783, "Pred4": -15.69846246914102, "Pred5": -15.748968780426281, "Pred6": -0.7493966371072389, "Pred7": -34.50817857468966, "Pred8": -26.83175583069466, "Pred9": -32.83706449655948, "Pred10": 61.016231317158926}, {"x": -9.924587728801344, "y_true": 103.35484100926068, "y": 90.76217468813144, "x1": -9.924587728801344, "x2": 98.4974415866742, "x3": -977.546500089434, "x4": 9701.745999120298, "x5": -96285.82929081684, "x6": 955597.1598371018, "x7": -9483907.846196717, "x8": 94123875.43144672, "x9": -934140659.0941623, "x10": 9270960922.220322, "pred1": 16.631024280498394, "pred2": 75.9800314406093, "pred3": 83.09727482309762, "pred4": 133.06801531357135, "pred5": 130.7309857597833, "pred6": 145.56194200187215, "pred7": 162.24850032855724, "pred8": 182.70438111415297, "pred9": 170.3512293930563, "pred10": -33.16974080214278, "In_train": "test", "Pred1": 16.631024280498394, "Pred2": 75.9800314406093, "Pred3": 83.09727482309762, "Pred4": 133.06801531357135, "Pred5": 130.7309857597833, "Pred6": 145.56194200187215, "Pred7": 162.24850032855724, "Pred8": 182.70438111415297, "Pred9": 170.3512293930563, "Pred10": -33.16974080214278}, {"x": -0.6900414588494286, "y_true": -25.419702715899877, "y": 61.59169896339826, "x1": -0.6900414588494286, "x2": 0.4761572149310476, "x3": -0.328568219232701, "x4": 0.2267256933308919, "x5": -0.1564501281846968, "x6": 0.1079570746897482, "x7": -0.0744948573120306, "x8": 0.0514045400163736, "x9": -0.0354712637843822, "x10": 0.024476642609008, "pred1": 28.367098754274455, "pred2": -19.53414872610199, "pred3": -15.678028504746234, "pred4": 27.90723488018648, "pred5": 28.498657544452886, "pred6": 19.765509219060426, "pred7": 29.823728228080903, "pred8": 56.1584327464755, "pred9": 56.98623564101956, "pred10": 61.928102312482636, "In_train": "train", "Pred1": 28.367098754274455, "Pred2": -19.53414872610199, "Pred3": -15.678028504746234, "Pred4": 27.90723488018648, "Pred5": 28.498657544452886, "Pred6": 19.765509219060426, "Pred7": 29.823728228080903, "Pred8": 56.1584327464755, "Pred9": 56.98623564101956, "Pred10": 61.928102312482636}, {"x": 4.510287644012569, "y_true": 29.674760214396706, "y": 67.75450975334007, "x1": 4.510287644012569, "x2": 20.342694631732453, "x3": 91.75140424342372, "x4": 413.8252248799164, "x5": 1866.47079855661, "x6": 8418.320180640152, "x7": 37969.04549408294, "x8": 171251.3167469134, "x9": 772392.6979444863, "x10": 3483713.241864549, "pred1": 34.976134851469865, "pred2": 31.95040549857105, "pred3": 37.4577140430029, "pred4": -10.376040901273207, "pred5": -10.739475811367683, "pred6": -3.125737420766029, "pred7": -23.12348903680661, "pred8": -12.993977568399217, "pred9": -14.457600005389377, "pred10": 12.07369212295383, "In_train": "test", "Pred1": 34.976134851469865, "Pred2": 31.95040549857105, "Pred3": 37.4577140430029, "Pred4": -10.376040901273207, "Pred5": -10.739475811367683, "Pred6": -3.125737420766029, "Pred7": -23.12348903680661, "Pred8": -12.993977568399217, "Pred9": -14.457600005389377, "Pred10": 12.07369212295383}, {"x": -9.336060459657736, "y_true": 86.49759445625713, "y": 101.99230853473858, "x1": -9.336060459657736, "x2": 87.16202490638462, "x3": -813.7499343122001, "x4": 7597.218585781211, "x5": -70928.09204208883, "x6": 662188.95559311, "x7": -6182236.125134886, "x8": 57717730.24013947, "x9": -538856219.1161577, "x10": 5030794240.731025, "pred1": 17.378976552175452, "pred2": 62.75684488417541, "pred3": 65.66786554621177, "pred4": 63.17868489175282, "pred5": 64.03667272553541, "pred6": 54.62297324181977, "pred7": 41.80154399038734, "pred8": 23.50063622492989, "pred9": 34.21609149748848, "pred10": 196.18881288125704, "In_train": "test", "Pred1": 17.378976552175452, "Pred2": 62.75684488417541, "Pred3": 65.66786554621177, "Pred4": 63.17868489175282, "Pred5": 64.03667272553541, "Pred6": 54.62297324181977, "Pred7": 41.80154399038734, "Pred8": 23.50063622492989, "Pred9": 34.21609149748848, "Pred10": 196.18881288125704}, {"x": 4.441058173200844, "y_true": 28.337434596305293, "y": 75.652070315597, "x1": 4.441058173200844, "x2": 19.722997697754018, "x3": 87.5909801256319, "x4": 388.9966381856102, "x5": 1727.556699361856, "x6": 7672.179799368842, "x7": 34072.59680425341, "x8": 151318.38451970654, "x9": 672013.7483267909, "x10": 2984452.149510029, "pred1": 34.888151944516416, "pred2": 30.766853344367583, "pred3": 36.50814996495027, "pred4": -11.773549163264207, "pred5": -12.071974514483856, "pred6": -2.8048071392608662, "pred7": -26.042235343264295, "pred8": -15.950717853836991, "pred9": -18.302885552833256, "pred10": 22.009928420828814, "In_train": "test", "Pred1": 34.888151944516416, "Pred2": 30.766853344367583, "Pred3": 36.50814996495027, "Pred4": -11.773549163264207, "Pred5": -12.071974514483856, "Pred6": -2.8048071392608662, "Pred7": -26.042235343264295, "Pred8": -15.950717853836991, "Pred9": -18.302885552833256, "Pred10": 22.009928420828814}, {"x": -6.563453985661962, "y_true": 22.92401663601917, "y": 3.705401701436681, "x1": -6.563453985661962, "x2": 43.07892822190189, "x3": -282.7465631360876, "x4": 1855.7940567477756, "x5": -12180.418898328966, "x6": 79945.61896526953, "x7": -524719.3914338109, "x8": 3443971.581060365, "x9": -22604349.00021718, "x10": 148362604.53876945, "pred1": 20.902648978959174, "pred2": 13.53024241316086, "pred3": 6.8706942710350525, "pred4": -48.20965255102123, "pred5": -46.81935679826774, "pred6": -35.71876523381396, "pred7": -14.958747179713917, "pred8": 5.3292628636839225, "pred9": -0.3575102959857368, "pred10": -46.998199674246294, "In_train": "test", "Pred1": 20.902648978959174, "Pred2": 13.53024241316086, "Pred3": 6.8706942710350525, "Pred4": -48.20965255102123, "Pred5": -46.81935679826774, "Pred6": -35.71876523381396, "Pred7": -14.958747179713917, "Pred8": 5.3292628636839225, "Pred9": -0.3575102959857368, "Pred10": -46.998199674246294}, {"x": 0.3715928458725752, "y_true": -21.641731218646186, "y": 1.1348634243102325, "x1": 0.3715928458725752, "x2": 0.1380812431036794, "x3": 0.0513100020865191, "x4": 0.0190664296970574, "x5": 0.0070849488717589, "x6": 0.0026327163141186, "x7": 0.0009782985475384, "x8": 0.0003635287413928, "x9": 0.0001350846795706, "x10": 5.019650051543844e-05, "pred1": 29.71631710241077, "pred2": -15.185516947080608, "pred3": -8.780921144828584, "pred4": 19.28690442688974, "pred5": 20.806976753975935, "pred6": 29.99681848996493, "pred7": 29.890169616101588, "pred8": 5.57522544227761, "pred9": 5.048496815424688, "pred10": 0.7935687961182296, "In_train": "train", "Pred1": 29.71631710241077, "Pred2": -15.185516947080608, "Pred3": -8.780921144828584, "Pred4": 19.28690442688974, "Pred5": 20.806976753975935, "Pred6": 29.99681848996493, "Pred7": 29.890169616101588, "Pred8": 5.57522544227761, "Pred9": 5.048496815424688, "Pred10": 0.7935687961182296}, {"x": 6.520774235091615, "y_true": 75.6200186264345, "y": 106.2787015891801, "x1": 6.520774235091615, "x2": 42.52049662503464, "x3": 277.2665588558258, "x4": 1807.992633239582, "x5": 11789.51178006411, "x6": 76876.74465975113, "x7": 501295.895855022, "x8": 3268837.361848597, "x9": 21315350.447847176, "x10": 138992588.0122704, "pred1": 37.53123822868806, "pred2": 72.18558177573466, "pred3": 66.27485590013225, "pred4": 107.64336591416452, "pred5": 108.3484679234979, "pred6": 114.02103243589968, "pred7": 101.75202558568273, "pred8": 114.01819352283222, "pred9": 117.25444615772203, "pred10": 54.68784392147607, "In_train": "test", "Pred1": 37.53123822868806, "Pred2": 72.18558177573466, "Pred3": 66.27485590013225, "Pred4": 107.64336591416452, "Pred5": 108.3484679234979, "Pred6": 114.02103243589968, "Pred7": 101.75202558568273, "Pred8": 114.01819352283222, "Pred9": 117.25444615772203, "Pred10": 54.68784392147607}, {"x": -2.9659640277290773, "y_true": -20.6056500702583, "y": 42.19409663367121, "x1": -2.9659640277290773, "x2": 8.79694261378289, "x3": -26.09141534647706, "x4": 77.38619935018936, "x5": -229.52468351533287, "x6": 680.7619547823787, "x7": -2019.115469331064, "x8": 5988.623849867248, "x9": -17762.042914306676, "x10": 52681.580342813744, "pred1": 25.474655965630724, "pred2": -18.204092080888895, "pred3": -20.602179099144877, "pred4": 12.997096476340573, "pred5": 11.611708756484804, "pred6": -4.790076628846624, "pred7": -13.094938152232281, "pred8": 20.98339009138291, "pred9": 10.409753099870144, "pred10": 9.341293189287672, "In_train": "test", "Pred1": 25.474655965630724, "Pred2": -18.204092080888895, "Pred3": -20.602179099144877, "Pred4": 12.997096476340573, "Pred5": 11.611708756484804, "Pred6": -4.790076628846624, "Pred7": -13.094938152232281, "Pred8": 20.98339009138291, "Pred9": 10.409753099870144, "Pred10": 9.341293189287672}, {"x": 3.165616256477076, "y_true": 6.614941333118303, "y": -125.40319890292574, "x1": 3.165616256477076, "x2": 10.021126283271936, "x3": 31.723040270535343, "x4": 100.42297198528362, "x5": 317.9005926403558, "x6": 1006.3512840060072, "x7": 3185.721984375995, "x8": 10084.773302357058, "x9": 31924.522308827512, "x10": 101060.78680108945, "pred1": 33.26720805793348, "pred2": 11.3669806374449, "pred3": 19.830207971743278, "pred4": -18.235165697411574, "pred5": -17.179881206345122, "pred6": 15.450555030371877, "pred7": -40.30934270241041, "pred8": -68.6878777482348, "pred9": -89.75901479998436, "pred10": 172.5379848074312, "In_train": "test", "Pred1": 33.26720805793348, "Pred2": 11.3669806374449, "Pred3": 19.830207971743278, "Pred4": -18.235165697411574, "Pred5": -17.179881206345122, "Pred6": 15.450555030371877, "Pred7": -40.30934270241041, "Pred8": -68.6878777482348, "Pred9": -89.75901479998436, "Pred10": 172.5379848074312}, {"x": 5.222245052890752, "y_true": 44.373338484003376, "y": -1.9846500432445997, "x1": 5.222245052890752, "x2": 27.271843392441937, "x3": 142.42024923939124, "x4": 743.7534420218789, "x5": 3884.062733169226, "x6": 20283.527393410324, "x7": 105925.55058541113, "x8": 553169.1825193923, "x9": 2888785.0268235183, "x10": 15085943.315193998, "pred1": 35.88095301237281, "pred2": 44.90205415592218, "pred3": 47.426678773280464, "pred4": 12.597357652114754, "pred5": 11.7947173374334, "pred6": 3.883144728953546, "pred7": 18.970288496652067, "pred8": 13.275016352948441, "pred9": 14.742145213423765, "pred10": -12.828566616716685, "In_train": "test", "Pred1": 35.88095301237281, "Pred2": 44.90205415592218, "Pred3": 47.426678773280464, "Pred4": 12.597357652114754, "Pred5": 11.7947173374334, "Pred6": 3.883144728953546, "Pred7": 18.970288496652067, "Pred8": 13.275016352948441, "Pred9": 14.742145213423765, "Pred10": -12.828566616716685}, {"x": -6.47093182334422, "y_true": 21.253209250315912, "y": -11.812893751238208, "x1": -6.47093182334422, "x2": 41.872958662368944, "x3": -270.9570607459002, "x4": 1753.3446671404586, "x5": -11345.773803890072, "x6": 73417.72876805747, "x7": -475081.1174828775, "x8": 3074217.521789886, "x9": -19893051.993632574, "x10": 128726583.2090382, "pred1": 21.02023428912964, "pred2": 12.25930338969031, "pred3": 5.5229356280479855, "pred4": -47.9107251453428, "pred5": -46.664590443651285, "pred6": -35.09131678159837, "pred7": -15.056447621989285, "pred8": 1.5918811211914061, "pred9": -2.192470976101635, "pred10": -31.437481261319604, "In_train": "test", "Pred1": 21.02023428912964, "Pred2": 12.25930338969031, "Pred3": 5.5229356280479855, "Pred4": -47.9107251453428, "Pred5": -46.664590443651285, "Pred6": -35.09131678159837, "Pred7": -15.056447621989285, "Pred8": 1.5918811211914061, "Pred9": -2.192470976101635, "Pred10": -31.437481261319604}, {"x": 6.893150314043133, "y_true": 85.63830241596483, "y": 64.8076871161785, "x1": 6.893150314043133, "x2": 47.51552125199294, "x3": 327.5316302400984, "x4": 2257.7247598485933, "x5": 15562.836137373288, "x6": 107276.9688077365, "x7": 739476.2712266443, "x8": 5097321.091233388, "x9": 35136600.480814114, "x10": 242201868.63873196, "pred1": 38.004486536409246, "pred2": 80.88219006758452, "pred3": 71.75944745556441, "pred4": 151.37761574907563, "pred5": 153.48794637557654, "pred6": 186.96151421922914, "pred7": 97.82454423932907, "pred8": 219.13085887351212, "pred9": 262.9166324885334, "pred10": -634.9011345616636, "In_train": "test", "Pred1": 38.004486536409246, "Pred2": 80.88219006758452, "Pred3": 71.75944745556441, "Pred4": 151.37761574907563, "Pred5": 153.48794637557654, "Pred6": 186.96151421922914, "Pred7": 97.82454423932907, "Pred8": 219.13085887351212, "Pred9": 262.9166324885334, "Pred10": -634.9011345616636}, {"x": -3.493022680238049, "y_true": -16.979340333058417, "y": -54.08639152234581, "x1": -3.493022680238049, "x2": 12.201207444657404, "x3": -42.61909433047764, "x4": 148.86946310756323, "x5": -520.0044110295798, "x6": 1816.3872015501508, "x7": -6344.681691108797, "x8": 22162.117045934127, "x9": -77412.77748353817, "x10": 270404.5874902202, "pred1": 24.80482342409909, "pred2": -15.824270415946094, "pred3": -19.5196627320221, "pred4": 3.6361952968695803, "pred5": 2.1141339156144383, "pred6": -9.389115063828726, "pred7": -20.543084106324827, "pred8": -4.702820209831231, "pred9": -12.134389774338306, "pred10": -24.38466684085102, "In_train": "test", "Pred1": 24.80482342409909, "Pred2": -15.824270415946094, "Pred3": -19.5196627320221, "Pred4": 3.6361952968695803, "Pred5": 2.1141339156144383, "Pred6": -9.389115063828726, "Pred7": -20.543084106324827, "Pred8": -4.702820209831231, "Pred9": -12.134389774338306, "Pred10": -24.38466684085102}, {"x": -8.747074910351651, "y_true": 70.80623599597394, "y": 183.70684761381912, "x1": -8.747074910351651, "x2": 76.51131948730335, "x3": -669.2502430452905, "x4": 5853.982009688206, "x5": -51205.21916259364, "x6": 447895.8878161804, "x7": -3917778.8827665895, "x8": 34269105.36975316, "x9": -299754431.7799649, "x10": 2621974469.489247, "pred1": 18.12751124663317, "pred2": 50.495975335029286, "pred3": 50.04082957440057, "pred4": 13.365206458755779, "pred5": 15.83982421050969, "pred6": 2.0098389559579104, "pred7": -6.680098810742628, "pred8": 2.437172036668059, "pred9": -6.278242062404292, "pred10": -128.12597817309143, "In_train": "test", "Pred1": 18.12751124663317, "Pred2": 50.495975335029286, "Pred3": 50.04082957440057, "Pred4": 13.365206458755779, "Pred5": 15.83982421050969, "Pred6": 2.0098389559579104, "Pred7": -6.680098810742628, "Pred8": 2.437172036668059, "Pred9": -6.278242062404292, "Pred10": -128.12597817309143}, {"x": -1.384337371858507, "y_true": -25.81792029410888, "y": -33.87053208902993, "x1": -1.384337371858507, "x2": 1.9163899591241185, "x3": -2.6529302394699137, "x4": 3.67255047543174, "x5": -5.084048873176886, "x6": 7.038038855493894, "x7": -9.743020212252471, "x8": 13.4876269945939, "x9": -18.67142610630397, "x10": 25.84755294485116, "pred1": 27.484726377363366, "pred2": -20.668392791978572, "pred3": -18.708822855027265, "pred4": 28.35118237169379, "pred5": 28.223950589793557, "pred6": 11.74291544551821, "pred7": 19.379415989315735, "pred8": 67.3132091064372, "pred9": 63.43842994625555, "pred10": 88.22365887015094, "In_train": "test", "Pred1": 27.484726377363366, "Pred2": -20.668392791978572, "Pred3": -18.708822855027265, "Pred4": 28.35118237169379, "Pred5": 28.223950589793557, "Pred6": 11.74291544551821, "Pred7": 19.379415989315735, "Pred8": 67.3132091064372, "Pred9": 63.43842994625555, "Pred10": 88.22365887015094}, {"x": 4.852229846751024, "y_true": 36.519170997371695, "y": -13.988942624499913, "x1": 4.852229846751024, "x2": 23.54413448570147, "x3": 114.24155206744076, "x4": 554.3262686807972, "x5": 2689.718465731092, "x6": 13051.132218777777, "x7": 63327.09328584744, "x8": 307277.6121495753, "x9": 1490981.6009105546, "x10": 7234585.424894817, "pred1": 35.410705109688564, "pred2": 37.993447045901924, "pred3": 42.2021092017609, "pred4": -1.4136084593412441, "pred5": -2.050038123384919, "pred6": -2.473096449717069, "pred7": -5.448944380838469, "pred8": 0.5354451211800182, "pred9": 2.0694877981432, "pred10": -21.693568092409365, "In_train": "train", "Pred1": 35.410705109688564, "Pred2": 37.993447045901924, "Pred3": 42.2021092017609, "Pred4": -1.4136084593412441, "Pred5": -2.050038123384919, "Pred6": -2.473096449717069, "Pred7": -5.448944380838469, "Pred8": 0.5354451211800182, "Pred9": 2.0694877981432, "Pred10": -21.693568092409365}, {"x": 3.727976805823406, "y_true": 15.510983713963348, "y": 161.0233188781908, "x1": 3.727976805823406, "x2": 13.897811064757288, "x3": 51.810717301131056, "x4": 193.14915239169005, "x5": 720.055560180671, "x6": 2684.350427257721, "x7": 10007.196131518936, "x8": 37306.59506962831, "x9": 139078.12112382016, "x10": 518480.0097471, "pred1": 33.98190535819147, "pred2": 19.35828898137857, "pred3": 26.97614590957567, "pred4": -19.293449031866352, "pred5": -18.831436927613964, "pred6": 5.843742220232141, "pred7": -42.70698182649, "pred8": -47.896257688839256, "pred9": -61.677552908857095, "pred10": 131.78165040414837, "In_train": "test", "Pred1": 33.98190535819147, "Pred2": 19.35828898137857, "Pred3": 26.97614590957567, "Pred4": -19.293449031866352, "Pred5": -18.831436927613964, "Pred6": 5.843742220232141, "Pred7": -42.70698182649, "Pred8": -47.896257688839256, "Pred9": -61.677552908857095, "Pred10": 131.78165040414837}, {"x": -2.7383989368584727, "y_true": -21.879426787560792, "y": -35.23602701511189, "x1": -2.7383989368584727, "x2": 7.498828737387614, "x3": -20.534784642146004, "x4": 56.23243243267031, "x5": -153.98683319059026, "x6": 421.67738029931536, "x7": -1154.7208899089112, "x8": 3162.086457294832, "x9": -8659.054192910742, "x10": 23711.944796066677, "pred1": 25.763865719528347, "pred2": -18.990786441053878, "pred3": -20.792403913327554, "pred4": 16.4859016535395, "pred5": 15.213796969877857, "pred6": -2.6795875899326624, "pred7": -8.980916339792941, "pred8": 31.80127323133142, "pred9": 20.815464656086128, "pred10": 27.1075354671223, "In_train": "test", "Pred1": 25.763865719528347, "Pred2": -18.990786441053878, "Pred3": -20.792403913327554, "Pred4": 16.4859016535395, "Pred5": 15.213796969877857, "Pred6": -2.6795875899326624, "Pred7": -8.980916339792941, "Pred8": 31.80127323133142, "Pred9": 20.815464656086128, "Pred10": 27.1075354671223}, {"x": -1.6026752477703532, "y_true": -25.604403001171647, "y": -41.0626241665516, "x1": -1.6026752477703532, "x2": 2.568567949815763, "x3": -4.116580275385966, "x4": 6.597541312820752, "x5": -10.57371615820014, "x6": 16.946233163696796, "x7": -27.15930843440194, "x8": 43.52755137437657, "x9": -69.76052918376575, "x10": 111.80347339418272, "pred1": 27.20724338066375, "pred2": -20.74563821543193, "pred3": -19.399050963211245, "pred4": 27.56024955122107, "pred5": 27.212080092368968, "pred6": 9.235007880137061, "pred7": 15.039134212163336, "pred8": 66.34332456971082, "pred9": 60.69368696309449, "pred10": 88.14858782673946, "In_train": "test", "Pred1": 27.20724338066375, "Pred2": -20.74563821543193, "Pred3": -19.399050963211245, "Pred4": 27.56024955122107, "Pred5": 27.212080092368968, "Pred6": 9.235007880137061, "Pred7": 15.039134212163336, "Pred8": 66.34332456971082, "Pred9": 60.69368696309449, "Pred10": 88.14858782673946}, {"x": -8.223553165877851, "y_true": 57.849037362334165, "y": 14.428412230630222, "x1": -8.223553165877851, "x2": 67.62682667201962, "x3": -556.1328045769596, "x4": 4573.387685727384, "x5": -37609.49678175021, "x6": 309283.6963266348, "x7": -2543410.9200813016, "x8": 20915874.923962884, "x9": -172002809.44806013, "x10": 1414474248.1764796, "pred1": 18.79284877401963, "pred2": 40.414646012436336, "pred3": 37.62278896168926, "pred4": -16.71560711117143, "pred5": -13.761784430784495, "pred6": -22.962168375563216, "pred7": -19.03320382437655, "pred8": 17.015852264101156, "pred9": -6.245731153042829, "pred10": -299.9706426601697, "In_train": "test", "Pred1": 18.79284877401963, "Pred2": 40.414646012436336, "Pred3": 37.62278896168926, "Pred4": -16.71560711117143, "Pred5": -13.761784430784495, "Pred6": -22.962168375563216, "Pred7": -19.03320382437655, "Pred8": 17.015852264101156, "Pred9": -6.245731153042829, "Pred10": -299.9706426601697}, {"x": -0.3640013134943825, "y_true": -24.667160559743387, "y": 21.818198775552545, "x1": -0.3640013134943825, "x2": 0.1324969562256357, "x3": -0.048229066100139, "x4": 0.017555443409058, "x5": -0.0063902044598734, "x6": 0.0023260428168915, "x7": -0.0008466826405927, "x8": 0.0003081935932886, "x9": -0.0001121828727676, "x10": 4.083471303898616e-05, "pred1": 28.78145927784217, "pred2": -18.53497447073168, "pred3": -13.837899169192974, "pred4": 26.20366449017813, "pred5": 27.116145887322403, "pred6": 23.334767722419816, "pred7": 32.19949266365334, "pred8": 44.0274574989924, "pred9": 45.80895767265717, "pred10": 40.95868185524112, "In_train": "test", "Pred1": 28.78145927784217, "Pred2": -18.53497447073168, "Pred3": -13.837899169192974, "Pred4": 26.20366449017813, "Pred5": 27.116145887322403, "Pred6": 23.334767722419816, "Pred7": 32.19949266365334, "Pred8": 44.0274574989924, "Pred9": 45.80895767265717, "Pred10": 40.95868185524112}, {"x": 6.656568171049994, "y_true": 79.21875918822593, "y": 23.279299839342315, "x1": 6.656568171049994, "x2": 44.30989981583586, "x3": 294.95186877650696, "x4": 1963.3672216894104, "x5": 13069.287755980587, "x6": 86996.60489475378, "x7": 579098.8311318301, "x8": 3854810.847204396, "x9": 25659811.19091904, "x10": 170806282.4486241, "pred1": 37.70381711875009, "pred2": 75.31190953323365, "pred3": 68.27326852582678, "pred4": 122.61375135720971, "pred5": 123.76543353740058, "pred6": 137.77314443793907, "pred7": 103.18178221091082, "pred8": 144.67698825255707, "pred9": 157.82661066358068, "pred10": -103.10520721993818, "In_train": "test", "Pred1": 37.70381711875009, "Pred2": 75.31190953323365, "Pred3": 68.27326852582678, "Pred4": 122.61375135720971, "Pred5": 123.76543353740058, "Pred6": 137.77314443793907, "Pred7": 103.18178221091082, "Pred8": 144.67698825255707, "Pred9": 157.82661066358068, "Pred10": -103.10520721993818}, {"x": -9.804879808964852, "y_true": 99.83062849926336, "y": 131.47624036529035, "x1": -9.804879808964852, "x2": 96.13566806824664, "x3": -942.5986707636984, "x4": 9242.066674928095, "x5": -90617.3529341094, "x6": 888492.2541254913, "x7": -8711559.762896698, "x8": 85415796.42381647, "x9": -837491617.7225302, "x10": 8211504652.784947, "pred1": 16.783159644947567, "pred2": 73.21169787804725, "pred3": 79.40197247924479, "pred4": 117.05268415826501, "pred5": 115.51825979272732, "pred6": 123.20697495411122, "pred7": 129.54296528828658, "pred8": 131.5980035615459, "pred9": 131.55439577101615, "pred10": 131.47386937082047, "In_train": "train", "Pred1": 16.783159644947567, "Pred2": 73.21169787804725, "Pred3": 79.40197247924479, "Pred4": 117.05268415826501, "Pred5": 115.51825979272732, "Pred6": 123.20697495411122, "Pred7": 129.54296528828658, "Pred8": 131.5980035615459, "Pred9": 131.55439577101615, "Pred10": 131.47386937082047}, {"x": 1.2361742342612168, "y_true": -15.733870185861791, "y": 3.383360389096301, "x1": 1.2361742342612168, "x2": 1.5281267374513057, "x3": 1.8890308995229592, "x4": 2.335171325713572, "x5": 2.886678625432725, "x6": 3.56843773935252, "x7": 4.4112107899529285, "x8": 5.453025120434879, "x9": 6.740889152660766, "x10": 8.332913486530165, "pred1": 30.815103254556245, "pred2": -9.308541205770933, "pred3": -1.375540005894221, "pred4": 7.184875427748871, "pred5": 9.085877545319702, "pred6": 33.38795623726815, "pred7": 13.307646003997647, "pred8": -43.79612853634322, "pred9": -54.02725179619692, "pred10": 14.604938402914465, "In_train": "test", "Pred1": 30.815103254556245, "Pred2": -9.308541205770933, "Pred3": -1.375540005894221, "Pred4": 7.184875427748871, "Pred5": 9.085877545319702, "Pred6": 33.38795623726815, "Pred7": 13.307646003997647, "Pred8": -43.79612853634322, "Pred9": -54.02725179619692, "Pred10": 14.604938402914465}, {"x": -2.76625939296056, "y_true": -21.732938761596003, "y": 129.3356782636361, "x1": -2.76625939296056, "x2": 7.652191029142525, "x3": -21.167945311094044, "x4": 58.55602754648934, "x5": -161.98116121493342, "x6": 448.08190869346834, "x7": -1239.5107887390027, "x8": 3428.8083620252187, "x9": -9484.973338113972, "x10": 26237.896588538253, "pred1": 25.728458198884763, "pred2": -18.90227534741533, "pred3": -20.777879179381273, "pred4": 16.078974930714715, "pred5": 14.791398521995562, "pred6": -2.9427411804543695, "pred7": -9.508644370595995, "pred8": 30.51162506131882, "pred9": 19.544500990322675, "pred10": 24.909942895639958, "In_train": "test", "Pred1": 25.728458198884763, "Pred2": -18.90227534741533, "Pred3": -20.777879179381273, "Pred4": 16.078974930714715, "Pred5": 14.791398521995562, "Pred6": -2.9427411804543695, "Pred7": -9.508644370595995, "Pred8": 30.51162506131882, "Pred9": 19.544500990322675, "Pred10": 24.909942895639958}, {"x": -4.457650184804254, "y_true": -7.89626896855226, "y": -26.760376539006497, "x1": -4.457650184804254, "x2": 19.8706451700854, "x3": -88.57638511461093, "x4": 394.8425394754382, "x5": -1760.0699190612677, "x6": 7845.775999971868, "x7": -34973.72483620738, "x8": 155900.63097941293, "x9": -694950.4764964798, "x10": 3097846.1199843376, "pred1": 23.578889858756668, "pred2": -9.450764053159649, "pred3": -15.083910247235014, "pred4": -16.354860181246572, "pred5": -17.607582204109654, "pred6": -17.389073865001485, "pred7": -25.17650805510356, "pred8": -38.60013586069182, "pred9": -35.614530665648715, "pred10": -26.350085348179576, "In_train": "train", "Pred1": 23.578889858756668, "Pred2": -9.450764053159649, "Pred3": -15.083910247235014, "Pred4": -16.354860181246572, "Pred5": -17.607582204109654, "Pred6": -17.389073865001485, "Pred7": -25.17650805510356, "Pred8": -38.60013586069182, "Pred9": -35.614530665648715, "Pred10": -26.350085348179576}, {"x": 4.825670488119888, "y_true": 35.97331162314065, "y": 49.77584336934803, "x1": 4.825670488119888, "x2": 23.28709565991124, "x3": 112.3758502800584, "x4": 542.2888242738569, "x5": 2616.907175335584, "x6": 12628.331726166103, "x7": 60940.16772514785, "x8": 294077.16893232206, "x9": 1419119.5153465534, "x10": 6848203.1643228615, "pred1": 35.37695113826877, "pred2": 37.51232453337027, "pred3": 41.83054196627453, "pred4": -2.2394377850841423, "pred5": -2.858113938415581, "pred6": -2.67859313691779, "pred7": -7.006396006691062, "pred8": -0.447156045467878, "pred9": 0.9507694506788766, "pred10": -20.269873216237798, "In_train": "test", "Pred1": 35.37695113826877, "Pred2": 37.51232453337027, "Pred3": 41.83054196627453, "Pred4": -2.2394377850841423, "Pred5": -2.858113938415581, "Pred6": -2.67859313691779, "Pred7": -7.006396006691062, "Pred8": -0.447156045467878, "Pred9": 0.9507694506788766, "Pred10": -20.269873216237798}, {"x": -3.012486777485868, "y_true": -20.32356559399584, "y": -12.16411918567957, "x1": -3.012486777485868, "x2": 9.075076584527189, "x3": -27.33854821555976, "x4": 82.35701501503365, "x5": -248.09941876599396, "x6": 747.3962185344858, "x7": -2251.5212258780766, "x8": 6782.677922186477, "x9": -20432.72755653208, "x10": 61553.32159202402, "pred1": 25.415530759052125, "pred2": -18.02538018043345, "pred3": -20.54303653687119, "pred4": 12.239197274859796, "pred5": 10.834453691015703, "pred6": -5.211073554337844, "pred7": -13.876430497137967, "pred8": 18.71191853999803, "pred9": 8.29541342515277, "pred10": 5.826424889382764, "In_train": "test", "Pred1": 25.415530759052125, "Pred2": -18.02538018043345, "Pred3": -20.54303653687119, "Pred4": 12.239197274859796, "Pred5": 10.834453691015703, "Pred6": -5.211073554337844, "Pred7": -13.876430497137967, "Pred8": 18.71191853999803, "Pred9": 8.29541342515277, "Pred10": 5.826424889382764}, {"x": 3.7783291669200896, "y_true": 16.35996078349077, "y": -23.18155368558764, "x1": 3.7783291669200896, "x2": 14.27577129359906, "x3": 53.93856305888586, "x4": 203.79764602714693, "x5": 770.0145901340253, "x6": 2909.3685848574064, "x7": 10992.552181487765, "x8": 41533.48052620627, "x9": 156927.1608758727, "x10": 592922.4690192711, "pred1": 34.04589757204652, "pred2": 20.117076826093864, "pred3": 27.633039125858417, "pred4": -19.125490463353138, "pred5": -18.71921666445359, "pred6": 5.028322425579223, "pred7": -42.30663660081688, "pred8": -45.70542960620446, "pred9": -58.671691868935895, "pred10": 125.30452875977677, "In_train": "test", "Pred1": 34.04589757204652, "Pred2": 20.117076826093864, "Pred3": 27.633039125858417, "Pred4": -19.125490463353138, "Pred5": -18.71921666445359, "Pred6": 5.028322425579223, "Pred7": -42.30663660081688, "Pred8": -45.70542960620446, "Pred9": -58.671691868935895, "Pred10": 125.30452875977677}, {"x": 6.068926586911488, "y_true": 64.096777865783, "y": 182.7524628775764, "x1": 6.068926586911488, "x2": 36.83186991732112, "x3": 223.5299145868956, "x4": 1356.5866416064644, "x5": 8233.024736694437, "x6": 49965.622715224825, "x7": 303237.69612801645, "x8": 1840327.3161851056, "x9": 11168811.377815252, "x10": 67782696.31502251, "pred1": 36.956990453559406, "pred2": 62.155249801964985, "pred3": 59.65053211853195, "pred4": 65.29316590794147, "pred5": 64.97752940110081, "pred6": 54.8378345371973, "pred7": 81.30287280674548, "pred8": 53.51438814451227, "pred9": 46.859619837348774, "pred10": 167.84473202994246, "In_train": "test", "Pred1": 36.956990453559406, "Pred2": 62.155249801964985, "Pred3": 59.65053211853195, "Pred4": 65.29316590794147, "Pred5": 64.97752940110081, "Pred6": 54.8378345371973, "Pred7": 81.30287280674548, "Pred8": 53.51438814451227, "Pred9": 46.859619837348774, "Pred10": 167.84473202994246}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>We didn’t get to see these plots during lecture today, but here are some explanations. We’ll go through this all together next lecture. A few comments:</p>
<ul class="simple">
<li><p>Notice that in degree 1, the training and test errors are both high. This is a sign of overfitting, and is exhibited by the line not fitting our data well.</p></li>
<li><p>In degree 2 and 3, the red curve matches the secret underlying polynomial (black curve) pretty well.</p></li>
<li><p>In higher degrees, the training errors are smaller, but notice from the plots that the red lines follow the orange point (the training data) very closely.</p></li>
</ul>
<a style='text-decoration:none;line-height:16px;display:flex;color:#5B5B62;padding:10px;justify-content:end;' href='https://deepnote.com?utm_source=created-in-deepnote-cell&projectId=9d187b6a-99ad-41f0-a5c4-98efee456075' target="_blank">
<img alt='Created in deepnote.com' style='display:inline;max-height:16px;margin:0px;margin-right:7.5px;' src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgODAgODAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkxhbmRpbmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyMzUuMDAwMDAwLCAtNzkuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjM1LjAwMDAwMCwgNzkuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0yMCIgZmlsbD0iIzAyNjVCNCIgcG9pbnRzPSIyLjM3NjIzNzYyIDgwIDM4LjA0NzY2NjcgODAgNTcuODIxNzgyMiA3My44MDU3NTkyIDU3LjgyMTc4MjIgMzIuNzU5MjczOSAzOS4xNDAyMjc4IDMxLjY4MzE2ODMiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNS4wMDc3MTgsODAgQzQyLjkwNjIwMDcsNzYuNDU0OTM1OCA0Ny41NjQ5MTY3LDcxLjU0MjI2NzEgNDguOTgzODY2LDY1LjI2MTk5MzkgQzUxLjExMjI4OTksNTUuODQxNTg0MiA0MS42NzcxNzk1LDQ5LjIxMjIyODQgMjUuNjIzOTg0Niw0OS4yMTIyMjg0IEMyNS40ODQ5Mjg5LDQ5LjEyNjg0NDggMjkuODI2MTI5Niw0My4yODM4MjQ4IDM4LjY0NzU4NjksMzEuNjgzMTY4MyBMNzIuODcxMjg3MSwzMi41NTQ0MjUgTDY1LjI4MDk3Myw2Ny42NzYzNDIxIEw1MS4xMTIyODk5LDc3LjM3NjE0NCBMMzUuMDA3NzE4LDgwIFoiIGlkPSJQYXRoLTIyIiBmaWxsPSIjMDAyODY4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMCwzNy43MzA0NDA1IEwyNy4xMTQ1MzcsMC4yNTcxMTE0MzYgQzYyLjM3MTUxMjMsLTEuOTkwNzE3MDEgODAsMTAuNTAwMzkyNyA4MCwzNy43MzA0NDA1IEM4MCw2NC45NjA0ODgyIDY0Ljc3NjUwMzgsNzkuMDUwMzQxNCAzNC4zMjk1MTEzLDgwIEM0Ny4wNTUzNDg5LDc3LjU2NzA4MDggNTMuNDE4MjY3Nyw3MC4zMTM2MTAzIDUzLjQxODI2NzcsNTguMjM5NTg4NSBDNTMuNDE4MjY3Nyw0MC4xMjg1NTU3IDM2LjMwMzk1NDQsMzcuNzMwNDQwNSAyNS4yMjc0MTcsMzcuNzMwNDQwNSBDMTcuODQzMDU4NiwzNy43MzA0NDA1IDkuNDMzOTE5NjYsMzcuNzMwNDQwNSAwLDM3LjczMDQ0MDUgWiIgaWQ9IlBhdGgtMTkiIGZpbGw9IiMzNzkzRUYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+' > </img>
Created in <span style='font-weight:600;margin-left:4px;'>Deepnote</span></a></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="lec11.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lecture 11: August 30th, 2023</p>
      </div>
    </a>
    <a class="right-next"
       href="../w5vid.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 5 Lecture Videos</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#happy-september">🎃 🍁 Happy September!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-measures-for-regression">Performance measures for regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-on-polynomial-regression">More on Polynomial Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-random-data">Generating Random Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polynomialfeatures">PolynomialFeatures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-pipeline-to-combine-multiple-step">Using <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> to combine multiple step</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overfitting">Overfitting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dividing-into-a-training-set-and-a-test-set">Dividing into a training set and a test set</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performing-polynomial-regression-for-each-degree">Performing Polynomial Regression for Each Degree</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-the-performance-part-1">Evaluating the Performance, Part 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-the-performance-part-2">Evaluating the Performance, Part 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-polynomial-fits">Plotting the polynomial fits</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Christopher Davis and Yasmeen Baki
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>